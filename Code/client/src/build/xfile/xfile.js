//>>built
require({cache:{"xfile/main":function(){define("xfile/types xfile/component xfile/views/Grid xfile/views/FileGrid xfile/FileActions xfile/Statusbar xfile/ThumbRenderer xfile/Breadcrumb xfile/types xfile/component xfile/config xfile/model/File xfile/manager/FileManager xfile/manager/MountManager xfile/manager/BlockManager xfile/views/FileConsole xfile/data/DriverStore xfile/views/FileGridLight xfile/manager/Electron".split(" "),function(){})},"xfile/types":function(){define(["dojo/_base/lang","xide/types",
"xide/types/Types"],function(q,h){h.registerCustomMimeIconExtension=function(e,a){h.customMimeIcons[e]=a};var g=h.ACTION;h.DEFAULT_FILE_GRID_PERMISSIONS=[g.EDIT,g.COPY,g.CLOSE,g.MOVE,g.RENAME,g.DOWNLOAD,g.RELOAD,g.DELETE,g.NEW_FILE,g.NEW_DIRECTORY,g.CLIPBOARD,g.LAYOUT,g.COLUMNS,g.SELECTION,g.PREVIEW,g.OPEN_IN,g.GO_UP,g.SEARCH,g.OPEN_IN_TAB,g.TOOLBAR,g.STATUSBAR,g.UPLOAD,g.SOURCE,g.SIZE_STATS,g.CONSOLE,g.HEADER,"File/Compress","File/New",g.CONTEXT_MENU];h.FIELDS={SHOW_ISDIR:1602,SHOW_OWNER:1604,SHOW_MIME:1608,
SHOW_SIZE:1616,SHOW_PERMISSIONS:1632,SHOW_TIME:1633,SHOW_FOLDER_SIZE:1634,SHOW_FOLDER_HIDDEN:1635,SHOW_TYPE:1636,SHOW_MEDIA_INFO:1637};h.FILE_PANEL_LAYOUT={TREE:1,LIST:2,THUMB:3,PREVIEW:4,COVER:5,SPLIT_VERTICAL:6,SPLIT_HORIZONTAL:7,IMAGE_GRID:8};h.LAYOUT_PRESET={DUAL:1,SINGLE:2,BROWSER:3,PREVIEW:4,GALLERY:5,EDITOR:6};h.PANEL_OPTIONS={ALLOW_NEW_TABS:!0,ALLOW_MULTI_TAB:!1,ALLOW_INFO_VIEW:!0,ALLOW_LOG_VIEW:!0,ALLOW_CONTEXT_MENU:!0,ALLOW_LAYOUT_SELECTOR:!0,ALLOW_SOURCE_SELECTOR:!0,ALLOW_COLUMN_RESIZE:!0,
ALLOW_COLUMN_REORDER:!0,ALLOW_COLUMN_HIDE:!0,ALLOW_ACTION_TOOLBAR:!0,ALLOW_MAIN_MENU:!0};h.FILE_PANEL_OPTIONS_LEFT={LAYOUT:2,AUTO_OPEN:!0};h.FILE_PANEL_OPTIONS_MAIN={LAYOUT:3,AUTO_OPEN:!0};h.FILE_PANEL_OPTIONS_RIGHT={LAYOUT:3,AUTO_OPEN:!0};h.FILE_GRID_COLUMNS={NAME:"name",SIZE:"size",MODIFIED:"modified"};h.ACTION_TOOLBAR_MODE={SELF:"self"};q.mixin(h.ITEM_TYPE,{FILE:"BTFILE"});q.mixin(h.EVENTS,{STORE_CHANGED:"onStoreChange",BEFORE_STORE_CHANGE:"onBeforeStoreChange",STORE_REFRESHED:"onStoreRefreshed",
ON_FILE_STORE_READY:"onFileStoreReady",ON_DID_OPEN_ITEM:"onDidOpenItem",ON_SHOW_PANEL:"onShowPanel",ITEM_SELECTED:"onItemSelected",ERROR:"fileOperationError",STATUS:"fileOperationStatus",IMAGE_LOADED:"imageLoaded",IMAGE_ERROR:"imageError",RESIZE:"resize",ON_UPLOAD_BEGIN:"onUploadBegin",ON_UPLOAD_PROGRESS:"onUploadProgress",ON_UPLOAD_FINISH:"onUploadFinish",ON_UPLOAD_FAILED:"onUploadFailed",ON_CLIPBOARD_COPY:"onClipboardCopy",ON_CLIPBOARD_PASTE:"onClipboardPaste",ON_CLIPBOARD_CUT:"onClipboardCut",
ON_CONTEXT_MENU_OPEN:"onContextMenuOpen",ON_PLUGIN_LOADED:"onPluginLoaded",ON_PLUGIN_READY:"onPluginReady",ON_MAIN_VIEW_READY:"onMainViewReady",ON_FILE_CONTENT_CHANGED:"onFileContentChanged",ON_PANEL_CLOSED:"onPanelClosed",ON_PANEL_CREATED:"onPanelCreated",ON_COPY_BEGIN:"onCopyBegin",ON_COPY_END:"onCopyEnd",ON_DOWNLOAD_TO_BEGIN:"onDownloadToBegin",ON_DOWNLOAD_TO_END:"onDownloadToEnd",ON_DELETE_BEGIN:"onDeleteBegin",ON_DELETE_END:"onDeleteEnd",ON_MOVE_BEGIN:"onMoveBegin",ON_MOVE_END:"onMoveEnd",ON_COMPRESS_BEGIN:"onCompressBegin",
ON_COMPRESS_END:"onCompressEnd",ON_SOURCE_MENU_OPEN:"onSourceMenuOpen",ON_MOUNT_DATA_READY:"onMountDataReady",ON_XFILE_READY:"onXFileReady",ON_CHANGE_PERSPECTIVE:"onChangePerspective",ON_FILE_PROPERTIES_RENDERED:"onFilePropertiesRendered"});h.SELECTION_MODE={SINGLE:"single",MULTI:"multiple",EXTENDED:"extended"};h.OPERATION={COPY:"copy",MOVE:"move",RENAME:"rename",DELETE:"delete",OPEN:"open",EDIT:"edit",DOWNLOAD:"download",DOWNLOAD_TO:"downloadTo",INFO:"info",COMPRESS:"compress",RELOAD:"reload",PREVIEW:"preview",
INSERT_IMAGE:"insertImage",COPY_PASTE:"copypaste",DND:"dnd",OPTIONS:"options",NEW_FILE:"mkfile",NEW_DIRECTORY:"mkdir",GET_CONTENT:"get",SET_CONTENT:"set",FIND:"find",CUSTOM:"custom",PERMA_LINK:"permaLink",ADD_MOUNT:"ADD_MOUNT",REMOVE_MOUNT:"REMOVE_MOUNT",EDIT_MOUNT:"EDIT_MOUNT",PERSPECTIVE:"PERSPECTIVE",EXTRACT:"extract"};h.OPERATION_INT={NONE:0,EDIT:1,COPY:2,MOVE:3,INFO:4,DOWNLOAD:5,COMPRESS:6,DELETE:7,RENAME:8,DND:9,COPY_PASTE:10,OPEN:11,RELOAD:12,PREVIEW:13,INSERT_IMAGE:15,NEW_FILE:16,NEW_DIRECTORY:17,
UPLOAD:18,READ:19,WRITE:20,PLUGINS:21,CUSTOM:22,FIND:23,PERMA_LINK:24,ADD_MOUNT:25,REMOVE_MOUNT:26,EDIT_MOUNT:27,PERSPECTIVE:28,CLIPBOARD_COPY:29,CLIPBOARD_CUT:30,CLIPBOARD_PASTE:31,EXTRACT:32};return h})},"xfile/component":function(){define(["dcl/dcl","xide/model/Component"],function(q,h){return q(h,{beanType:"BTFILE",getDependencies:function(){return["xfile/types","xfile/manager/FileManager","xfile/manager/MountManager","xfile/factory/Store","xfile/views/FileGrid"]},getLabel:function(){return"xfile"},
getBeanType:function(){return this.beanType}})})},"xfile/views/Grid":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xfile/Statusbar xfile/views/UploadMixin xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Search xgrid/Selection xide/mixins/_State xide/widgets/_Widget xdojo/has!FileConsole?xfile/views/FileConsole xfile/FolderSize xide/noob".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d,p,w,k,
f,b,l,t){g=[g,e,a];q=q.classFactory("multiRenderer",{},g,u.Implementation);h=c.createGridClass("xfile.views.Grid",{},{SELECTION:{CLASS:w},KEYBOARD_SELECTION:!0,CONTEXT_MENU:h.GRID_FEATURES.CONTEXT_MENU,TOOLBAR:h.GRID_FEATURES.TOOLBAR,CLIPBOARD:h.GRID_FEATURES.CLIPBOARD,ACTIONS:h.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:v},STATUS_BAR:{CLASS:m},SPLIT:{CLASS:n},KEYBOARD_NAVIGATION:{CLASS:d},SEARCH:{CLASS:p},STATE:{CLASS:k},UPLOAD:{CLASS:r},WIDGET:{CLASS:f},CONSOLE:{CLASS:b?b:t},SIZES:{CLASS:l}},{RENDERER:q},
{renderers:g,selectedRenderer:a});h.DEFAULT_RENDERERS=g;h.DEFAULT_MULTI_RENDERER=q;return h})},"xfile/ThumbRenderer":function(){define(["xdojo/declare","xide/utils","dojo/dom-construct","xgrid/ThumbRenderer"],function(q,h,g,e){return q("xfile.ThumbRenderer",[e],{thumbSize:"400",resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){$(this.domNode.parentNode).removeClass("metro");$(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){$(this.domNode.parentNode).addClass("metro");
$(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_renderUpload:function(a,c,e){c=parseInt(c.replace("%",""));100==c&&(c=90);a='\x3cdiv class\x3d"tile widget uploadItem"\x3e\x3cdiv class\x3d"radial-progress tile widget " data-progress\x3d"'+c+'"\x3e\x3cdiv class\x3d"circle"\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"shadow"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"inset"\x3e\x3cdiv class\x3d"percentage"\x3e\x3cdiv class\x3d"numbers"\x3e\x3cspan\x3e-\x3c/span\x3e';
for(c=0;99>c;c++)a+="\x3cspan\x3e"+c+"%\x3c/span\x3e";return a+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},renderRow:function(a){if(!0===a.isUpload)return $(this._renderUpload(a.name,a.progress+"%",a))[0];if(a.renderRow){var c=a.renderRow.apply(this,[a]);if(c)return c}var c=g.create("div",{className:"tile widget"}),e=!1===a.read&&!1===a.write,v=".."==a.name,m=a&&!!a.directory,r=!1,n="",d="fa fa-folder fa-5x";this._doubleWidthThumbs=!0;var p="icon";m?(d=v?"fa fa-level-up fa-5x itemFolder":
e?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",r=!0):e?(d="fa fa-lock fa-5x itemFolder",r=!0):h.isImage(a.path)?(d=this.getImageUrl(a),a.icon=d?d:this.config.REPO_URL+"/"+a.path,d="imageFile"):(d="fa fa-5x "+h.getIconClass(a.path),r=!0);n=a.name;e='\x3cspan style\x3d"text-shadow: 2px 2px 5px rgba(0,0,0,0.3);font-size: 72px;opacity: 0.7" class\x3d"fa fa-6x '+d+'"\x3e\x3c/span\x3e';h.isImage(a.path)&&(d=this.getImageUrl(a),a.icon=d?d:this.config.REPO_URL+"/"+a.path,d="",p="image",e=
'\x3cdiv style\x3d"" class\x3d"tile-content image"\x3e\x3cimg class\x3d"'+d+'" src\x3d"'+a.icon+'"/\x3e\x3c/div\x3e',r=!0);n='\x3cdiv title\x3d"'+(n+"\n"+a.modified)+'" class\x3d"tile-content '+p+'"\x3e'+e+'\x3c/div\x3e\x3cdiv class\x3d"brand opacity"\x3e\x3cspan class\x3d"thumbText text opacity ellipsis" style\x3d""\x3e'+n+"\x3c/span\x3e\x3c/div\x3e";if(r)return c.innerHTML=n,c;c.innerHTML=m?n:'\x3cimg class\x3d"'+d+'" src\x3d"'+a.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";
return c},renderRow2:function(a){var c=g.create("span",{className:"cell"}),e=!1===a.read&&!1===a.write,v=".."==a.name,m=a&&!!a.directory,r="",n=!1,d="";m?(r=v?"fa fa-level-up fa-5x itemFolder":e?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",n=!0):e?(r="fa fa-lock fa-5x itemFolder",n=!0):h.isImage(a.path)?(e=this.getImageUrl(a),a.icon=e?e:this.config.REPO_URL+"/"+a.path,r="imageFile"):(r="fa fa-5x "+h.getIconClass(a.path),n=!0);d=!0===a.showPath?a.path:a.name;if(n)return c.innerHTML=
'\x3cspan class\x3d"'+r+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name" style\x3d""\x3e'+d+"\x3c/div\x3e",c;c.innerHTML=m?'\x3cspan class\x3d"'+r+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e":'\x3cimg class\x3d"'+r+'" src\x3d"'+a.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";return c},getImageUrl:function(a){var c=this.ctx.getFileManager();if(c&&c){var e=null;this.resizeThumb&&(e={width:this.thumbSize});return c.getImageUrl(a,null,e)}return null}})})},
"xfile/FileActions":function(){define("dcl/dcl xdojo/declare xdojo/has dojo/Deferred xide/utils xide/types xide/factory xide/model/Path xaction/DefaultActions xide/editor/Registry xide/editor/Default dojo/aspect xfile/views/FileOperationDialog xfile/views/FilePreview xide/views/_CIDialog xide/views/_Dialog xide/views/_PanelDialog xfile/views/FilePicker".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d,p,w,k,f,b,l){function t(){return{includes:["*",".*"],excludes:[],mode:1502}}function y(f,d){var k=d.userData.value||
"./AA/xfile_last/data/su.jpg",t=new e,p=this,n=new b({size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:d.title,onOk:function(){var b=this.picker._selection;b&&b[0]&&(d.set("value",b[0].path),t.resolve(b[0].path),n.value=b[0].path)},onShow:function(b,f){var d=a.addWidget(l,{ctx:p.ctx,owner:p,selection:k||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,mount:p.collection.mount,storeOptionsMixin:{includeList:"*,.*",excludeList:""},
Module:p.Module,permissions:a.clone(p.Module.DEFAULT_PERMISSIONS)},this,f,!0);this.picker=d;this.add(d,null,!1);this.startDfd.resolve();return[this.picker]}});n.show();return t}var x=c.ACTION;d={touch:function(){var b=new e;try{var f=this,d=this.getSelectedItem(),l=this.getCurrentFolder(),t=d?a.pathinfo(d.path,c.PATH_PARTS.ALL).filename:"",p=this.collection,n={inputs:[a.createCI("Name",13,t,{widget:{instant:!0,validator:function(b){return l?null==p.getSync(l.path+"/"+b)&&0<b.length:!0}}})]},u={select:d,
focus:!0,append:!1};(new k({cis:n,title:"Create new File",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto","min-height":"80px"},_onError:function(b,f,a){b=b||this.title;(a=a||this.notificationMessage)&&a.update({message:b+this.failedText+(f?"\x3cbr/\x3e"+f:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(f)},onCancel:function(){b.resolve()},onOk:function(){var a=this.getField("name");if(null==a)b.resolve(u);else{var d=(f.getCurrentFolder()||{path:"."}).path+
"/"+a;f.ctx.getFileManager().mkfile(p.mount,d,{checkErrors:!0,returnProm:!1}).then(function(a){f.runAction(x.RELOAD).then(function(){p.getSync(d)&&b.resolve({select:d,append:!1,focus:!0})})},function(f){b.resolve(u);logError(f,"error creating directory")})}}})).show()}catch(w){logError(w,"error creating dialog")}return b},newTabArgs:null,openInOS:function(b){var f=this.ctx.getResourceManager().getVariable("VFS_CONFIG")||{},d=b.mount.replace("/","");if(f[d]){var l=window.eRequire;l||console.error("have no electron");
var k=l("os"),c=l("electron").shell,l=l("path"),d=f[d],d=a.replaceAll(" ","",d);b=b.path.replace("./","/");b=a.replaceAll("/",l.sep,b);d=l.resolve(d+l.sep+b);d=a.replaceAll(" ","",d);"win32"!==k.platform()?c.openItem(d):c.openItem("file:///"+d)}else console.error("open in os failed: have no VFS config for "+d)},getFileActions:function(b){b=b||this.permissions;var f=[],d=c.ACTION,a=c.ACTION_ICON,l=this,k=l.ctx,t=l.domNode,e=k.getResourceManager();e&&e.getVariable("VFS_CONFIG");l.getActionStore();f.push(l.createAction({label:"Go up",
command:d.GO_UP,icon:a.GO_UP,tab:"Home",group:"Navigation",keycombo:["backspace"],mixin:{quick:!0}}));f.push(l.createAction({label:"Copy",command:d.COPY,icon:"fa-paste",tab:"Home",group:"Organize",keycombo:["f5"],shouldDisable:function(){return null==l.getSelectedItem()}}));f.push(l.createAction({label:"Close",command:d.CLOSE,icon:"fa-close",tab:"View",group:"Organize",keycombo:["ctrl 0"]}));f.push(l.createAction({label:"Move",command:d.MOVE,icon:"fa-long-arrow-right",tab:"Home",group:"Organize",
keycombo:["f6"],shouldDisable:function(){return null==l.getSelectedItem()}}));location.href.indexOf("electron\x3dtrue")||g("electronx");f.push(this.createAction("Open In New Tab","File/OpenInNewTab","fa-share",["alt enter"],"Home","Open","item",null,null,{quick:!0},null,function(){var b=l.getSelectedItem();return b&&b.isDir?!1:!0},b,t,l));if(k&&k.getMountManager&&m.hasAction(b,d.SOURCE)){b.push(d.SOURCE);var p=k.getMountManager().getMounts(),n=0;if(p&&0<p.length){var u=l.collection.mount;f.push(this.createAction({label:"Source",
command:d.SOURCE,icon:"fa-hdd-o",keyCombo:["ctrl f1"],tab:"Home",group:"Navigation",mixin:{data:p,addPermission:!0,quick:!0},onCreate:function(b){b.set("value",u)}}));_.each(p,function(a){var k=a.label;b.push(d.SOURCE+"/"+k);k=l.createAction({label:k,command:d.SOURCE+"/"+k,icon:"fa-hdd-o",keyCombo:["alt f"+n],tab:"Home",group:"Navigation",mixin:{data:p,item:a,closeOnClick:!1,quick:!0},onCreate:function(b){b.set("value",a.name);b._oldIcon=this.icon;b.actionType=c.ACTION_TYPE.SINGLE_TOGGLE}});f.push(k);
n++})}}return f.concat(this.getEditorActions(b))},rename:function(b){var f=new e,d=this,l=b||this.getSelectedItem();b=this.getSelection();var t=this.getCurrentFolder(),p=l?a.pathinfo(l.path,c.PATH_PARTS.ALL).basename:"",n=this.collection,u={select:b,focus:!0,append:!1};b={inputs:[a.createCI("name",c.ECIType.STRING,p,{widget:{instant:!0,title:"New Name",validator:function(b){return null==n.getSync(t.path+"/"+b)&&0<b.length}}})]};(new k({cis:b,title:"Rename",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,
bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){f.resolve(u)},onOk:function(){var b=this.getField("name");if(null==b)f.resolve(u);else{var a=d.getCurrentFolder();d.ctx.getFileManager().rename(l.mount,l.path,b,{checkErrors:!0,returnProm:!1}).then(function(l){d.runAction(x.RELOAD).then(function(){u.select=a.path+"/"+b;f.resolve(u)})},function(b){logError(b,"__error renaming file!");f.resolve(u)})}}})).show();return f},move:function(b){var f=new e,d=this;
b=this.getSelectedItem();var l=this.getSelection(),p=this.getCurrentFolder();b&&a.pathinfo(b.path,c.PATH_PARTS.ALL);var n=this.collection,u={select:l,focus:!0,append:!1};if(!b.directory){var w=b.getParent();w&&(b=w)}b={inputs:[a.createCI("Name",c.ECIType.FILE,b.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==n.getSync(p.path+"/"+b)&&0<b.length}}})]};var g=new k({cis:b,title:d.localize("Move"),ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,onCancel:function(){f.resolve(u)},
onOk:function(){var b=this.getField("name");if(null==b)f.resolve(u);else{var k=d._buildServerSelection(l),c=(b=d.collection.getSync(b))?a.normalizePath(b.mount+"/"+b.path):"";b&&(k.dstPath=c);b=t();d.getCurrentFolder();d.ctx.getFileManager().moveItem(k.selection,k.dstPath,b.includes,b.excludes,b.mode,{checkErrors:!0,returnProm:!1}).then(function(b){d.runAction(x.RELOAD).then(function(){f.resolve(u)})},function(b){logError(b,"__error creating file!");f.resolve(u)})}}});g._on("widget",function(b){b.widget._onSelect=
function(b){return y.apply(d,[g,b])}});g.show();return f},copy:function(b){var f=new e,d=this,l=this.getSelectedItem(),n=this.getSelection(),u=this.getCurrentFolder();l&&a.pathinfo(l.path,c.PATH_PARTS.ALL);var w=this.collection,g={select:n,focus:!0,append:!1};l.directory||(b=l.getParent())&&(l=b);b={inputs:[a.createCI("Name",c.ECIType.FILE,l.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==w.getSync(u.path+"/"+b)&&0<b.length}}})]};var m=new (q([p,k],{}))({cis:b,title:d.localize("Copy"),
ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){f.resolve(g)},onOk:function(){var b=this.getField("name");if(null==b)f.resolve(g);else{this.showMessage();var k=this,c=d._buildServerSelection(n),e=d.collection.getSync(b),p=e?a.normalizePath(e.mount+"/"+e.path):"";c.dstPath=e?p:a.normalizePath(l.mount+"/"+b);d.getCurrentFolder();b=d.ctx.getFileManager().copyItem(c.selection,c.dstPath,t(),{checkErrors:!0,returnProm:!1});
b.then(function(b){k._onSuccess(b)},function(b){k._onError()});b.then(function(b){d.runAction(x.RELOAD).then(function(){f.resolve(g)})},function(b){logError(b,"__error creating file!");f.resolve(g)})}}});m._on("widget",function(b){b.widget._onSelect=function(b){return y.apply(d,[m,b])}});m.show();return f},clipboardPaste:function(){var b=new e,f=this.currentCutSelection,d=f?this.currentCutSelection:this.currentCopySelection,l=this._buildServerSelection(d),f=f?"moveItem":"copyItem",a=this,k={select:d,
focus:!0,append:!1};if(!d)return b.resolve(),b;d=t();a.ctx.getFileManager()[f](l.selection,l.dstPath,{include:d.includes,exclude:d.excludes,mode:d.mode}).then(function(f){a.runAction(c.ACTION.RELOAD).then(function(){b.resolve(k)})},function(f){b.resolve(k)},function(f){b.resolve(k)});return b},mkdir:function(){var b=new e;try{var f=this,d=this.getSelectedItem(),l=this.getCurrentFolder(),t=d?a.pathinfo(d.path,c.PATH_PARTS.ALL).filename:"",p=this.collection,n={inputs:[a.createCI("Name",13,t,{widget:{instant:!0,
validator:function(b){return l?null==p.getSync(l.path+"/"+b)&&0<b.length:!0}}})]},u={select:d,focus:!0,append:!1};(new k({cis:n,title:"Create new Directory",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},_onError:function(b,f,d){b=b||this.title;(d=d||this.notificationMessage)&&d.update({message:b+this.failedText+(f?"\x3cbr/\x3e"+f:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(f)},onCancel:function(){b.resolve()},
onOk:function(){var d=this.getField("name");if(null==d)b.resolve(u);else{var l=(f.getCurrentFolder()||{path:"."}).path+"/"+d;f.ctx.getFileManager().mkdir(p.mount,l,{checkErrors:!0,returnProm:!1}).then(function(d){f.runAction(x.RELOAD).then(function(){p.getSync(l)&&b.resolve({select:l,append:!1,focus:!0})})},function(f){b.resolve(u);logError(f,"error creating directory")})}}})).show()}catch(g){logError(g,"error creating dialog")}return b},_buildServerSelection:function(b,f){!f&&(f=this.getCurrentFolder());
f&&!f.directory&&(f=f.getParent());_.isArray(b)||(b=[b]);var d=[],l=b[0].getStore(),k=f?a.normalizePath(f.mount+"/"+f.path):"";_.each(b,function(b){l.getSync(b.path)&&d.push(a.normalizePath(b.mount+"/"+b.path))});return{selection:d,store:b[0]._S,dstPath:"/"+k+"/",firstItem:b[0],parent:f}},openPreview:function(b,f){var d=this.row(b).element,l=this,a=new e;if(this._preview)return this._preview.item=b,this._preview.open().then(function(){l._preview.preview.trigger($.Event("update",{file:b}))});var k=
new w({node:$(d),item:b,delegate:this.ctx.getFileManager(),parent:$(d),ctx:l.ctx,container:f?f.containerNode:null});f?k.buildRenderingEmbedded():k.buildRendering();k.init();k.exec();this._preview=k;this._preview.handler=this;l._on("selectionChanged",function(b){if(b=l.getSelectedItem())k.item=b,k.preview.trigger($.Event("update",{file:b}))});this.add(k,null,!1);k._emit("changeState",function(f){0===f&&a.resolve({select:b,focus:!0,append:!1})});return a},deleteSelection:function(b){b=b||this.getSelection();
var f=new e,d=this.getNext(b[0],null,!0),l=this.getPrevious(b[0],null,!0),a=d||l,k=this._buildServerSelection(b),t=this;(new p({ctx:t.ctx,notificationMessage:null,title:"Delete "+k.selection.length+" items",type:c.DIALOG_TYPE.DANGER,onBeforeOk:function(){},getOkDfd:function(){var b=this;return this.ctx.getFileManager().deleteItems(k.selection,{hints:[1]},{checkErrors:!1,returnProm:!1,onError:function(f){b._onError(null,f.message)}})},onCancel:function(){f.resolve({select:b,focus:!0,append:!1})},onSuccess:function(){t.runAction(c.ACTION.RELOAD).then(function(){f.resolve({select:a,
focus:!0,append:!1})})}})).show();return f},goUp:function(b){b=this._history.getNow();b=_.isString(b)?this.collection.getSync(b):b;var f=new e,d=this,l=this.getHistory().getNow();if(!b){var a=this.getRows();a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&(b=a)}b?(a=b._S.getParent(b))&&(b=this.openFolder(a,!0,!1))&&b.then&&b.then(function(){if(l){var b=d.collection.getSync(l);b&&f.resolve({select:b,focus:!0,delay:1})}}):l?(b=this.collection.getSync(l))&&this.select([b],null,!0,{focus:!0,
delay:1}):(a=this.getRows(),a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&this.openFolder(a,!0));return f},reload:function(b){var f=new e,d=this.getSelection();b=b||this.getRows()[0];var l=this.getCurrentFolder()||{path:"."},a=this;l.isBack&&(l=this.collection.getSync(l.rPath));var k=!1;this.isExpanded&&this.expand&&b&&(k=this._isExpanded(b))&&this.expand(b,null,!1);a.collection.resetQueryLog();this.collection.loadItem(l,!0).then(function(b){"."===l&&a.collection.resetQueryLog();
a.refresh().then(function(){var b=a.openItem(l,!1,!1);b&&b.then&&b.then(function(){f.resolve({select:d,append:!1,focus:!0,delay:1})});a.deselectAll();f.resolve({select:d,append:!1,focus:!0,delay:2})})});return f},toHistory:function(b){b=(b.getFolder?new v(b.getFolder()):new v(".")).getSegments();var f=this.collection.rootSegment,d=f;b&&"."===b[0]&&(b[0]=f);var l=[];_.each(b,function(b){b=b!==d?d+(d.endsWith("/")?"":"/")+b:b;l.push(b);d=b});return l},openFolder:function(b,f,d){var l=this.getCurrentFolder(),
a=this.collection,k=this.getHistory();k.getNow();k.getNow();var c=this;(b=_.isString(b)?a.getSync(b):a.getSync(b.path)||b)||(b=a.getRootItem());var t=c.toHistory(b);k.set(t);if(!b)return this.setQueryEx(a.getRootItem());if(!(l&&b&&f&&l.path===b.path)&&b){this.deselectAll();var l=(l=this.row(b))?l.element:null,p;b._S.isItemLoaded(b)||((l=$(l).find("span.fa"))&&l[0]&&(p=$(l[0])),p&&(p.removeClass("fa fa-folder"),p.addClass("fa-spinner fa-spin")));var n=new e;this._emit("openFolder",{item:b,back:f});
(l=this.setQueryEx(b,null))&&l.then(function(){p&&(p.addClass("fa fa-folder"),p.removeClass("fa-spinner fa-spin"));n.resolve({select:!1!==d?f?b:c.getRows()[0]:null,focus:!0,append:!1,delay:1});c._emit("openedFolder",{item:b,back:f})});return n}},changeSource:function(b,f){var d=new e,l=this,a=l.ctx||a,k=a.getFileManager(),c=u.createFileStore(b.name,null,k.config,null,a),p=this.collection,a=this.getAction(x.SOURCE),k=b.label||b.name,t=this.getAction(x.SOURCE+"/"+k);p.destroy();!0!==f&&this._emit("changeSource",
b);this.set("loading",!0);this.set("collection",c.getDefaultCollection());a.set("value",b.name);l.set("title","Files ("+b.label+")");c=a.getChildren();_.each(c,function(b){b.set("icon",b._oldIcon)});a.set("label",k);t&&t.set("icon","fa-spinner fa-spin");this.refresh().then(function(){l.set("loading",!1);t&&t.set("icon","fa-check");!0!==f&&l._emit("changedSource",b);l.select([0],null,!0,{append:!1,focus:!0}).then(function(){d.resolve()})});return d},openInNewTab:function(b){var f=this.ctx,d=f.getWindowManager(),
l=new e,k=null,k=_.isFunction(this.newTarget)?this.newTarget({title:b.name,icon:"fa-folder",target:this._parent,location:null,tabOrientation:null}):d.createTab(b.name,"fa-folder",this.newTarget||this),c=this.collection;b.isDir||(b=this.getCurrentFolder());var t=u.createFileStore(c.mount,c.options,c.config,null,f),f=a.mixin({showToolbar:this.showToolbar,collection:t,selectedRenderer:this.selectedRenderer,showHeader:this.showHeader,newTarget:this.newTarget,style:this.style,options:a.clone(this.options),
permissions:this.permissions,_columns:this._columns,attachDirect:!0,registerEditors:this.registerEditors},this.newTabArgs||{}),p=a.addWidget(this.getClass(),f,null,k,!1);l.resolve();p.set("loading",!0);t.initRoot().then(function(f){(f=t.getItem(b.path,!0))&&f.then(function(){p.startup();p.refresh().then(function(){p.openItem(b).then(function(){p.focus();p.select([0],null,!0,{focus:!0,append:!1,delay:1});p.set("loading",!1)});d.registerView(p,!0)})})});return l},openItem:function(b,f,d){if(!b){var l=
this.getRows();l[0]&&l[0].isBack&&(b=l[0])}if(b&&b.isBack)return b._S=null,this.goUp();if(b=_.isString(b)?this.collection.getSync(b):b){if(!0===b.directory)return this.openFolder(b,f,d);f=r.getEditors(b);return(f=_.find(f,function(b){return!0===b.isDefault}))?f.onEdit(b,this):this.ctx.getWindowManager().openItem(b,this.newTarget||this,{global:!0})}},getSelectedItem:function(){return this.getSelection()[0]},openDefaultEditor:function(b){return n.Implementation.open(b)},close:function(){var b=this._parent;
if(b){var f=b.docker();f&&(this.onAfterAction=null,f.removePanel(b))}return!1},compress:function(b){b=b||this.getSelection();var f=this;(b=this._buildServerSelection(b))&&b.store&&b.selection&&f.ctx.getFileManager().compressItem(b.firstItem.mount,b.selection,"zip").then(function(b){f.reload()})},runAction:function(b,f){_.isString(b)&&(b=this.getAction(b));if(b&&b.command){var d=c.ACTION,l=this.getSelectedItem()||f,a=this.getSelection();if(-1!=b.command.indexOf(x.SOURCE))return this.changeSource(b.item);
switch(b.command){case "File/Compress":return this.compress(a);case d.PREVIEW:return this.openPreview(l);case "File/OpenInNewTab":return this.openInNewTab(l||this.collection.getRootItem());case d.EDIT:return this.openItem(l);case d.NEW_FILE:return this.touch(l);case d.NEW_DIRECTORY:return this.mkdir(l);case d.RELOAD:return this.reload(l);case d.RENAME:return this.rename(l);case d.GO_UP:return this.goUp(null);case d.COPY:return this.copy(null);case d.MOVE:return this.move(null);case d.DELETE:return this.deleteSelection(null);
case d.OPEN_IN+"/Default Editor":return this.openDefaultEditor(l);case d.DOWNLOAD:return this.ctx.getFileManager().download(l);case d.CLOSE:return this.close();case "File/OpenInOS":return this.openInOS(l)}return-1!=b.command.indexOf(d.OPEN_IN+"/")?b.editor.onEdit(l):this.inherited(arguments)}},getEditorActions:function(b){function f(b){function d(b,f){f.handler=function(){b.onEdit(e.getSelection()[0])}}function l(b){b=r.getEditors(b)||[];for(var f=[],a=0;a<b.length;a++){var k=b[a];if("Default Editor"!==
k.name){var c=e.createAction(k.name,t.OPEN_IN+"/"+k.name,k.iconClass,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",editor:k,custom:!0,quick:!0},null,null,p,n,e);d(k,c);f.push(c)}}return f}var a=b.selection;if(a&&a[0]){var k=a[0],p=this.permissions,t=c.ACTION,e=this,n=e.domNode,u=e.getActionStore(),a=this.getContextMenu();"deselect"!=b.why&&(u.getSync(c.ACTION.OPEN_IN),b=e.addActions(l(k)),this._lastEditorActions&&(_.each(this._lastEditorActions,function(b){u.removeSync(b.command)}),
delete this._lastEditorActions),a&&a.removeCustomActions(),0<b.length&&(b=this.addActions(b),u._emit("onActionsAdded",b),this._lastEditorActions=b))}}b=b||this.permissions;var d=[],l=c.ACTION,a=c.ACTION_ICON,k=this,p=k.domNode;k.getActionStore();var t=null;this._selHandle||(this._selHandle=this._on("selectionChanged",function(b){f.apply(k,[b])}));t=this.createAction("Open In",l.OPEN_IN,a.EDIT,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",quick:!0},null,m.shouldDisableDefaultFileOnly,
b,p,k);d.push(t);b=k.createAction("Default Editor",l.OPEN_IN+"/Default Editor","fa-code",null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",forceSubs:!0,quick:!0},null,null,b,p,k);d.push(b);return d}};h=h("xfile.FileActions",null,d);h.Implementation=d;h.createFilePicker=function(f,d,k,p,t,e,n,u){(new b({size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:p,onOk:function(){var b=this.picker._selection;
b&&b[0]&&(k(b[0]),n&&n.resolve(b[0],b,this.picker))},onShow:function(b,k){var p=a.addWidget(l,a.mixin({ctx:f.ctx,owner:f,selection:d||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:u,permissions:t||a.clone(c.DEFAULT_FILE_GRID_PERMISSIONS)},e),this,k,!0);this.picker=p;this.add(p);this.startDfd.resolve();return[this.picker]}})).show();return n};return h})},"xfile/views/FileOperationDialog":function(){define(["dcl/dcl","xide/types","xide/views/_Dialog"],
function(q,h,g){return q(g,{title:"",type:h.DIALOG_TYPE.INFO,size:h.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{},failedText:" Failed!",successText:": Success!",showSpinner:!0,spinner:'  \x3cspan class\x3d"fa-spinner fa-spin"/\x3e',notificationMessage:null,doOk:function(e){this.onBeforeOk&&this.onBeforeOk();this.showMessage();var a=this;e.then(function(c){a._onSuccess(c)},function(c){a._onError()})},_onSuccess:function(e,a,c){e=e||this.title;(c=c||this.notificationMessage)&&c.update({message:e+this.successText+
(a?"\x3cbr/\x3e"+a:""),type:"info",actions:!1,duration:1500});this.onSuccess&&this.onSuccess()},_onError:function(e,a,c){e=e||this.title;(c=c||this.notificationMessage)&&c.update({message:e+this.failedText+(a?"\x3cbr/\x3e"+a:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(a)},onOk:function(){this.showMessage();this.doOk(this.getOkDfd())},showMessage:function(e){if(this.notificationMessage)return this.notificationMessage;e=e||this.title;return this.notificationMessage=e=this.ctx.getNotificationManager().postMessage({message:e+
(this.showSpinner?this.spinner:""),type:"info",showCloseButton:!0,duration:4500})}})})},"xfile/views/FilePreview":function(){define("dcl/dcl xide/types xide/utils xide/mixins/EventedMixin xide/widgets/_Widget dojo/cache dojo/Deferred dijit/registry xide/editor/Default xaction/DefaultActions".split(" "),function(q,h,g,e,a,c,u,v,m,r){var n=[function(d){var a=["image/jpeg","image/png","image/gif"],c=d.preview;$.each(navigator.mimeTypes,function(d,f){var b=f.type;0===b.indexOf("image/")&&$.inArray(b,
a)&&a.push(b)});c.bind("update",function(k){var f=k.file,b;d.opened()&&-1!==$.inArray(f.mime,a)&&(k.stopImmediatePropagation(),k=null,d.resizeToPreview&&(k={width:c.width()}),b=$("\x3cimg/\x3e").hide().appendTo(c).load(function(){setTimeout(function(){var f=(b.width()/b.height()).toFixed(2);c.bind("changesize",function(){var d=parseInt(c.width()),a=parseInt(c.height()),k;f<(d/a).toFixed(2)?(k=a,d=Math.floor(k*f)):k=Math.floor(d/f);b.width(d).height(k).css("margin-top",k<a?Math.floor((a-k)/2):0)}).trigger("changesize");
d.hideinfo();b.fadeIn(100)},1)}),b.attr("src",d.fm.url(f,null,k)))})},function(d){var a=["text/html","application/xhtml+xml"],c=d.preview;c.bind("update",function(k){var f=k.file;d.opened()&&-1!==$.inArray(f.mime,a)&&(k.stopImmediatePropagation(),d.ctx.getFileManager().getContent(f.mount,f.path,function(b){d.hideinfo();doc=$('\x3ciframe class\x3d"elfinder-quicklook-preview-html"/\x3e').appendTo(c)[0].contentWindow.document;doc.open();doc.write(b);doc.close()}))})},function(d){var a=d.preview,c="application/x-empty application/javascript application/xhtml+xml audio/x-mp3-playlist application/x-web-config application/docbook+xml application/x-php application/x-perl application/x-awk application/x-config application/x-csh application/xml application/x-empty text/html text/x-c text/x-php text/plain text/x-c++ text/x-lisp".split(" ");
a.bind("update",function(k){var f=k.file,b=f.mime;if(d.opened()&&(0===b.indexOf("text/")||-1!==$.inArray(b,c))&&(k.stopImmediatePropagation(),d.useAce)){d.hideinfo();k=$('\x3cdiv class\x3d"elfinder-quicklook-preview-text-wrapper"\x3e\x3c/div\x3e');k.appendTo(a);var l=d._editor,b=l;if(!l&&(l=m.Implementation.open(f,k[0],d.editorOptions,!1,d),d._editor=l,d.add(l,null,!1),r.hasAction(d.editorOptions.permissions,h.ACTION.TOOLBAR))){var t=l.getToolbar();t&&$(t.domNode).addClass("bg-opaque")}b&&(k.append(l.domNode),
l.set("item",f));a.bind("changesize",function(){parseInt(a.width());parseInt(a.height());g.resizeTo(l.domNode,a[0],!0,!0);l.resize()})}})},function(d){var a=d.preview,c=!1,c=!1;$.each(navigator.plugins,function(d,f){$.each(f,function(b,f){if("application/pdf"==f.type)return!(c=!0)})});c&&a.bind("update",function(k){var f=k.file,b;d.opened()&&"application/pdf"==f.mime&&(k.stopImmediatePropagation(),a.one("change",function(){b.unbind("load").remove()}),b=$('\x3ciframe class\x3d"elfinder-quicklook-preview-pdf"/\x3e').hide().appendTo(a).load(function(){d.hideinfo();
b.show()}).attr("src",d.fm.url(f)))})},function(d){var a=d.fm,c=d.preview,k=!1;$.each(navigator.plugins,function(f,b){$.each(b,function(b,f){if("application/x-shockwave-flash"==f.type)return!(k=!0)})});k&&c.bind("update",function(f){var b=f.file;d.opened()&&"application/x-shockwave-flash"==b.mime&&(f.stopImmediatePropagation(),d.hideinfo(),c.append($('\x3cembed class\x3d"elfinder-quicklook-preview-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer" src\x3d"'+a.url(b)+'" quality\x3d"high" type\x3d"application/x-shockwave-flash" /\x3e')))})},
function(d){var a=d.preview,c=!!d.options.autoplay,k={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},f;a.bind("update",function(b){if(d.opened()){var l=b.file;d.support.audio[k[l.mime]]&&(b.stopImmediatePropagation(),f=$('\x3caudio class\x3d"elfinder-quicklook-preview-audio" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
d.fm.url(l)+'" /\x3e\x3c/audio\x3e').appendTo(a),c&&f[0].play())}}).bind("change",function(){f&&f.parent().length&&(f[0].pause(),f.remove(),f=null)})},function(d){var a=d.preview,c=!!d.options.autoplay,k={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},f;a.bind("update",function(b){if(d.opened()){var l=b.file;d.support.video[k[l.mime]]&&(b.stopImmediatePropagation(),d.hideinfo(),f=$('\x3cvideo class\x3d"elfinder-quicklook-preview-video" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
d.fm.url(l)+'" /\x3e\x3c/video\x3e').appendTo(a),c&&f[0].play())}}).bind("change",function(){f&&f.parent().length&&(f[0].pause(),f.remove(),f=null)})},function(d){var a=d.preview,c=[],k;d.opened()&&($.each(navigator.plugins,function(f,b){$.each(b,function(b,f){0!==f.type.indexOf("audio/")&&0!==f.type.indexOf("video/")||c.push(f.type)})}),a.bind("update",function(f){if(d.opened()){var b=f.file,l=b.mime;-1!==$.inArray(b.mime,c)&&(f.stopImmediatePropagation(),(f=0===l.indexOf("video/"))&&d.hideinfo(),
k=$('\x3cembed src\x3d"'+d.fm.url(b)+'" type\x3d"'+l+'" class\x3d"elfinder-quicklook-preview-'+(f?"video":"audio")+'"/\x3e').appendTo(a))}}).bind("change",function(){k&&k.parent().length&&(k.remove(),k=null)}))}];e=q([a.dcl,e.dcl],{resizeToPreview:!0,useAce:!0,registerEditors:!1,editorPermissions:[],container:null,destroy:function(){this.window.empty();g.destroy(this.window[0]);this.inherited(arguments)},init:function(){var d=this.options={autoplay:!0,jplayer:"extensions/jplayer",ui:"button"},a=this,
c=this.window,k=this.preview,f=this.container;width=0<d.width?parseInt(d.width):450;height=0<d.height?parseInt(d.height):300;f||c.appendTo("body").zIndex(20);$(document).keydown(function(b){27==b.keyCode&&a.opened()&&c.trigger("close")});!f&&$.fn.resizable&&c.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){k.trigger("changesize")}});$.each(n||[],function(b,f){"function"==typeof f&&new f(a)});k.bind("update",function(){a.info.show()})},buildRenderingEmbedded:function(){var d=this,
a=this.navicon,c=this.container?$(this.container):null;$('\x3cdiv class\x3d"elfinder-quicklook-title" style\x3d"display: none"\x3e'+d.title+"\x3c/div\x3e");var k=$("\x3cdiv/\x3e"),f=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');d.openDfd=new u;d.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var f=d.window,k=f.is("."+d.fullscreen),c=$(window);b.stopPropagation();k?(f.css(f.data("position")).unbind("mousemove"),c.unbind("scroll.elfinder-finder").trigger(d.resize).unbind(d.resize),
d.navbar.unbind("mouseenter").unbind("mousemove")):(f.data("position",{left:f.css("left"),top:f.css("top"),width:f.width(),height:f.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){f.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(d.resize,function(b){d.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(d.resize),f.bind("mousemove",function(b){d.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),
d.navbar.mouseenter(function(){d.navbar.stop(!0,!0).show()}).mousemove(function(b){b.stopPropagation()}));d.navbar.attr("style","").draggable(k?"destroy":{});f.toggleClass(d.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});d.navbar=$('\x3cdiv class\x3d"" style\x3d"display: none;"/\x3e');d.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(b){d.info.attr("style","").hide();k.removeAttr("class").attr("style","");
f.html("")}).bind("update",function(b){var f=b.file;f?(!f.read&&b.stopImmediatePropagation(),d.preview.unbind("changesize").trigger("change").children().remove(),d.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});d.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(k).append(f);d.window=$('\x3cdiv id\x3d"'+d.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d""/\x3e').click(function(b){b.stopPropagation()}).append(d.preview).append(d.info.hide()).bind("open",
function(b){d._open=!0;b=d.window;var f=d.node;d.closed()&&(d.update(1,d.value),d.navbar.attr("style",""),d.state=1,f&&f.trigger("scrolltoview"),b.css(d.closedCss(f)).show().animate(d.openedCss(),550,function(){d.state=2;d.update(2,d.value);d.openDfd.resolve()}))}).bind("close",function(b){var f=d.window,a=d.preview.trigger("change");b={};var k=function(){d._open=!1;d.state=0;f.hide();a.children().remove();d.update(0,d.value)};d.opened()&&(state=1,f.is("."+d.fullscreen)&&d.fsicon.mousedown(),b.length?
f.animate(d.closedCss(b),500,k):k())});c&&(console.error("container!"),c.append(d.window));c=this.supportTest;d.support={audio:{ogg:c('audio/ogg; codecs\x3d"vorbis"'),mp3:c("audio/mpeg;"),wav:c('audio/wav; codecs\x3d"1"'),m4a:c("audio/x-m4a;")||c("audio/aac;")},video:{ogg:c('video/ogg; codecs\x3d"theora"'),webm:c('video/webm; codecs\x3d"vp8, vorbis"'),mp4:c('video/mp4; codecs\x3d"avc1.42E01E"')||c('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},buildRendering:function(){var d=this,a=this.navicon,
c=this.container?$(this.container):null,k=$('\x3cdiv class\x3d"elfinder-quicklook-title"\x3e'+d.title+"\x3c/div\x3e"),f=$("\x3cdiv/\x3e"),b=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');d.openDfd=new u;d.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var f=d.window,k=f.is("."+d.fullscreen),c=$(window);b.stopPropagation();k?(f.css(f.data("position")).unbind("mousemove"),c.unbind("scroll.elfinder-finder").trigger(d.resize).unbind(d.resize),d.navbar.unbind("mouseenter").unbind("mousemove")):
(f.data("position",{left:f.css("left"),top:f.css("top"),width:f.width(),height:f.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){f.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(d.resize,function(b){d.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(d.resize),f.bind("mousemove",function(b){d.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),d.navbar.mouseenter(function(){d.navbar.stop(!0,
!0).show()}).mousemove(function(b){b.stopPropagation()}));d.navbar.attr("style","").draggable(k?"destroy":{});f.toggleClass(d.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});d.navbar=$('\x3cdiv class\x3d"elfinder-quicklook-navbar"/\x3e').append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-left"/\x3e').mousedown(function(){d.navtrigger(37)})).append(d.fsicon).append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-right"/\x3e').mousedown(function(){d.navtrigger(39)})).append('\x3cdiv class\x3d"elfinder-quicklook-navbar-separator"/\x3e').append($('\x3cdiv class\x3d"'+
a+" "+a+'-close"/\x3e').mousedown(function(){d.window.trigger("close")}));d.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(a){d.info.attr("style","").hide();f.removeAttr("class").attr("style","");b.html("")}).bind("update",function(b){var f=b.file;f?(!f.read&&b.stopImmediatePropagation(),d.preview.unbind("changesize").trigger("change").children().remove(),d.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});d.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(f).append(b);
d.window=$('\x3cdiv id\x3d"'+d.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d"position:absolute"/\x3e').click(function(b){b.stopPropagation()}).append($('\x3cdiv class\x3d"elfinder-quicklook-titlebar"/\x3e').append(k).append($('\x3cspan class\x3d"fa-close" style\x3d"margin-left: 4px; color: white; font-size: 16px; text-align: center; position: absolute; left: 0px; top: 2px;"/\x3e').mousedown(function(b){b.stopPropagation();d.window.trigger("close")}))).append(d.preview.add(d.navbar)).append(d.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",
function(b){d._open=!0;b=d.window;var f=d.node;d.closed()&&(d.update(1,d.value),d.navbar.attr("style",""),d.state=1,f.trigger("scrolltoview"),b.css(d.closedCss(f)).show().animate(d.openedCss(),550,function(){d.state=2;d.update(2,d.value);d.openDfd.resolve()}))}).bind("close",function(b){var f=d.window,a=d.preview.trigger("change");b={};var k=function(){d._open=!1;d.state=0;f.hide();a.children().remove();d.update(0,d.value)};d.opened()&&(state=1,f.is("."+d.fullscreen)&&d.fsicon.mousedown(),b.length?
f.animate(d.closedCss(b),500,k):k())});c&&(console.error("container!"),c.append(d.window));c=this.supportTest;d.support={audio:{ogg:c('audio/ogg; codecs\x3d"vorbis"'),mp3:c("audio/mpeg;"),wav:c('audio/wav; codecs\x3d"1"'),m4a:c("audio/x-m4a;")||c("audio/aac;")},video:{ogg:c('video/ogg; codecs\x3d"theora"'),webm:c('video/webm; codecs\x3d"vp8, vorbis"'),mp4:c('video/mp4; codecs\x3d"avc1.42E01E"')||c('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},constructor:function(a){g.mixin(this,a)},editorOptions:{permissions:[h.ACTION.TOOLBAR,
h.ACTION.RELOAD,"Editor/Settings","View/Increase Font Size","View/Decrease Font Size","View/Themes","File/Search"]},title:"Preview",width:450,height:300,fm:null,state:0,navicon:"elfinder-quicklook-navbar-icon",fullscreen:"elfinder-quicklook-fullscreen",parent:null,cwd:null,resize:"resize.elfinder-finder",alwaysEnabled:!0,value:null,handlers:{select:function(){this.update(void 0,this.fm.selectedFiles()[0])},error:function(){self.window.is(":visible")&&self.window.data("hash","").trigger("close")},
"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}},shortcuts:[{pattern:"space"}],navtrigger:function(a){$(document).trigger($.Event("keydown",{keyCode:a,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1}))},closedCss:function(a){return{opacity:0,width:20,height:20,top:a?a.offset().top+"px":0,left:a?a.offset().left+"px":0}},openedCss:function(){var a=this.container?$(this.container):null,c=a||$(window),e=a?"100%":Math.min(this.width,c.width()-10),a=a?"100%":Math.min(this.height,
c.height()-80);return{opacity:1,width:e,height:a,top:parseInt((c.height()-a-60)/2+c.scrollTop()),left:parseInt((c.width()-e)/2+c.scrollLeft())}},supportTest:function(a){var c=document.createElement(a.substr(0,a.indexOf("/"))),e=!1;try{e=c.canPlayType&&c.canPlayType(a)}catch(k){}return e&&""!==e&&"no"!=e},changeView:function(a){this.currentView&&(g.destroy(this.currentView),this.currentView.destroy&&this.currentView.destroy())},update:function(a){this._open=a;this._emit("changeState",a);if(1==a&&this.onAnimate)this.onAnimate();
if(2==a&&this.onOpened)this.onOpened();if(0==a&&this.onClosed)this.onClosed()},closed:function(){return 0==this.state},opened:function(){return 2==this.state},bind:function(a,c){var e;if("function"==typeof c)for(a=(""+a).toLowerCase().split(/\s+/),e=0;e<a.length;e++)void 0===listeners[a[e]]&&(listeners[a[e]]=[]),listeners[a[e]].push(c);return this},one:function(a,c){var e=this,k=$.proxy(c,function(f){setTimeout(function(){e.unbind(f.type,k)},3);return c.apply(this,arguments)});return this.bind(a,
k)},open:function(a){var c=this;a=c.window;var e=c.node;c._open=!0;c.openDfd=new u;c.closed()?(c.navbar.attr("style",""),c._open=!0,c.state=1,e&&e.trigger("scrolltoview"),a.css(c.closedCss(e)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(1,c.value);c.openDfd.resolve()})):c.openDfd.resolve();return c.openDfd},close:function(a){this._open=!1;var c=this,e=c.window,k=c.preview.trigger("change");a=c.node;var f=function(){c.state=0;e.hide();k.children().remove();c.update(0,c.value);c.closeDfd&&
c.closeDfd.resolve()};c.opened()&&(c.state=1,e.is("."+c.fullscreen)&&c.fsicon.mousedown(),a&&a.length?e.animate(c.closedCss(a),500,f):f());return c.closeDfd},getstate:function(){return 2==this.state?1:0},exec:function(){this.window.trigger(this.opened()?"close":"open")},hideinfo:function(){this.info.stop(!0).hide()}});e=q(e,{destroy:function(){this.close();this.preview.trigger($.Event("update",{file:null}));this.inherited(arguments);g.destroy(this._editor);g.destroy(this.preview);g.destroy(this.window)},
onOpened:function(){var a=this;a.fm={url:function(c,e,k){return a.delegate.getImageUrl(c,e,k)}};a.preview.trigger($.Event("update",{file:a.item}))},onClosed:function(){},onAnimate:function(){}});q=q(e,{resize:function(){this.preview.trigger("changesize")},constructor:function(a){this.parent=$(a._parent.containerNode);this.container=a._parent.containerNode;this.resizeToParent=!0;this.delegate=a.ctx.getFileManager();this.item=a.item},openItem:function(a){this.id=g.createUUID();v.add(this);this.item=
a||this.item;this.buildRenderingEmbedded();this.init();this.exec();this.window.css({height:"100%",width:"100%"});this._parent.add(this,null,!1);this.preview.trigger($.Event("update",{file:this.item}));this._parent.resize();this.resize()}});e.EditorClass=q;return e})},"xfile/views/FilePicker":function(){define("dcl/dcl xide/types xide/utils xide/factory module xide/_base/_Widget xdocker/Docker2 xfile/ThumbRenderer dojo/promise/all xfile/Breadcrumb".split(" "),function(q,h,g,e,a,c,u,v,m,r){return q(c,
{declaredClass:"xfile.views.FilePicker",templateString:'\x3cdiv class\x3d"FilePicker"\x3e\x3c/div\x3e',resizeToParent:!0,docker:null,dockerOptions:{resizeToParent:!0},breadcrumb:null,leftStore:null,rightStore:null,storeOptionsMixin:null,storeOptions:null,leftGrid:null,leftGridArgs:null,rightGrid:null,rightGridArgs:null,removePermissions:[h.ACTION.OPEN_IN_TAB],defaultGridArgs:{registerEditors:!1,_columns:{Name:!0,Path:!1,Size:!1,Modified:!1}},selection:null,mount:"root",_selection:null,getDocker:function(){if(this.docker)return this.docker;
var a=this.dockerOptions||{resizeToParent:!0},a=this.docker||u.createDefault(this.domNode,a);a.resizeToParent=!0;this.add(a,null,!1);return this.docker=a},createLayout:function(){var a=this.getDocker();this.layoutTop=a.addPanel("DefaultFixed",h.DOCKER.DOCK.TOP,null,{h:50,title:!1});this.layoutTop._minSize.y=50;this.layoutTop._maxSize.y=50;this.layoutTop._scrollable={x:!1,y:!1};this.breadcrumb=g.addWidget(r,{},null,this.layoutTop,!0);this.layoutLeft=a.addPanel("DefaultFixed",h.DOCKER.DOCK.BOTTOM,null,
{w:100,title:!1});this.layoutLeft._minSize.x=150;this.layoutLeft.moveable(!0);this.layoutMain=a.addPanel("DefaultFixed",h.DOCKER.DOCK.RIGHT,this.layoutLeft,{w:"70%",title:!1});this.layoutTop.initSize(100,"100%");this.layoutLeft.initSize("100%",150);a.resize()},setSelection:function(a){this._selection=a},connectGrids:function(a,d){var c=this;d._on("selectionChanged",function(a){"deselect"!==a.why&&(a=d.getSelection(),d.getSelectedItem()&&c.setSelection(a))});a._on("selectionChanged",function(e){e=
a.getSelection();var k=a.getSelectedItem();k||(k=a.getCurrentFolder());if(k){var f=null;k.directory?f=k:(k.getParent||console.error("item has no item.getParent!"),f=k.getParent?k.getParent():null);f&&d.openFolder(f.path,!1);k&&c.setSelection(e)}})},createFileGrid:function(a,d,c){return this.Module.createDefault(this.ctx,c,d,!1,!0,a)},onLeftGridReady:function(a){},onRightGridReady:function(a){},onError:function(a,d){},startGrids:function(a,d){var c=this,e=a.collection,k=d.collection,f={focus:!0,append:!1},
b=[a.refresh(),d.refresh()],l=this.selection,t=g.pathinfo(l,h.PATH_PARTS.ALL).dirname||"";"."===t&&(t=l);a.showStatusbar&&a.showStatusbar(!1);a._on("changeSource",function(b){d.changeSource(b,!0)});a._on("changedSource",function(b){a.select([0],null,!0,f)});d._on("changeSource",function(b){a.changeSource(b,!0)});d._on("changedSource",function(b){a.select([0],null,!0,f)});m(b).then(function(){c.onLeftGridReady(a);c.onRightGridReady(d);c.getDocker().resize();m([e.getItem(t,!0),k.getItem(t,!0)]).then(function(b){m(_.invoke([a],
"openFolder",t)).then(function(){m(_.invoke([a,d],"select",[l],null,!0,f)).then(function(){l._selection=l;c.connectGrids(a,d);c.setupBreadcrumb(a,d,l)},function(b){c.onError(b,"selecting items")})},function(b){c.onError(b,"open folder")})},function(b){c.onError(b,"loading items")})},function(b){c.onError(err,"refresh grid")})},setupBreadcrumb:function(a,d,c){function e(b,a,d){k.grid!=d&&k.setSource(d);k.clear();k.setPath(".",f.getRootItem(),a.getPath(),b)}var k=this.breadcrumb;a.getCurrentFolder();
var f=a.collection,b=d.collection;k.setSource(a);this.addHandle("click",a.on("click",function(){k.setSource(a)}));this.addHandle("click",d.on("click",function(){k.setSource(d)}));a._on("openFolder",function(b){e(f,b.item,a)});d._on("openFolder",function(a){e(b,a.item,d)})},destroy:function(){g.destroy(this.leftStore);g.destroy(this.rightStore);g.destroy(this.leftGrid);g.destroy(this.rightGrid);g.destroy(this.breadcrumb);g.destroy(this.docker)},startup:function(){this.createLayout();var a=this.layoutLeft,
d=this.layoutMain,c=this.ctx,u=c.config,k=this.mount||"root",f=this.storeOptions,b=this.storeOptionsMixin||{includeList:"*.jpg,*.png",excludeList:"*"},l=this.leftStore||e.createFileStore(k,f,u,b,c),c=this.rightStore||e.createFileStore(k,f,u,b,c),k=this.layoutMain,u=g.mixin({},g.clone(this.defaultGridArgs)),t=this.removePermissions,k=g.mixin(u,this.leftGridArgs||{newTarget:k});_.remove(k.permissions,function(b){return-1!==_.indexOf(t,b)});this.leftGrid=a=this.leftGrid||this.createFileGrid(l,a,k);l=
g.mixin(u,this.rightGridArgs||{selectedRenderer:v});_.remove(l.permissions,function(b){return-1!==_.indexOf(t,b)});this.rightGrid=d=this.rightGrid||this.createFileGrid(c,d,l);return this.startGrids(a,d)}})})},"xfile/Breadcrumb":function(){define(["dcl/dcl","xide/widgets/TemplatedWidgetBase","xide/model/Path","xide/_base/_Widget"],function(q,h,g,e){return q(e,{templateString:"\x3cul attachTo\x3d'root' style\x3d'-webkit-app-region:drag' class\x3d'breadcrumb'\x3e\x3c/ul\x3e",grid:null,destroy:function(){this.clear();
this.grid=null},setSource:function(a){if(this.grid!=a){this.grid=a;var c=a.collection;this.clear();var e=a.getBreadcrumbPath?a.getBreadcrumbPath():null;!1!==e&&(e?this.setPath(e.root,null,e,null):c&&a.getCurrentFolder&&(a=(a=a.getCurrentFolder())?a.path:"",this.setPath(".",c.getRootItem(),a,c)))}},setPath:function(a,c,e,v,m){this.clear();c&&a&&this.addSegment(a,!0,c);a=(new g(e)).getSegments();var h=m||".";_.each(a,function(a){var d=h+"/"+a;this.addSegment(a,!0,v?v.getSync(d):null);h=d},this)},onClick:function(a,
c,e){this._emit("click",{element:e,event:c,label:a,data:e.data})},addSegment:function(a,c,e){if(e&&this.has(e))return null;var g=this;a=$("\x3cli class\x3d'"+(c?"active":"")+"'\x3e\x3ca href\x3d'#'\x3e"+a+"\x3c/a\x3e\x3c/li\x3e");_.each(this.all(),function(a){a.el.removeClass("active")});$(this.domNode).append(a);e&&(a.on("click",function(a){g.grid&&g.grid.openFolder(e)}),a[0].data=e);return a},pop:function(){this.last().remove()},last:function(){return $(this.root).children().last()},has:function(a){for(var c=
this.all(),e=0;e<c.length;e++)if(c[e].data.path===a.path)return!0;return!1},all:function(){var a=[];_.each(this.$root.children(),function(c){a.push({el:$(c),label:c.outerText,data:c.data})});return a},clear:function(){for(var a=this.all();a.length;){var c=a[a.length-1];c.el.remove();c.data=null;a.remove(c)}},unwind:function(a){var c=this.all().reverse();_.each(c,function(c){c.data&&c.data.path!==(a&&a.path)&&"."!==c.data.path&&this.pop()},this)},startup:function(){this._on("click",function(a){a=a.element[0].data;
var c=this.grid;a&&(this.unwind(a),c&&c.openFolder(a))}.bind(this))}})})},"xfile/Statusbar":function(){define(["xdojo/declare","xide/types","xfile/Breadcrumb"],function(q,h,g){return q("xgrid.Statusbar",null,{statusbar:null,setState:function(e){this.showStatusbar(e.statusBar);return this.inherited(arguments)},getState:function(e){e=this.inherited(arguments)||{};e.statusBar=null!=this.statusbar;return e},runAction:function(e){e.command==h.ACTION.STATUSBAR&&this.showStatusbar(this.statusbar?!1:!0);
return this.inherited(arguments)},showStatusbar:function(e,a){!e&&this.statusbar?this._destroyStatusbar():e&&this.getStatusbar();this.resize();this._statusbarAction&&!0!==a&&this._statusbarAction.set("value",e)},_destroyStatusbar:function(){this.statusbarRoot&&this.statusbarRoot.remove();this.statusbarRoot=this.statusbar=null},_statusbarAction:null,buildRendering:function(){this.inherited(arguments);var e=this;this._on("onAddActions",function(a){var c=a.actions,g=h.ACTION.STATUSBAR;a.store.getSync(g)||
(a=e.createAction({label:"Statusbar",command:g,icon:h.ACTION_ICON.STATUSBAR,tab:"View",group:"Show",mixin:{actionType:"multiToggle"},onCreate:function(a){a.set("value",null!==e.statusbar);e._statusbarAction=a},onChange:function(a,c,g){e.showStatusbar(c,!0)}}),c.push(a))})},getStatusbar:function(){return this.statusbar?this.statusbar:this.createStatusbar()},onRenderedStatusBar:function(e,a,c){e=this.__bc;!e&&a&&a.append&&(e=new g({},$("\x3cdiv\x3e")),a.append(e.domNode),$(e.domNode).css({"float":"right",
padding:0,"margin-right":10,top:0,right:50,position:"absolute"}),this.__bc=e,e.setSource(this));e&&(e.clear(),a=this.collection,c=(c=this.getCurrentFolder())?c.path:"",e.setPath(".",a.getRootItem(),c,a))},onStatusbarCollapse:function(e){},createStatusbar:function(e){e=e=this.footer;var a=this.statusbar,c=this;if(!a){var g=$('\x3cdiv class\x3d"statusbar widget" style\x3d"width:inherit;padding: 0;margin:0;padding-left: 4px;"\x3e\x3c/div\x3e')[0];e.appendChild(g);a=$('\x3cdiv class\x3d"status-bar-text ellipsis" style\x3d"display: inline-block;"\x3e0 items selected\x3c/div\x3e')[0];
g.appendChild(a);var v=$('\x3cdiv class\x3d"status-bar-collapser fa-caret-up" style\x3d"" \x3e\x3c/div\x3e');v.click(function(a){c.onStatusbarCollapse(v)});e=v[0];g.appendChild(e);this.statusbar=a;this.statusbarCollapse=e;this.statusbarRoot=g;this._emit("createStatusbar",{root:g,statusbar:a,collapser:e})}return a},startup:function(){function e(a){if(0==a)return"0 Byte";var c=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,c),2)+" "+["Bytes","KB","MB","GB","TB"][c]}
function a(a){var c=0,g="0 KB";_.each(a,function(a){c+=a.sizeBytes||0});0<c&&(g=e(c));return{bytes:c,sizeStr:g}}this.inherited(arguments);if(this.hasPermission(h.ACTION.STATUSBAR)){var c=this.getStatusbar(),g=this;c&&this._on("selectionChanged",function(e){var m=e.selection||[];e=m.length;m=a(m);e=e+"  "+g.localize("selected")+" ("+m.sizeStr+")";c.innerHTML=e;if(g.onRenderedStatusBar)g.onRenderedStatusBar(c,g.statusbarRoot,e)})}}})})},"xfile/views/UploadMixin":function(){define(["xdojo/declare","xide/utils",
"xide/types","dojo/promise/all"],function(q,h,g,e){return q("xfiles.views.UploadMixin",null,{cssClass:"uploadFilesList droparea dropareaHover",__currentDragOverRow:null,__currentDragOverTimer:null,__currentDragOverTimeRow:null,buildRendering:function(){this.inherited(arguments);$(this.domNode).addClass(this.cssClass)},_createUploadItemTemplate:function(a,c,e){return'\x3cdiv class\x3d"" style\x3d"position: relative;margin: 0.1em;height: auto"\x3e\x3cdiv style\x3d"margin:0;vertical-align: middle;padding: 1px;" class\x3d"progress" role\x3d"progressbar" aria-valuemin\x3d"0" aria-valuemax\x3d"100"\x3e\x3cdiv class\x3d"progress-bar progress-bar-info" style\x3d"width:'+
c+';background-color: rgba(102, 161, 179, 0.35);height:auto;magin:0;"\x3e\x3cspan class\x3d"'+(e.failed?"text-danger":"text-info")+'" style\x3d"left: 0px"\x3e'+a+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},_createUploadItems:function(a){function c(a){var d={sizeBytes:h.humanFileSize(a.size),size:h.humanFileSize(a.size),name:a.name,type:a.type,path:m.path+"/"+a.name+"__uploading__"+Math.random(2),isDir:!1,mount:m.mount,parent:m.path,progress:0,isUpload:!0,modified:a.lastModified/1E3,renderColumn:function(a,
d,c){if("name"===a)return e._createUploadItemTemplate(c.name,c.progress+"%",c);if("sizeBytes"===a&&100>c.progress)return h.humanFileSize(c.loaded)+" of "+h.humanFileSize(c.total)}};g.putSync(d);d=g.getSync(d.path);return a._item=d}var e=this,g=this.collection,m=this.getCurrentFolder();this.__currentDragOverRow&&(m=this.__currentDragOverRow.data);var r=[];_.each(a,function(a){r.push(c(a))});return r},_onAllUploaded:function(a){a=this._toUploadItems(a);var c=this;_.each(a,function(a){var c=a._store?
a:a._item;c&&(c.progress=c.failed?0:100,c.refresh(),setTimeout(function(){c.remove()},1))});setTimeout(function(){c.runAction(g.ACTION.RELOAD).then(function(){})},1)},_onBrowserFilesDropped:function(a,c,e){var g=this.ctx.getFileManager(),m=a.getCurrentFolder();this.__currentDragOverRow&&(m=this.__currentDragOverRow.data);this._createUploadItems(c);return g.upload(c,m.mount,m?m.path:"./tmp",a,e)},_onUploadFailed:function(a){a&&(a.failed=!0,a.done=!0)},_onSomeFileUploaded:function(a){var c=this;a&&
(a.progress=100,a.done=!0,a.renderColumn=null,a.renderRow=null,a.refresh(),setTimeout(function(){c.runAction(g.ACTION.RELOAD).then(function(){});a.remove()},1));return!0},_toUploadItems:function(a){var c=[];_.each(a,function(a){_.each(a,function(a){c.push(a)})});return c},_toUploadStoreItem:function(a){return a.file._item},onBrowserFilesDropped:function(a,c){function g(){var a=0;_.each(r,function(c){c.done&&a++});a==r.length&&m._onAllUploaded(c)}var h=this._onBrowserFilesDropped(this,c,a),m=this,
r=m._toUploadItems(c),n=1==r.length;e(h).then(this._onAllUploaded.bind(this,[c]));_.each(h,function(a){a.then(function(a){!n&&m._onSomeFileUploaded(m._toUploadStoreItem(a))&&g()},function(a){m._onUploadFailed(m._toUploadStoreItem(a));n&&m._onAllUploaded(c);!n&&g()},function(a){var c=a.progress;a=a.item.file._item;var d=Math.round(100*c.loaded/c.total);a&&(a.progress=d,a.loaded=c.loaded,a.total=c.total,a.refresh())})})},onBrowserUrlDropped:function(a,c){if(this.delegate&&this.delegate.onBrowserUrlDropped)this.delegate.onBrowserUrlDropped(this,
c)},dragEnter:function(a){a.preventDefault()},dragLeave:function(a){},dragOver:function(a){a.preventDefault();if(this.row){var c=this;a=this.row(a);var e=this.__currentDragOverRow,g=e?e.data:null;this.__currentDragOverRow&&$(this.__currentDragOverRow.element).removeClass("dgrid-focus");a&&a.element&&a.data&&!0===a.data.directory?(this.__currentDragOverTimer||(c.__currentDragOverTimeRow=a,c.__currentDragOverTimer=setTimeout(function(){var a=c.__currentDragOverTimeRow.data;a&&g&&a==g?(c.__currentDragOverTimeRow=
null,c.__currentDragOverTimer=null,c.openFolder(a)):c.__currentDragOverTimer=null},1550)),this.__currentDragOverRow=a,$(a.element).addClass("dgrid-focus")):this.__currentDragOverRow=null}},drop:function(a){a.preventDefault();var c=a.dataTransfer;if(c)if((c=c.files)&&c.length){if(this.onBrowserFilesDropped)this.onBrowserFilesDropped(this,c)}else try{var e=a.dataTransfer.getData("text/plain");if(e&&e.length)this.delegate.onBrowserUrlDropped(this,e)}catch(g){console.error("dropping url failed "+g)}},
initDND:function(){var a=this,c=this.domNode;c?(c.addEventListener("dragover",function(c){a.dragOver(c)},!1),c.addEventListener("drop",function(c){c.preventDefault();a.drop(c)},!1)):console.error("have not drop destination")},startup:function(){if(!this._started){var a=this.inherited(arguments);this.initDND();return a}}})})},"xfile/FolderSize":function(){define("xdojo/declare xide/types xide/utils xfile/Breadcrumb xide/layout/_TabContainer xfile/views/FileSize".split(" "),function(q,h,g,e,a,c){return q("xfile.FolderSize",
null,{__sizeDisplay:null,__bottomTabContainer:null,__bottomPanel:null,__sizesTab:null,showStats:function(e){var h=this.getBottomTabContainer(),m=this.__sizesTab,r=this.__sizeDisplay,n=this,d=this._getBottom(),p=d&&d.isExpanded();if(1==p&&d)e=!1;else if(!p&&d)return d.expand();if(e){d||(d=this.getBottomPanel(!1,.2));if(d&&r)return d.expand();h||(this.__bottomTabContainer=h=e=g.addWidget(a,{direction:"below"},null,d,!0),d._tabs=e);m||(m=this.__sizesTab=h.createTab("Sizes","fa-bar-chart"));r||(r=this.__sizeDisplay=
m.add(c,{owner:n},null,!1),r.startup(),this._on("openedFolder",function(a){g.destroy(n.__sizeDisplay);m.resize();n.resize();n.__sizeDisplay=null;n.__sizeDisplay=g.addWidget(c,{owner:n},null,m,!1);g.resizeTo(n.__sizeDisplay,m,!0,!0);n.__sizeDisplay.startup()}))}else d&&d.collapse()},_runAction:function(a){var c=this.getAction(a);return c&&c.command==h.ACTION.SIZE_STATS?this.showStats(this.__sizeDisplay?!1:!0):this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._on("onAddActions",
function(a){})}})})},"xfile/views/FileSize":function(){define(["dcl/dcl","xide/_base/_Widget"],function(q,h){return q(h,{_find:function(g,e){var a=_.find(e,{path:g}),c=this;if(a&&a.children&&a.children){var h=c._find(g,a.children);h&&(a=h)}a||_.each(e,function(e){var m=null;e.children&&e.children.length&&(m=c._find(g,e.children))&&(a=m)});return a},select:function(g){(g=this._find(g,this.d3Nodes))&&this.highlight(g)},direction:"left",templateString:'\x3cdiv class\x3d"sizeDisplay tabbable tabs-${!direction}" attachTo\x3d"containerNode" style\x3d"width: inherit;height: 100%;padding: 4px"\x3e\x3cul class\x3d"nav nav-tabs tabs-right" role\x3d"tablist"\x3e\x3cli class\x3d"active"\x3e\x3ca href\x3d"#_tab-content2_${!id}" data-toggle\x3d"tab"\x3eOverall\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca href\x3d"#_tab-content1_${!id}" data-toggle\x3d"tab"\x3eBy Type\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"body tab-content"\x3e\x3cdiv attachTo\x3d"tab2" id\x3d"_tab-content2_${!id}" class\x3d"tab-pane active clearfix"\x3e\x3cdiv class\x3d"chart1" attachTo\x3d"chart1" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3cdiv class\x3d"" style\x3d"" id\x3d"detailInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"widget" id\x3d"explanation" \x3e\x3cspan id\x3d"percentage"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan id\x3d"percentageDetail"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"tab1" id\x3d"_tab-content1_${!id}" class\x3d"tab-pane"\x3e\x3csvg class\x3d"chart2" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3c/svg\x3e\x3cdiv id\x3d"tooltip" class\x3d"hidden"\x3e\x3cspan id\x3d"chart2Per1"\x3eA\x3c/span\x3e \x3cbr\x3e\x3cspan id\x3d"chart2Per2"\x3e100\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
data:null,owner:self,vis:null,d3Nodes:null,colors:{dir:"#5687d1",jpeg:"#9b59b6",jpg:"#9b59b6",png:"#9b59b6",gif:"#9b59b6",psd:"#9b59b6",mp3:"#3498db",wav:"#3498db",wma:"#3498db",wmv:"#2ecc71","3gp":"#2ecc71",mp4:"#2ecc71",plv:"#2ecc71",mpg:"#2ecc71",mpeg:"#2ecc71",mkv:"#2ecc71",rm:"#2ecc71",rmvb:"#2ecc71",mov:"#2ecc71",doc:"#1abc9c",xls:"#1abc9c",ppt:"#1abc9c",docx:"#1abc9c",xlsx:"#1abc9c",pptx:"#1abc9c",pages:"#e74c3c",key:"#e74c3c",numbers:"#e74c3c",pdf:"#7b615c",epub:"#7b615c",c:"#f1c40f",cpp:"#f1c40f",
h:"#f1c40f",html:"#f1c40f",js:"#f1c40f",css:"#f1c40f",pl:"#f1c40f",py:"#f1c40f",php:"#f1c40f",sql:"#f1c40f",csv:"#de783b",odp:"#de783b",gz:"#6ab975",tar:"#6ab975",rar:"#6ab975",zip:"#6ab975","7z":"#6ab975","default":"#34495e"},totalSize:0,result:{},overallSize:0,buildHierarchy:function(g){for(var e={name:"root",children:[]},a=0;a<g.length;a++){var c=g[a][0],h=+g[a][1];if(!isNaN(h))for(var v=c.split("/"),m=e,r=0;r<v.length;r++){var n=m.children,d=v[r],p;if(r+1<v.length){for(var m=!1,q=0;q<n.length;q++)if(n[q].name==
d){p=n[q];m=!0;break}m||(p={name:d,type:"dir",children:[],path:c},n.push(p));m=p}else p=d.split(".").pop(),7>p.length&&(this.result[p]=p in this.result?this.result[p]+h:h),p={name:d,type:p,size:h,path:c},this.overallSize+=h,n.push(p)}}return e},bytesToSize:function(g){var e=["Bytes","KB","MB","GB","TB"];if(0==g)return"n/a";var a=parseInt(Math.floor(Math.log(g)/Math.log(1024)));return 0==a?g+" "+e[a]:(g/Math.pow(1024,a)).toFixed(1)+" "+e[a]},getAncestors:function(g){for(var e=[];g.parent;)e.unshift(g),
g=g.parent;return e},highlight:function(g){if(g){var e=(100*g.value/this.totalSize).toPrecision(3),a=e+"%";.1>e&&(a="\x3c 0.1%");var c=this.bytesToSize(g.value)+"/"+this.bytesToSize(this.totalSize),e=this.colors;d3.select("#percentage").text(a);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility","");var h=this.getAncestors(g);g=h.length;a="";for(c=0;c<g;c++)var v=h[c].type,a="dir"==v?a+('\x3cspan style\x3d"color:'+e[v]+'"\x3e'+h[c].name+"/\x3c/span\x3e"):a+('\x3cspan style\x3d"color:'+
e[v]+'"\x3e'+h[c].name+"\x3c/span\x3e");$("#detailInfo").html(a);d3.selectAll("path").style("opacity",.3);this.vis.selectAll("path").filter(function(a){return 0<=h.indexOf(a)}).style("opacity",1)}else console.error("cant find "+path)},createChart1:function(g,e,a,c,h){function v(a){var c=(100*a.value/r.totalSize).toPrecision(3),g=c+"%";.1>c&&(g="\x3c 0.1%");c=r.bytesToSize(a.value)+"/"+r.bytesToSize(r.totalSize);d3.select("#percentage").text(g);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility",
"");var h=r.getAncestors(a);a=h.length;g="";for(c=0;c<a;c++)var k=h[c].type,g="dir"==k?g+('\x3cspan style\x3d"color:'+m[k]+'"\x3e'+h[c].name+"/\x3c/span\x3e"):g+('\x3cspan style\x3d"color:'+m[k]+'"\x3e'+h[c].name+"\x3c/span\x3e");$("#detailInfo").html(g);d3.selectAll("path").style("opacity",.3);e.selectAll("path").filter(function(a){return 0<=h.indexOf(a)}).style("opacity",1)}e.append("svg:circle").attr("r",h).style("opacity",0);var m=this.colors,r=this;a=d3.layout.partition(h).size([2*Math.PI,h*
h]).value(function(a){return a.size}).nodes(g,h).filter(function(a){return.005<a.dx});c=d3.svg.arc().startAngle(function(a){return a.x}).endAngle(function(a){return a.x+a.dx}).innerRadius(function(a){return Math.sqrt(a.y)}).outerRadius(function(a){return Math.sqrt(a.y+a.dy)});g=e.data([g]).selectAll("path").data(a).enter().append("svg:path").attr("display",function(a){return a.depth?null:"none"}).attr("d",c).attr("fill-rule","evenodd").style("fill",function(a){return m[a.type]?m[a.type]:m["default"]}).style("opacity",
1).on("mouseover",v);d3.select("#container").on("mouseleave",function(a){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1E3).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",v)});d3.select("#explanation").transition().duration(1E3).style("visibility","hidden");$("#detailInfo").html("")});this.totalSize=g.node().__data__.value;return a},render:function(g){var e=$(this.tab2),a=e.height()-50,
e=e.height()-50;400>a&&(a=400);300>e&&(e=300);var c=e,h=d3.select(this.chart1).append("svg:svg").attr("width",a).attr("height",e).append("svg:g").attr("id","container").attr("transform","translate("+e/2+","+e/2+")"),a=this.createChart1(g,h,a,e,c/4,h);g=[];for(var v in this.result)if(c=this.result[v]/this.overallSize,!(.001>c)){var m=this.bytesToSize(this.result[v])+"/"+this.bytesToSize(this.overallSize);g.push({filetype:v,usage:c,detail:m})}this.vis=h;this.d3Nodes=a;a=$(this.tab1).width();400>a&&
(a=400);this.createChart2(g,a,e-100)},createChart2:function(g,e,a){var c=d3.scale.ordinal().rangeRoundBands([0,e],.1),h=d3.scale.linear().range([a,0]),v=d3.svg.axis().scale(c).orient("bottom"),m=d3.svg.axis().scale(h).orient("left"),r=this.colors;e=d3.select(this.tab1.children[0]).attr("width",e+40+30).attr("height",a+20+30).append("g").attr("transform","translate(40,20)");c.domain(g.map(function(a){return a.filetype}));h.domain([0,d3.max(g,function(a){return a.usage})]);e.append("g").attr("class",
"x axis").attr("transform","translate(0,"+a+")").call(v);e.append("g").attr("class","y axis").call(m);e.selectAll(".bar").data(g).enter().append("rect").attr("class","bar").attr("id",function(a){return"bar"+a.filetype}).attr("x",function(a){return c(a.filetype)}).attr("y",function(a){return h(a.usage)}).attr("height",function(c){return a-h(c.usage)}).attr("width",c.rangeBand()).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]}).on("mouseover",function(e){d3.select(this).transition().duration(50).attr("fill",
"#7f8c8d");var d=parseFloat(d3.select(this).attr("x"))+c.rangeBand()/2,g=parseFloat(d3.select(this).attr("y"))/2+a/2,h=parseFloat(100*e.usage).toFixed(2)+"%("+e.filetype+")";d3.select("#tooltip").style("left",d+"px").style("top",g+"px").select("#chart2Per2").text(e.detail);d3.select("#chart2Per1").text(h);d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){d3.select(this).transition().delay(100).duration(250).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]});
d3.select("#tooltip").classed("hidden",!0)})},startup:function(){if(this.owner){var g=this.owner,e=g.getRows(),a=[];_.each(e,function(c){a.push([c.path.replace("./",""),""+c.sizeBytes])});e=this.buildHierarchy(a);this.render(e);var c=this;g._on("selectionChanged",function(a){if("clear"!=a.why){a=(a=a.selection)?a[0]:null;var e=g.row(a),e=e?e.element:null;a&&e&&(a=a.path.replace("./",""),c.d3Nodes&&c.select(a))}})}}})})},"xfile/views/FileGrid":function(){define("xdojo/declare dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/Grid xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18 xide/$".split(" "),
function(q,h,g,e,a,c,u,v,m,r,n,d,p){m=n.DEFAULT_FILE_GRID_PERMISSIONS;var w=q("xfile.views.FileGrid",u,{resizeAfterStartup:!0,formatters:{},menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:e.clone(g.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:g.ITEM_TYPE.FILE,
permissions:m,contextMenuArgs:{limitTo:null,actionFilter:{quick:!0}},setState:function(a){this.inherited(arguments);var f=this,b=f.collection,c=a.store.path;b.getSync(c);var d=f.refresh();d.then(function(){b.getItem(c,!0).then(function(b){f.openFolder(b)})});return d},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=v.createFileStore(a.mount,a.storeOptions,
this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(f){a._columns[f.label]=!this.isColumnHidden(f.id)},this);return a},onSaveLayout:function(a){a=a.data;var f=this.getState();a.widgets.push({widget:this.declaredClass,state:f});return a},formatColumn:function(a,f,b){var c=
this.selectedRenderer?this.selectedRenderer.prototype:this;if(c.formatColumn&&(c=c.formatColumn.apply(arguments))||b.renderColumn&&(c=b.renderColumn.apply(this,arguments)))return c;switch(a){case "fileType":if("folder"==f)return d.localize("kindFolder");if(b.mime){var c="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),t=d.localize(c);return c!==t?t:f}case "name":var t=b&&null!=b.directory&&!0===b.directory,g=!1===b.read&&!1===b.write,h=".."==b.name,c="",c=t?h?"fa fa-level-up itemFolderList":
g?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":g?"fa fa-lock itemFolderList":"itemFolderList fa "+e.getIconClass(b.path),t=!0===b.showPath?b.path:f;return'\x3cspan class\x3d"'+c+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+t+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return e.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(c=b.owner)&&c.user?
c.user.name:"";case "modified":if(""===f)break;t=null==!b.directory;return!t&&d.translations.dateFormat?d.formatDate(f).replace("ms",""):""}return f},getColumns:function(a){function f(f,c,d,e){null!=b._columns[f]&&(e=!b._columns[f]);b.columns.push({renderExpando:"Name"===f,label:f,field:c,sortable:d,formatter:function(d,e){return f in a?a[f].apply(b,[c,d,e]):b.formatColumn(c,d,e)},hidden:e})}a=a||this.formatters;var b=this;this.columns=[];f("Name","name",!0,!1);f("Type","fileType",!0,!0);f("Path",
"path",!0,!0);f("Size","sizeBytes",!0,!1);f("Modified","modified",!0,!1);f("Owner","owner",!0,!0);f("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&this.focus(this.row(a[0]))},setQueryEx:function(a){if(!a||!a.directory)return!1;this._lastPath=a.getPath();var f=this,b=new h,c=f.collection;"."===a.path?(c.resetQueryLog(),f.set("collection",c.getDefaultCollection(a.getPath())),b.resolve()):c.open(a).then(function(d){c.resetQueryLog();f.set("collection",c.getDefaultCollection(a.getPath()));
b.resolve(d)});return b},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var f=this.collection.getSync(a.rPath);f&&(a=f)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(!0===a.isBack&&(f=this.getHistory().getNow()))return this.collection.getSync(f);if(a=a._S.getParent(a))return a}return null},getClass:function(){return w},getHistory:function(){this._history||(this._history=new a);return this._history},
_createBackItem:function(a){return{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:this.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}},startup:function(){if(!this._started){var d=this.inherited(arguments);p(this.domNode).addClass("xfileGrid");this.set("loading",!0);this.permissions&&this.addActions([].concat(c.getDefaultActions(this.permissions,this,this).concat(this.getFileActions(this.permissions))));this._history=new a;var f=this;this.subscribe(g.EVENTS.ON_CLIPBOARD_COPY,
function(b){b.type===f.itemType&&(f.currentCopySelection=b.selection,f.refreshActions())});f._on("noData",function(){if(!(0<f._total)){var b=f._history.getNow();b&&"./."!==b&&f.renderArray([this._createBackItem(b)])}});this.on("dgrid-refresh-complete",function(){var b=f.getRows();b&&1<b.length&&(b=_.find(b,{isBack:!0}))&&(f.removeRow(b),f.refresh(now))});this._on("openFolder",function(b){f.set("title",b.item.name)});f.selectedRenderer&&(d=this.refresh())&&d.then(function(){f.set("loading",!1);f.setRenderer(f.selectedRenderer,
!1)});this._on("onChangeRenderer",this.refresh);this._emit("startup");d.then(this.resize.bind(this));return d}}});w.prototype.Module=w;w.Module=w;w.createDefault=function(a,f,b,c,d,g){e.mixin({collection:g.getDefaultCollection(),_parent:b,Module:w,ctx:a},f||{});f=e.addWidget(w,f,null,b,d,null,null,!0,null);c&&a.getWindowManager().registerView(f,!1);return f};w.DEFAULT_PERMISSIONS=m;return w})},"xfile/factory/Store":function(){define(["xide/types","xide/factory","xide/utils","xfile/data/Store"],function(q,
h,g,e){h.createFileStore=function(a,c,h,v,m,r){c=c||{fields:q.FIELDS.SHOW_ISDIR|q.FIELDS.SHOW_OWNER|q.FIELDS.SHOW_SIZE|q.FIELDS.SHOW_MIME|q.FIELDS.SHOW_PERMISSIONS|q.FIELDS.SHOW_TIME|q.FIELDS.SHOW_MEDIA_INFO};g.mixin(c,v);a=new e(g.mixin({data:[],ctx:m,config:h,url:h.FILE_SERVICE,serviceUrl:h.serviceUrl,serviceClass:h.FILES_STORE_SERVICE_CLASS,mount:a,options:c},r));a._state={initiated:!1,filter:null,filterDef:null};a.reset();a.setData([]);a.init();m&&m.getFileManager().addStore(a);return a};return h})},
"xfile/data/Store":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred xide/mixins/ReloadMixin xide/manager/ServerActionBase dstore/Cache dstore/QueryResults xide/types xide/utils dojo/when xide/data/TreeMemory dstore/Trackable xide/data/ObservableStore xfile/model/File xide/lodash".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d,p,w,k){function f(){return{addDot:!0,recursive:!1,rootSegment:".",Model:w,idProperty:"path",parentField:"parent",mount:"path",options:{fields:1663,includeList:"*",
excludeList:"*"},serviceUrl:null,serviceClass:null,singleton:!0,queryAccessors:!0,autoEmitEvents:!1,mayHaveChildren:function(b){return 0==b.mayHaveChildren?!1:!0===b.directory},_lastFilter:null,_lastFilterDef:null,_lastFilterItem:null,_initiated:{value:!1},id:null,_state:{initiated:!1,filter:null,filterDef:null},isInitiated:function(){return this._state.initiated},setInitiated:function(b){this._state.initiated=b},_extraSortProperties:{name:{ignoreCase:!0}},constructor:function(){this.id=m.createUUID()},
onSorted:function(b,a){if(1==b.length&&"name"===b[0].property){var f=b[0].descending,c=function(a){return a.name},d=k.groupBy(a,function(a){return!0===a.directory},this);a=k.sortBy(d["true"],c);a=a.concat(k.sortBy(d["false"],c));f&&a.reverse()}if(f=k.find(a,{name:".."}))a.remove(f),a.unshift(f);return a=this.onAfterSort(a)},onAfterSort:function(a){var f=this.micromatch;if("undefined"!==typeof mm&&f&&a&&a[0]){var c=a[0].realPath?"realPath":"path",c="name",d=k.pluck(a,c),e=mm(d,f);a=a.filter(function(a){return-1===
e.indexOf(a[c])?null:a});this._onAfterSort&&(a=this._onAfterSort(a))}return a},_createSortQuerier:function(a){var f=this;return function(c){c=c.slice();c.sort("function"==typeof a?a:function(c,d){for(var e=0;e<a.length;e++){var k;if("function"==typeof a[e])k=a[e](c,d);else{var g=a[e].property;f._extraSortProperties[g]&&m.mixin(a[e],f._extraSortProperties[g]);k=a[e].descending;var t=c.get?c.get(g):c[g],g=d.get?d.get(g):d[g],h=!!a[e].ignoreCase;null!=t&&(t=t.valueOf());null!=g&&(g=g.valueOf());h&&(t.toUpperCase&&
(t=t.toUpperCase()),g.toUpperCase&&(g=g.toUpperCase()));k=t===g?0:!!k===(null===t||t>g)?-1:1}if(0!==k)return k}return 0});return f.onSorted(a,c)}},_getItem:function(a,f){var c=this.getSync(a)||this.getSync("./"+a);return c&&(this.isItemLoaded(c)||1==f)?c:"."===a?this.getRootItem():null},getItem:function(a,f,c){if(0==f)return this._getItem(a);if(1==f){f=a.split("/");var d=this,e=[],h=d.getSync(a);h||(h=d.getSync(a.replace("./","")));if(h&&this.isItemLoaded(h))return h;for(var m=new g,p=function(){if(k.find(e,
{loaded:!1}))for(var f=0;f<e.length;f++){if(!e[f].loaded){var l=d.getSync(e[f].path);if(l)if(!0===l.directory&&d.isItemLoaded(l)){e[f].loaded=!0;continue}else if(null==l.directory){m.resolve(l);break}d._loadPath(e[f].path,!1,c).then(function(a){e[f].loaded=!0;p()},function(a){var b=Math.abs(Math.min(0,f-1));a=e[b];a||(b=e.length-1,a=e[b]);d.getItem(a.path);r(d.getItem(e[b].path,!1),function(a){m.resolve(a,e[b].path)})});break}}else m.resolve(d.getItem(a,!1))},h=".",n=0;n<f.length;n++)"."!=f[n]&&(0<
f.length&&(h+="/"),h+=f[n],e.push({path:h,loaded:!1}));p();return m}return"."===a?this.getRootItem():null},getRootItem:function(){return{_EX:!0,path:".",name:".",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},getItemByPath:function(){},getParents:function(){return null},getParent:function(a){if(!a)return null;var f=a,c=null;h.isString(f)&&(f=this.getSync(a));f&&f.parent&&(c=this.getSync(f.parent));return c||this.getRootItem()},isItemLoaded:function(a){return a&&
(!a.directory||this._isLoaded(a))},loadItem:function(a,f){return this._loadItem(a,f)},_parse:function(a){a._S=this;k.isEmpty(a.children)||(k.each(a.children,function(f){f.parent=a.path;this._parse(f)},this),a._EX=!0,a.children=this.addItems(a.children));a.getPath=function(){return this.path}},_loadPath:function(a,f,c){var d=this,e=this._request(a,c);e.then(function(e){var g=d._getItem(a,!0);if(g)return f&&(k.isEmpty(g.children)||d.removeItems(g.children)),g._EX=!0,d.addItems(e,f),g.children=e;if(c&&
c.onError)c.onError("Error Requesting path on server : "+a);else throw Error("cant get item at "+a);}.bind(this),function(a){console.error("error in load")});return e},addSync:function(a,f){(f=f||{}).overwrite=!1;return this.putSync(a,f)},_loadItem:function(a,f){var c=new g,d=this;if(!a)return c.reject("need item"),c;f&&("."===a.path?(d.setInitiated(!1),d.fetchRange().then(function(f){c.resolve({store:d,items:f,item:a})})):this._loadPath(a.path,!0).then(function(f){c.resolve(a)},function(a){console.error("error occured whilst loading items");
c.reject(a)}));return c},_normalize:function(a){return a&&a.items?a.items[0]:[]},_isLoaded:function(a){return a&&!0===a._EX},fetch:function(){},put:function(){},add:function(a){var f=this.getSync(a.path);f||(f=this.addSync(a),f._S=this,f.getPath=function(){return this.path});return f},removeItems:function(a){k.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path)},this)},addItems:function(a){var f=[];k.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path);f.push(this.add(a))},
this);return f},open:function(a){var f=this;if(this._isLoaded(a)){var c=new g;f.resetQueryLog();c.resolve(a.children);return c}a.isLoading=!0;return f._request(a.path).then(function(c){a.isLoading=!1;a._EX=!0;f.addItems(c);return a.children=c})},getDefaultSort:function(){return[{property:"name",descending:!1,ignoreCase:!0}]},filter:function(a){a.parent&&(this._state.path=a.parent);var f=this.getSync(a.parent);f&&(this.isItemLoaded(f)?this._state.filterDef=null:(f.isLoading=!0,this._state.filterDef=
this._loadPath(f.path),this._state.filterDef.then(function(){f.isLoading=!1})));delete this._state.filter;this._state.filter=a;return this.inherited(arguments)},_request:function(a,f){var c=this;return this.runDeferred(null,"ls",{path:a,mount:this.mount,options:this.options,recursive:this.recursive},m.mixin({checkErrors:!1,displayError:!0},f)).then(function(a){a=c._normalize(a);c._parse(a);return a=a.children||a},function(a){f&&!1===f.displayError||logError(a,"error in FileStore : "+this.mount+" :"+
a)})},fetchRangeSync:function(){var a=this.fetchSync(),f=new g;f.resolve(a.length);return new u(a,{totalLength:f})},reset:function(){this._state.filter=null;this._state.filterDef=null;this.resetQueryLog()},resetQueryLog:function(){this.queryLog=[]},fetchRange:function(){var a=this._fetchRange();return new u(a.then(function(a){return a}),{totalLength:a.then(function(a){return a.length})})},initRoot:function(){var a=this;if(!this.isInitiated())return a._request(".").then(function(f){a.isInitiated()||
(k.each(f,a._parse,a),a.setData(f),a.setInitiated(!0),a.emit("loaded"));return a.fetchRangeSync(arguments)}.bind(this));var f=new g;f.resolve();return f},_fetchRange:function(){if(this._state.filter){var a=this._state.filterDef;if(a)return a.then(function(f){this.reset();a&&a.resolve&&a.resolve(f)}.bind(this)),a}var f=this;if(this.isInitiated()){var c=f.fetchRangeSync(arguments),d=new g,e=new g;d.resolve(c);e.resolve(c.length);f.emit("loaded");return new u(d,{totalLength:c.totalLength})}return f._request(".").then(function(a){f.isInitiated()||
(k.each(a,f._parse,f),f.setData(a),f.setInitiated(!0),f.emit("loaded"));return f.fetchRangeSync(arguments)}.bind(this))},getDefaultCollection:function(a){var f=this.getDefaultSort();return a?this.filter({parent:a}).sort(f):this.sort(f)}}}q=q("xfile/data/Store",[n,c,d,p,a.declare,e],f());q.Implementation=f;return q})},"xfile/model/File":function(){define(["xdojo/declare","xide/data/Model","xide/utils","xide/types"],function(q,h,g,e){return q("xfile.model.File",[h],{getFolder:function(){var a=this.getPath();
return this.directory?a:g.pathinfo(a,e.PATH_PARTS.ALL).dirname},getChildren:function(){return this.children},getParent:function(){return(this.getStore()||this._S).getParent(this)},getStore:function(){return this._store||this._S}})})},"xfile/config":function(){define(["dojo/_base/declare","xide/types"],function(q,h){h.config={ROOT_NODE:"xapp",FILE_SERVICE:"",START_PATH:"./",FILES_STORE_SERVICE_CLASS:"XCOM_Directory_Service",IS_MEDIA_PICKER:null,EDITOR_NODE:null,EDITOR_AFTER_NODE:null,ACTION_TOOLBAR:null,
ALLOWED_DISPLAY_MODES:{TREE:1,LIST:1,THUMB:1,IMAGE_GRID:1},LAYOUT_PRESET:null,beanContextName:null};return h})},"xfile/manager/FileManager":function(){define("dcl/dcl dojo/_base/kernel xide/manager/ServerActionBase xide/types xfile/types xide/utils xide/encoding/SHA1 xide/manager/RPCService dojo/Deferred xdojo/has xfile/manager/FileManagerActions require xfile/factory/Store xide/lodash xdojo/has!electron?xfile/manager/Electron".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d,p,w,k){g=[g,n];r("electronx")&&
k&&g.push(k);return q(g,{declaredClass:"xfile.manager.FileManager",getNewName:function(a,b){for(var c=a.name.replace(".meta.json",""),d=!1,e=1,k=null;!d;)k=c+"-"+e+".meta.json",w.find(b,{name:k})?e++:d=!0;return k},_uploadXHR:null,store:null,config:null,filesToUpload:null,serviceUrl:"index.php",serviceClass:"XCOM_Directory_Service",settingsStore:null,stores:[],getStore:function(a,b){var c=w.find(this.stores,{mount:a});return c?c:p.createFileStore(a,null,this.config,null,this.ctx)},addStore:function(a){this.stores.push(a);
a._on("destroy",this.removeStore.bind(this))},removeStore:function(a){this.stores.indexOf(a)&&this.stores.remove(a)},download:function(a){[].push(a.path);var b=decodeURIComponent(this.serviceUrl),b=b.replace("view\x3drpc","view\x3dsmdCall"),b=-1!=b.indexOf("?")?b+"\x26":b+"?",d=this.serviceClass||"XCOM_Directory_Service";a=c.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);b+="service\x3d"+d+".get\x26path\x3d"+a+"\x26callback\x3dasdf";this.config.DOWNLOAD_URL&&(b=""+this.config.DOWNLOAD_URL,
b+="\x26path\x3d"+a+"\x26callback\x3dasdf");var b=b+"\x26raw\x3dhtml\x26attachment\x3d1",e=c.getUrlArgs(location.href);c.mixin(e,{service:d+".get",path:a,callback:"asdf",raw:"html",attachment:"1",send:"1"});delete e.theme;delete e.debug;delete e.width;delete e.attachment;delete e.send;d=h.toJson(JSON.string(e));d=u._hmac(d,this.config.RPC_PARAMS.rpcSignatureToken,1);b+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;b+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+
"\x3d"+d;window.open(b)},getImageUrl:function(a,b,d){b=-1!=location.href.indexOf("noImageCache")||!0===b||!0===a.dirty;var e=decodeURIComponent(this.serviceUrl),e=e.replace("view\x3drpc","view\x3dsmdCall");a=c.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);var k=this.ctx.getFileManager().serviceClass||"XCOM_Directory_Service",e=-1!=e.indexOf("?")?e+"\x26":e+"?",e=e+("service\x3d"+k+".get\x26path\x3d"+a+"\x26callback\x3dasdf");this.config.DOWNLOAD_URL&&(e=""+this.config.DOWNLOAD_URL,
e+="\x26path\x3d"+a+"\x26callback\x3dasdf");var e=e+"\x26raw\x3dhtml\x26attachment\x3d0",e=e+"\x26send\x3d1",g=c.getUrlArgs(location.href);c.mixin(g,{service:k+".get",path:a,callback:"asdf",raw:"html"});c.mixin(g,d);delete g.theme;delete g.debug;delete g.width;a=h.toJson(g);a=u._hmac(a,this.config.RPC_PARAMS.rpcSignatureToken,1);e+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;e+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+a;b&&(e+="\x26time\x3d"+
(new Date).getTime());if(d)for(var m in d)e+="\x26"+m+"\x3d"+d[m];return e},onFileUploadFailed:function(a){var b=e.EVENTS;a.dfd&&a.dfd.reject(a);this.filesToUpload.remove(a);this.publish(b.ON_UPLOAD_FAILED,{item:a},this)},onFileUploaded:function(a){var b=this,c=e.EVENTS;setTimeout(function(){b.publish(c.STATUS,{message:""+a.file.name+" uploaded to "+a.dstDir,messageArgs:{}},b);a.dfd&&a.dfd.resolve(a);b.filesToUpload.remove(a);b.publish(c.ON_UPLOAD_FINISH,{item:a})},500)},getUploadUrl:function(){var a=
""+decodeURIComponent(this.serviceUrl),a=a.replace("view\x3drpc","view\x3dupload"),a=a.replace("../../../../","./"),a=a+"\x26service\x3d"+this.serviceClass;return a+=".put\x26callback\x3dnada"},initXHRUpload:function(a,b,d,k){var g=new XMLHttpRequest;b=""+this.getUploadUrl();b+="\x26mount\x3d"+encodeURIComponent(k);b+="\x26dstDir\x3d"+encodeURIComponent(d);var h=this;d=g.upload;d.addEventListener("progress",function(b){if(b.lengthComputable)b={item:a,progress:b},a.isLoading=!0,a.dfd.progress(b);else h.onFileUploaded(a)}.bind(this),
!1);g.onreadystatechange=function(){if(4==g.readyState){if(g.responseText&&"OK"!=g.responseText){var b=c.getJson(g.responseText);!b&&g.responseText.indexOf("Fata Error")&&(b={result:[g.responseText],code:1});if(b&&b.result&&w.isArray(b.result)&&0<b.result.length){for(var d=null,k=0;k<b.result.length;k++)h.publish(e.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.result[k],h),d=b.result[k];d&&(a.error=d);h.onFileUploadFailed(a);h.submitNext();return}b&&b.error&&(h.publish(e.EVENTS.ERROR,"Error uploading : "+
a.name+" "+b.error.message,h),h.onFileUploadFailed(a))}h.onFileUploaded(a);h.submitNext()}}.bind(this);d.onerror=function(){h.publish(e.EVENTS.ERROR,"Error uploading : "+a.name,h)};g.open("POST",b,!0);return g},hasLoadingItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if("loading"==this.filesToUpload[a].status)return this.filesToUpload[a];return!1},upload:function(a,b,c,d,e){e=[];for(var k=0;k<a.length;k++){var g={file:a[k],dstDir:""+c,mount:""+b,callee:d,view:d,dfd:new m};e.push(g.dfd);
this.filesToUpload.push(g)}this.submitNext();return e},sendFileUsingFormData:function(a,b){var c=new FormData;c.append("userfile_0",b.file);a.send(c)},sendFileMultipart:function(a){a.status="loading";var b=this.initXHRUpload(a,"",a.dstDir,a.mount);this.publish(e.EVENTS.ON_UPLOAD_BEGIN,{item:a,name:a.name},this);window.FormData&&this.sendFileUsingFormData(b,a)},submitNext:function(){var a=this.getNextUploadItem();a&&this.sendFileMultipart(a)},getNextUploadItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if(!this.filesToUpload[a].status)return this.filesToUpload[a];
return!1},onError:function(a){if(a)if(1===a.code){if(a.message&&w.isArray(a.message)){this.publish(e.EVENTS.ERROR,a.message.join("\x3cbr/\x3e"),this);return}}else 0===a.code&&this.publish(e.EVENTS.STATUS,"Ok",this);this.publish(e.EVENTS.ERROR,{error:a},this)},addError:function(a){var b=this;a.addCallback(function(){b.onError()})},downloadItem:function(a,b){return this.callMethod(e.OPERATION.DOWNLOAD,[a],b,!0)},downloadTo:function(a,b,c,d,k){if(k){var g=this,h=function(a){var b=!1;a&&a.error&&1==a.error.code&&
(b=!0);g.publish(e.EVENTS.ON_DOWNLOAD_TO_END,{terminatorItem:k,failed:b},this);d(arguments)};g.publish(e.EVENTS.ON_DOWNLOAD_TO_BEGIN,{dst:k,url:a,items:[k]},this)}return this.callMethod(e.OPERATION.DOWNLOAD_TO,[a,b,c],h,!0)},find:function(a,b,c){try{return this.callMethod(e.OPERATION.FIND,[a,b],c,!0)}catch(d){logError(d,"find")}},getContent:function(a,b,k,g){if(this.getContentE){var h=this.getContentE.apply(this,arguments);if(h)return h}return r("php")?(h=this.serviceObject.base64_encode(c.buildPath(a,
b,!0)),this.callMethod(e.OPERATION.GET_CONTENT,[h,!1,!1],k,!1)):this._getText(d.toUrl(a).replace("main.js","")+"/"+b,{sync:!1,handleAs:"text"}).then(function(a){try{k&&k(a)}catch(b){logError(b,"error running RPC")}})},setContent:function(a,b,c,d){this.publish(e.EVENTS.ON_CHANGED_CONTENT,{mount:a,path:b,content:c});this.publish(e.EVENTS.ON_STATUS_MESSAGE,{text:"Did save file : "+a+"://"+b});if(this.setContentE){var k=this.setContentE.apply(this,arguments);if(k)return k}return this.callMethod(e.OPERATION.SET_CONTENT,
[a,b,c],d,!0)},onMessages:function(a){if((a=c.getJson(a.events))&&w.isArray(a))for(var b=0;b<a.length;b++){var d={path:a[b].relPath};c.mixin(d,a[b]);this.publish(a[b].clientEvent,d,this)}},onErrors:function(a){},init:function(){this.stores=[]},callMethodEx:function(a,b,d,k,g){var h=a||this.serviceClass,m=this;if(!this.serviceObject[h][b]){if(!0===g)this.onError({code:1,message:["Sorry, server doesnt know "+b]});return null}a={};a=c.mixin(a,this.config.RPC_PARAMS.rpcFixedParams);a[this.config.RPC_PARAMS.rpcUserField]=
this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=a;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;this.serviceObject[h][b](d).then(function(a){try{k&&k(a)}catch(c){console.error("bad news : callback for method "+b+" caused a crash in service class "+h)}a&&a.error&&3==a.error.code&&setTimeout(function(){m.onMessages(a.error)},50);if(a&&a.error&&a.error&&0!==a.error.code)m.onError(a.error);
else m.publish(e.EVENTS.STATUS,{message:"Ok!"},this)},function(a){m.onError(a)})},callMethod:function(a,b,d,k){var g=this,h=this.serviceClass;try{if(!this.serviceObject[h][a]){if(!0===k)this.onError({code:1,message:["Sorry, server doesnt know "+a]});return null}h={};h=c.mixin(h,this.config.RPC_PARAMS.rpcFixedParams);h[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=h;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=
this.config.RPC_PARAMS.rpcSignatureToken;var m=this.serviceObject[this.serviceClass][a](b);m.then(function(b){try{d&&d(b)}catch(c){console.error("crashed in "+a),logError(c,"error running RPC")}b&&b.error&&3==b.error.code&&setTimeout(function(){g.onMessages(b.error)},50);if(b&&b.error&&b.error&&1==b.error.code)g.onError(b.error);else!1!==k&&g.publish(e.EVENTS.STATUS,{message:"Ok!"},this)},function(a){g.onError(a)});return m}catch(p){console.error("crash calling method"+p,arguments),g.onError(p),logError(p,
"error ")}},_initService:function(){this.filesToUpload=[];!this.serviceObject&&this.serviceUrl&&(this.serviceObject=new v(decodeURIComponent(this.serviceUrl)),this.serviceObject.config=this.config)}})})},"xfile/manager/FileManagerActions":function(){define(["dcl/dcl","xide/types","xide/utils"],function(q,h,g){return q(null,{declaredClass:"xfile/manager/FileManagerActions",_publishProgress:function(e,a,c,h,v){a={terminatorItem:a,failed:h,items:c||a};g.mixin(a,v);this.publish(e,a,this)},doOperation:function(e,
a,c,g,h,m){var r=this,n=e.substring(0,1).toUpperCase()+e.substring(1),d="on"+n+"End";r._publishProgress("on"+n+"Begin",c,g,!1,h);return this.runDeferred(null,e,a,m).then(function(){r._publishProgress(d,c,g,!1,h)},function(a){r._publishProgress(d,c,g,!0,h)})},deleteItems:function(e,a,c){return this.doOperation(h.OPERATION.DELETE,[e,a,!0],e,e,null,c)},copyItem:function(e,a,c,g){return this.doOperation(h.OPERATION.COPY,[e,a,c,!1],e,e,{dst:a},g)},mkdir:function(e,a,c){return this.doOperation(h.OPERATION.NEW_DIRECTORY,
[e,a],a,null,null,c)},mkfile:function(e,a,c){return this.doOperation(h.OPERATION.NEW_FILE,[e,a],a)},rename:function(e,a,c){return this.doOperation(h.OPERATION.RENAME,[e,a,c],a)},moveItem:function(e,a,c,g,v,m){return this.doOperation(h.OPERATION.MOVE,[e,a,c,g,v],e,null,null,m)},compressItem:function(e,a,c,g){return this.doOperation(h.OPERATION.COMPRESS,[e,a,c],a)},extractItem:function(e,a,c){return this.doOperation(h.OPERATION.EXTRACT,[e,a],a)}})})},"xfile/manager/MountManager":function(){define("dcl/dcl dojo/_base/lang xide/manager/ResourceManager xide/mixins/ReloadMixin xide/mixins/EventedMixin xide/types xide/utils".split(" "),
function(q,h,g,e,a,c,u){return q([g,a.dcl,e.dcl],{declaredClass:"xfile.manager.MountManager",serviceClass:"XApp_Resource_Service",mountData:null,didReload:!1,editMount:function(a){},removeMount:function(a){},getMounts:function(){return this.mountData},_onDialogOk:function(a,c,e){var g=u.toOptions(c),d=this;a=null!=e.name;c={"class":"cmx.types.Resource",enabled:!0};for(var p=0;p<g.length;p++){var q=g[p];null==q.user?c[q.name]=q.value:(c.config||(c.config={}),c.config[q.name]=q.value)}g="";c.label?
g=c.label:c.config.label&&(g=c.config.label);c.name=""+(null!=e.name?e.name:g.toLowerCase());"FILE_PROXY"===c.config.type?(c.path=""+c.path+"",h.mixin(c,c.config)):"REMOTE_FILE_PROXY"===c.config.type&&(c.path=c.name+"://");e=function(){d.ls(function(a){d.onMountDataReady(a)})};a?this.updateResource(c,!1,e):this.createResource(c,!1,e)},registerLocalMount:function(a){},registerFTP:function(a){},registerSFTP:function(a){},registerDropbox:function(a){},registerWebDav:function(){},onMountDataReady:function(a){this.mountData=
a;this.publish(c.EVENTS.ON_MOUNT_DATA_READY,{data:a});var e=this;setTimeout(function(){e.publish(c.EVENTS.ON_MOUNT_DATA_READY,{data:a})},4E3)},check:function(){this.serviceObject||this._initService()},init:function(){this.ctx.getFileManager()&&(this.serviceObject=this.ctx.getFileManager().serviceObject)},createResource:function(a,c,e){return this.callMethodEx(null,"createResource",[a,c],e,!0)},removeResource:function(a,c,e){return this.callMethodEx(null,"removeResource",[a,!0],e,!0)},updateResource:function(a,
c,e){return this.callMethodEx(null,"updateResource",[a,!0],e,!0)},ls:function(a){return this.runDeferred(null,"ls",[]).then(function(c){this.mountData=c;this.onMountDataReady(c);a&&a(c)}.bind(this))}})})},"xfile/manager/BlockManager":function(){define(["dcl/dcl","xide/manager/ManagerBase","xide/mixins/ReloadMixin","xblox/manager/BlockManager"],function(q,h,g,e){return q([h,e,g.dcl],{declaredClass:"xfile/manager/BlockManager",currentItem:null,setScriptFunctions:function(a,c,e){this.inherited(arguments)}})})},
"xfile/views/FileConsole":function(){define("xdojo/declare dcl/dcl xide/types xide/utils xide/mixins/PersistenceMixin xide/layout/_TabContainer xide/views/_Console xide/views/_ConsoleWidget xfile/views/FileSize xide/views/ConsoleView xide/lodash dojo/has!xace?xace/views/Editor".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d){function p(){return h(null,{owner:null,onServerResponse:function(a,c,b){if(a&&c&&a.owner&&a.owner.onServerResponse)return a.owner.onServerResponse(c,b)},runBash:function(a,c,b,d){var e=
this,g=e.ctx.fileManager;c=g.serviceObject.base64_encode(c);g.runDeferred("XShell","run",["sh",c,b]).then(function(b){d&&$(d).find(".consoleRunningCommand").remove();e.onServerResponse(a,b,!1)})},runPHP:function(a,c,b){var d=this,e=d.ctx.fileManager;c=e.serviceObject.base64_encode(c);e.runDeferred("XShell","run",["php",c,b]).then(function(b){d.onServerResponse(a,b,!1)})},runJavascript:function(a,c,b,d){b=(new Function("{"+c+"; }")).call(b,d);return null!=b?(this.onServerResponse(a,b),b):c},onConsoleCommand:function(a,
c){var b=a.console;if("sh"===b.type){var d=this.onServerResponse(b,"\x3cspan class\x3d'consoleRunningCommand fa-spinner fa-spin'\x3e\x3c/span\x3e\x3cpre style\x3d'font-weight: bold'\x3e# "+c+"\x3c/pre\x3e",!0),g=null;if(this.owner&&this.owner.getCurrentFolder){var h=this.owner.getCurrentFolder();h&&(g=e.buildPath(h.mount,h.path,!1))}return this.runBash(b,c,g,d)}if("php"===b.type)return g=null,b.isLinked()&&(g=this.getCurrentPath()),this.runPHP(b,c,g);if("javascript"===b.type)return this.runJavascript(b,
c)},onConsoleEnter:function(a,c){return this.onConsoleCommand(a,c)}})}function w(){var a=h(r.Editor,{didAddMCompleter:!1,multiFileCompleter:null,blockScope:null,driverInstance:null,onACEReady:function(a){},onEditorCreated:function(a,b){this.inherited(arguments);this.onACEReady(a)}});return h(r,{EditorClass:a,onAddEditorActions:h.superCall(function(a){return function(b){a.call(this,b);b=b.actions;n.find(b,{command:"File/Save"});b.remove(n.find(b,{command:"File/Save"}));b.remove(n.find(b,{command:"File/Reload"}))}}),
logTemplate:'\x3cpre style\x3d"font-size:100%;padding: 0px;" class\x3d""\x3e    ${time} - ${result}\x3c/pre\x3e',_parse:function(a,b,c){var d=""+b;0<d.indexOf("{{")||0<d.indexOf("}}")?d=_parser.parse(g.EXPRESSION_PARSER.FILTREX,d,this,{variables:a.getVariablesAsObject(),delimiters:{begin:"{{",end:"}}"}}):(a=a.parseExpression(b,null,null,null,c))&&(d=a);return d},parse:function(a,b){var c=this.driverInstance;return c&&c.blockScope?this._parse(c.blockScope,a,b):a}})}q=q("xfile.views.FileConsole",null,
{isStatusbarOpen:!1,resizeToParent:!0,__bottomTabContainer:null,onCloseStatusPanel:function(a){},onOpenStatusPanel:function(a){if(!a._tabs){var d=this,b=this.__bottomTabContainer||e.addWidget(c,{direction:"below"},null,a,!0);this.__bottomTabContainer=a._tabs=b;var g=w(),h=new (p());h.ctx=d.ctx;h.owner=this;var n=b.createTab("Bash","fa-terminal");n.add(g,{type:"sh",title:"Bash",icon:"fa-terminal",ctx:d.ctx,owner:d,value:"ls -l --color\x3dalways"},null,!0).delegate=h;n._onShown();n=b.createTab("Javascript",
"fa-code").add(g,{type:"javascript",title:"Javascript",ctx:d.ctx,value:"return 2+2;",owner:d},null,!1);n.delegate=h;var n=b.createTab("PHP","fa-terminal").add(g,{type:"php",title:"PHP",ctx:d.ctx,value:"\x3c?php \n\n\x3e",owner:d},null,!1),r=b.createTab("Sizes","fa-bar-chart");this.__fileSize=r.add(m,{owner:this,ctx:d.ctx},null,!1);this._on("openedFolder",function(a){e.destroy(d.__fileSize);r.resize();d.resize();d.__fileSize=null;d.__fileSize=r.add(m,{owner:d,ctx:d.ctx},null,!1);e.resizeTo(d.__fileSize,
r,!0,!0);d.__fileSize.startup()});a.add(b,null,!1)}return this.inherited(arguments)},onStatusbarCollapse:function(a){var c=null;this.isStatusbarOpen?(c=this.getBottomPanel(!1,.2),c.collapse(),this.onCloseStatusPanel(a),a&&a.removeClass("fa-caret-down"),a&&a.addClass("fa-caret-up")):((c=this._getBottom())?c.expand():c=this.getBottomPanel(!1,.2),this.onOpenStatusPanel(c),a&&a.removeClass("fa-caret-up"),a&&a.addClass("fa-caret-down"));this.isStatusbarOpen=!this.isStatusbarOpen;c.resize()}});q.createEditor=
function(a,c,b,g){var h={filePath:"",fileName:""};c={_permissions:[],item:h,value:c,style:"padding:0px;top:0 !important",iconClass:"fa-code",options:e.mixin(g,{filePath:h.path,fileName:h.name}),storeDelegate:{},title:"No Title"};e.mixin(c,g);a=e.addWidget(d,c,b,a,!0,null,null,!1);a.resize();return a};q.createShellViewDelegate=p;return q})},"xfile/data/DriverStore":function(){define("dojo/_base/declare dojo/Deferred xide/data/ObservableStore xide/data/TreeMemory xfile/data/Store xide/manager/ServerActionBase xide/utils".split(" "),
function(q,h,g,e,a,c,u){a=a.Implementation;return q("driverFileStore",[e,g,c.declare],u.mixin(a(),{driver:null,addDot:!1,rootSegment:"/",getRootItem:function(){var a=this._root;return a?a:this._root={_EX:!1,path:"/",name:"/",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},_filter:function(a){return a},_request:function(a){var c=this,e=this;if("."===a||"/"===a){var g=new h,d=e.driver.callCommand("LSProg",{override:{args:["/*"]}});d.then(function(a){a=a.files;
_.each(a,function(a){a.parent="."});a=e._filter(a);a=c._normalize({items:[{mount:"root",path:"/",children:a,name:"/",isDir:!0}]});e._parse(a);a=a.children||a;g.resolve(a)})}else g=new h,d=e.driver.callCommand("LSProg",{override:{args:[a+(e.glob||"/*")]}}),d.then(function(d){d=d.files;_.each(d,function(c){c.parent=a});d=e._filter(d);d=c._normalize({items:[{mount:"root",path:a,children:d,isDir:!0}]});e._parse(d);d=d.children||d;g.resolve(d)});return g}}))})},"xfile/views/FileGridLight":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/GridLight xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),
function(q,h,g,e,a,c,u,v,m,r,n,d,p){r=d.DEFAULT_FILE_GRID_PERMISSIONS;var w=q("xfile.views.FileGrid",v,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:a.clone(e.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:e.ITEM_TYPE.FILE,permissions:r,
contextMenuArgs:{limitTo:null},setState:function(a){this.inherited(arguments);var c=this,b=c.collection,d=a.store.path;b.getSync(d);var e=c.refresh();try{e.then(function(){b.getItem(d,!0).then(function(a){c.openFolder(a)})})}catch(g){console.error("error restoring folder state")}return e},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=m.createFileStore(a.mount,
a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(c){a._columns[c.label]=!this.isColumnHidden(c.id)},this);return a},onSaveLayout:function(a){a=a.data;var c=this.getState();a.widgets.push({widget:this.declaredClass,state:c});return a},formatColumn:function(c,
d,b){var e=this.selectedRenderer?this.selectedRenderer.prototype:this;if(e.formatColumn&&(e=e.formatColumn.apply(arguments))||b.renderColumn&&(e=b.renderColumn.apply(this,arguments)))return e;switch(c){case "fileType":if("folder"==d)return p.localize("kindFolder");if(b.mime){var e="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),g=p.localize(e);return e!==g?g:d}case "name":var g=b&&null!=b.directory&&!0===b.directory,h=!1===b.read&&!1===b.write,m=".."==b.name,e="",e=g?m?"fa fa-level-up itemFolderList":
h?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":h?"fa fa-lock itemFolderList":"itemFolderList fa "+a.getIconClass(b.path),g=!0===b.showPath?b.path:d;return'\x3cspan class\x3d"'+e+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+g+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return a.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(e=b.owner)&&e.user?
e.user.name:"";case "modified":if(""===d)break;g=null==!b.directory;return!g&&p.translations.dateFormat?p.formatDate(d).replace("ms",""):""}return d},getColumns:function(){function a(b,d,e,g){null!=c._columns[b]&&(g=!c._columns[b]);c.columns.push({renderExpando:"Name"===b,label:b,field:d,sortable:e,formatter:function(a,b){return c.formatColumn(d,a,b)},hidden:g})}var c=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,c){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var b=this,d=new g;if(b){var e=this.collection;"."===a.path?(e.resetQueryLog(),b.set("collection",e.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):e.open(a).then(function(c){e.resetQueryLog();
b.set("collection",e.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(c)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var c=this.collection.getSync(a.rPath);c&&(a=c)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(1==a.isBack&&(c=this.getHistory().getNow()))return this.collection.getSync(c);if(a=a._S.getParent(a))return a}return null},getClass:function(){return w},
getHistory:function(){this._history||(this._history=new c);return this._history},renderArray:function(a,c){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);h.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var d=u.getDefaultActions(this.permissions,this,this),d=d.concat(this.getFileActions(this.permissions));this.addActions(d)}this._history=new c;var b=this;this.subscribe(e.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===b.itemType&&(b.currentCopySelection=a.selection,b.refreshActions())});b._on("noData",function(){b.getRows();if(!(0<b._total)){var a=b._history.getNow();a&&"./."!==a&&b.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:b.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=b.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(b.removeRow(a),b.refresh())});this._on("openFolder",
function(a){b.set("title",a.item.name)});b.selectedRenderer&&(a=this.refresh())&&a.then(function(){b.set("loading",!1);b.setRenderer(b.selectedRenderer,!1)});this._on("onChangeRenderer",function(){b.refresh()});setTimeout(function(){b.resize()},500);return a}}});w.prototype.Module=w;w.Module=w;w.createDefault=function(c,d,b,e,g,h){d=a.mixin({collection:h.getDefaultCollection(),_parent:b,Module:w,ctx:c},d||{});d=a.addWidget(w,d,null,b,g,null,null,!0,null);e&&c.getWindowManager().registerView(d,!1);
return d};w.DEFAULT_PERMISSIONS=r;return w})},"xfile/views/GridLight":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Selection xide/mixins/_State xide/widgets/_Widget".split(" "),function(q,h,g,e,a,c,u,v,m,r,n,d,p){g=[g,e,a];q=q.classFactory("multiRenderer",{},g,u.Implementation);h=c.createGridClass("xfile.views.GridLight",{},{SELECTION:{CLASS:n},
KEYBOARD_SELECTION:!0,COLUMN_HIDER:!0,COLUMN_REORDER:!1,CONTEXT_MENU:h.GRID_FEATURES.CONTEXT_MENU,CLIPBOARD:h.GRID_FEATURES.CLIPBOARD,ACTIONS:h.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:v},SPLIT:{CLASS:m},KEYBOARD_NAVIGATION:{CLASS:r},STATE:{CLASS:d},WIDGET:{CLASS:p}},{RENDERER:q},{renderers:g,selectedRenderer:a});h.DEFAULT_RENDERERS=g;h.DEFAULT_MULTI_RENDERER=q;return h})},"xfile/manager/Electron":function(){define(["dcl/dcl","xdojo/has","xide/utils","dojo/Deferred"],function(q,h,g,e){h("electronx");
return q(null,{declaredClass:"xfile.manager.Electron",require:function(){return window.eRequire.apply(null,arguments)},srequire:function(){return this.require("electron").remote.require.apply(null,arguments)},remote:function(){return(0,window.eRequire)("electron").remote},getContentE:function(a,c,h,q){var m=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{};q=new e;this.require("os");this.require("electron");var r=this.require("path"),n=this.require("fs");a=a.replace("/","");if(m[a]){a=
m[a];if(!a)return console.error("cant resolve file "+a+"/"+c),!1;c=c.replace("./","/");c=g.replaceAll("/",r.sep,c);a=r.resolve(a+r.sep+c);if(n.existsSync(a)){c=n.statSync(a).size;r=new Buffer(c);a=n.openSync(a,"r");if(!c)return"";n.readSync(a,r,0,c,0);n.closeSync(a);n=r.toString();q.resolve(n);h&&h(n)}else return!1;return q}console.error("open in os failed: have no VFS config for "+a)},setContentE:function(a,c,h,q){var m=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{},r=new e;
this.require("os");var n=this.require("path"),d=this.require("fs");a=a.replace("/","");if(m[a]){a=m[a];if(!a)return!1;c=c.replace("./","/");c=g.replaceAll("/",n.sep,c);n=n.resolve(a+n.sep+c);if(d.existsSync(n))try{d.writeFileSync(n,h),q&&q(),r.resolve()}catch(p){return console.error("error saving file "+n),!1}else return console.error("path "+n+" doesnt exists, fallback to legacy setContent"),!1;return r}console.error("open in os failed: have no VFS config for "+a)}})})}}});
//# sourceMappingURL=xfile.js.map