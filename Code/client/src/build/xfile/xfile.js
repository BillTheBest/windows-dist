//>>built
require({cache:{"xfile/main":function(){define("xfile/types xfile/component xfile/views/Grid xfile/views/FileGrid xfile/FileActions xfile/Statusbar xfile/ThumbRenderer xfile/Breadcrumb xfile/types xfile/component xfile/config xfile/model/File xfile/manager/FileManager xfile/manager/MountManager xfile/manager/BlockManager xfile/views/FileConsole xfile/data/DriverStore xfile/views/FileGridLight xfile/manager/Electron".split(" "),function(){})},"xfile/types":function(){define(["dojo/_base/lang","xide/types",
"xide/types/Types"],function(q,l){l.registerCustomMimeIconExtension=function(d,a){l.customMimeIcons[d]=a};var g=l.ACTION;l.DEFAULT_FILE_GRID_PERMISSIONS=[g.EDIT,g.COPY,g.CLOSE,g.MOVE,g.RENAME,g.DOWNLOAD,g.RELOAD,g.DELETE,g.NEW_FILE,g.NEW_DIRECTORY,g.CLIPBOARD,g.LAYOUT,g.COLUMNS,g.SELECTION,g.PREVIEW,g.OPEN_IN,g.GO_UP,g.SEARCH,g.OPEN_IN_TAB,g.TOOLBAR,g.STATUSBAR,g.UPLOAD,g.SOURCE,g.SIZE_STATS,g.CONSOLE,g.HEADER,"File/Compress","File/New",g.CONTEXT_MENU];l.FIELDS={SHOW_ISDIR:1602,SHOW_OWNER:1604,SHOW_MIME:1608,
SHOW_SIZE:1616,SHOW_PERMISSIONS:1632,SHOW_TIME:1633,SHOW_FOLDER_SIZE:1634,SHOW_FOLDER_HIDDEN:1635,SHOW_TYPE:1636,SHOW_MEDIA_INFO:1637};l.FILE_PANEL_LAYOUT={TREE:1,LIST:2,THUMB:3,PREVIEW:4,COVER:5,SPLIT_VERTICAL:6,SPLIT_HORIZONTAL:7,IMAGE_GRID:8};l.LAYOUT_PRESET={DUAL:1,SINGLE:2,BROWSER:3,PREVIEW:4,GALLERY:5,EDITOR:6};l.PANEL_OPTIONS={ALLOW_NEW_TABS:!0,ALLOW_MULTI_TAB:!1,ALLOW_INFO_VIEW:!0,ALLOW_LOG_VIEW:!0,ALLOW_CONTEXT_MENU:!0,ALLOW_LAYOUT_SELECTOR:!0,ALLOW_SOURCE_SELECTOR:!0,ALLOW_COLUMN_RESIZE:!0,
ALLOW_COLUMN_REORDER:!0,ALLOW_COLUMN_HIDE:!0,ALLOW_ACTION_TOOLBAR:!0,ALLOW_MAIN_MENU:!0};l.FILE_PANEL_OPTIONS_LEFT={LAYOUT:2,AUTO_OPEN:!0};l.FILE_PANEL_OPTIONS_MAIN={LAYOUT:3,AUTO_OPEN:!0};l.FILE_PANEL_OPTIONS_RIGHT={LAYOUT:3,AUTO_OPEN:!0};l.FILE_GRID_COLUMNS={NAME:"name",SIZE:"size",MODIFIED:"modified"};l.ACTION_TOOLBAR_MODE={SELF:"self"};q.mixin(l.ITEM_TYPE,{FILE:"BTFILE"});q.mixin(l.EVENTS,{STORE_CHANGED:"onStoreChange",BEFORE_STORE_CHANGE:"onBeforeStoreChange",STORE_REFRESHED:"onStoreRefreshed",
ON_FILE_STORE_READY:"onFileStoreReady",ON_DID_OPEN_ITEM:"onDidOpenItem",ON_SHOW_PANEL:"onShowPanel",ITEM_SELECTED:"onItemSelected",ERROR:"fileOperationError",STATUS:"fileOperationStatus",IMAGE_LOADED:"imageLoaded",IMAGE_ERROR:"imageError",RESIZE:"resize",ON_UPLOAD_BEGIN:"onUploadBegin",ON_UPLOAD_PROGRESS:"onUploadProgress",ON_UPLOAD_FINISH:"onUploadFinish",ON_UPLOAD_FAILED:"onUploadFailed",ON_CLIPBOARD_COPY:"onClipboardCopy",ON_CLIPBOARD_PASTE:"onClipboardPaste",ON_CLIPBOARD_CUT:"onClipboardCut",
ON_CONTEXT_MENU_OPEN:"onContextMenuOpen",ON_PLUGIN_LOADED:"onPluginLoaded",ON_PLUGIN_READY:"onPluginReady",ON_MAIN_VIEW_READY:"onMainViewReady",ON_FILE_CONTENT_CHANGED:"onFileContentChanged",ON_PANEL_CLOSED:"onPanelClosed",ON_PANEL_CREATED:"onPanelCreated",ON_COPY_BEGIN:"onCopyBegin",ON_COPY_END:"onCopyEnd",ON_DOWNLOAD_TO_BEGIN:"onDownloadToBegin",ON_DOWNLOAD_TO_END:"onDownloadToEnd",ON_DELETE_BEGIN:"onDeleteBegin",ON_DELETE_END:"onDeleteEnd",ON_MOVE_BEGIN:"onMoveBegin",ON_MOVE_END:"onMoveEnd",ON_COMPRESS_BEGIN:"onCompressBegin",
ON_COMPRESS_END:"onCompressEnd",ON_SOURCE_MENU_OPEN:"onSourceMenuOpen",ON_MOUNT_DATA_READY:"onMountDataReady",ON_XFILE_READY:"onXFileReady",ON_CHANGE_PERSPECTIVE:"onChangePerspective",ON_FILE_PROPERTIES_RENDERED:"onFilePropertiesRendered"});l.SELECTION_MODE={SINGLE:"single",MULTI:"multiple",EXTENDED:"extended"};l.OPERATION={COPY:"copy",MOVE:"move",RENAME:"rename",DELETE:"delete",OPEN:"open",EDIT:"edit",DOWNLOAD:"download",DOWNLOAD_TO:"downloadTo",INFO:"info",COMPRESS:"compress",RELOAD:"reload",PREVIEW:"preview",
INSERT_IMAGE:"insertImage",COPY_PASTE:"copypaste",DND:"dnd",OPTIONS:"options",NEW_FILE:"mkfile",NEW_DIRECTORY:"mkdir",GET_CONTENT:"get",SET_CONTENT:"set",FIND:"find",CUSTOM:"custom",PERMA_LINK:"permaLink",ADD_MOUNT:"ADD_MOUNT",REMOVE_MOUNT:"REMOVE_MOUNT",EDIT_MOUNT:"EDIT_MOUNT",PERSPECTIVE:"PERSPECTIVE",EXTRACT:"extract"};l.OPERATION_INT={NONE:0,EDIT:1,COPY:2,MOVE:3,INFO:4,DOWNLOAD:5,COMPRESS:6,DELETE:7,RENAME:8,DND:9,COPY_PASTE:10,OPEN:11,RELOAD:12,PREVIEW:13,INSERT_IMAGE:15,NEW_FILE:16,NEW_DIRECTORY:17,
UPLOAD:18,READ:19,WRITE:20,PLUGINS:21,CUSTOM:22,FIND:23,PERMA_LINK:24,ADD_MOUNT:25,REMOVE_MOUNT:26,EDIT_MOUNT:27,PERSPECTIVE:28,CLIPBOARD_COPY:29,CLIPBOARD_CUT:30,CLIPBOARD_PASTE:31,EXTRACT:32};return l})},"xfile/component":function(){define(["dcl/dcl","xide/model/Component"],function(q,l){return q(l,{beanType:"BTFILE",getDependencies:function(){return["xfile/types","xfile/manager/FileManager","xfile/manager/MountManager","xfile/factory/Store","xfile/views/FileGrid"]},getLabel:function(){return"xfile"},
getBeanType:function(){return this.beanType}})})},"xfile/views/Grid":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xfile/Statusbar xfile/views/UploadMixin xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Search xgrid/Selection xide/mixins/_State xide/widgets/_Widget xdojo/has!FileConsole?xfile/views/FileConsole xfile/FolderSize xide/noob".split(" "),function(q,l,g,d,a,c,k,w,p,t,r,f,n,v,h,
e,b,m,u){g=[g,d,a];q=q.classFactory("multiRenderer",{},g,k.Implementation);l=c.createGridClass("xfile.views.Grid",{},{SELECTION:{CLASS:v},KEYBOARD_SELECTION:!0,CONTEXT_MENU:l.GRID_FEATURES.CONTEXT_MENU,TOOLBAR:l.GRID_FEATURES.TOOLBAR,CLIPBOARD:l.GRID_FEATURES.CLIPBOARD,ACTIONS:l.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},STATUS_BAR:{CLASS:p},SPLIT:{CLASS:r},KEYBOARD_NAVIGATION:{CLASS:f},SEARCH:{CLASS:n},STATE:{CLASS:h},UPLOAD:{CLASS:t},WIDGET:{CLASS:e},CONSOLE:{CLASS:b?b:u},SIZES:{CLASS:m}},{RENDERER:q},
{renderers:g,selectedRenderer:a});l.DEFAULT_RENDERERS=g;l.DEFAULT_MULTI_RENDERER=q;return l})},"xfile/ThumbRenderer":function(){define(["xdojo/declare","xide/utils","dojo/dom-construct","xgrid/ThumbRenderer"],function(q,l,g,d){return q("xfile.ThumbRenderer",[d],{thumbSize:"400",resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){$(this.domNode.parentNode).removeClass("metro");$(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){$(this.domNode.parentNode).addClass("metro");
$(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_renderUpload:function(a,c,d){c=parseInt(c.replace("%",""));100==c&&(c=90);a='\x3cdiv class\x3d"tile widget uploadItem"\x3e\x3cdiv class\x3d"radial-progress tile widget " data-progress\x3d"'+c+'"\x3e\x3cdiv class\x3d"circle"\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"shadow"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"inset"\x3e\x3cdiv class\x3d"percentage"\x3e\x3cdiv class\x3d"numbers"\x3e\x3cspan\x3e-\x3c/span\x3e';
for(c=0;99>c;c++)a+="\x3cspan\x3e"+c+"%\x3c/span\x3e";return a+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},renderRow:function(a){if(!0===a.isUpload)return $(this._renderUpload(a.name,a.progress+"%",a))[0];if(a.renderRow){var c=a.renderRow.apply(this,[a]);if(c)return c}var c=g.create("div",{className:"tile widget"}),d=!1===a.read&&!1===a.write,w=".."==a.name,p=a&&!!a.directory,t=!1,r="",f="fa fa-folder fa-5x";this._doubleWidthThumbs=!0;var n="icon";p?(f=w?"fa fa-level-up fa-5x itemFolder":
d?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",t=!0):d?(f="fa fa-lock fa-5x itemFolder",t=!0):l.isImage(a.path)?(f=this.getImageUrl(a),a.icon=f?f:this.config.REPO_URL+"/"+a.path,f="imageFile"):(f="fa fa-5x "+l.getIconClass(a.path),t=!0);r=a.name;d='\x3cspan style\x3d"text-shadow: 2px 2px 5px rgba(0,0,0,0.3);font-size: 72px;opacity: 0.7" class\x3d"fa fa-6x '+f+'"\x3e\x3c/span\x3e';l.isImage(a.path)&&(f=this.getImageUrl(a),a.icon=f?f:this.config.REPO_URL+"/"+a.path,f="",n="image",d=
'\x3cdiv style\x3d"" class\x3d"tile-content image"\x3e\x3cimg class\x3d"'+f+'" src\x3d"'+a.icon+'"/\x3e\x3c/div\x3e',t=!0);r='\x3cdiv title\x3d"'+(r+"\n"+a.modified)+'" class\x3d"tile-content '+n+'"\x3e'+d+'\x3c/div\x3e\x3cdiv class\x3d"brand opacity"\x3e\x3cspan class\x3d"thumbText text opacity ellipsis" style\x3d""\x3e'+r+"\x3c/span\x3e\x3c/div\x3e";if(t)return c.innerHTML=r,c;c.innerHTML=p?r:'\x3cimg class\x3d"'+f+'" src\x3d"'+a.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";
return c},renderRow2:function(a){var c=g.create("span",{className:"cell"}),d=!1===a.read&&!1===a.write,w=".."==a.name,p=a&&!!a.directory,t="",r=!1,f="";p?(t=w?"fa fa-level-up fa-5x itemFolder":d?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",r=!0):d?(t="fa fa-lock fa-5x itemFolder",r=!0):l.isImage(a.path)?(d=this.getImageUrl(a),a.icon=d?d:this.config.REPO_URL+"/"+a.path,t="imageFile"):(t="fa fa-5x "+l.getIconClass(a.path),r=!0);f=!0===a.showPath?a.path:a.name;if(r)return c.innerHTML=
'\x3cspan class\x3d"'+t+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name" style\x3d""\x3e'+f+"\x3c/div\x3e",c;c.innerHTML=p?'\x3cspan class\x3d"'+t+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e":'\x3cimg class\x3d"'+t+'" src\x3d"'+a.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";return c},getImageUrl:function(a){var c=this.ctx.getFileManager();if(c&&c){var d=null;this.resizeThumb&&(d={width:this.thumbSize});return c.getImageUrl(a,null,d)}return null}})})},
"xfile/FileActions":function(){define("dcl/dcl xdojo/declare xdojo/has dojo/Deferred xide/utils xide/types xide/factory xide/model/Path xaction/DefaultActions xide/editor/Registry xide/editor/Default dojo/aspect xfile/views/FileOperationDialog xfile/views/FilePreview xide/views/_CIDialog xide/views/_Dialog xide/views/_PanelDialog xfile/views/FilePicker".split(" "),function(q,l,g,d,a,c,k,w,p,t,r,f,n,v,h,e,b,m){function u(){return{includes:["*",".*"],excludes:[],mode:1502}}function y(e,f){var h=f.userData.value||
"./AA/xfile_last/data/su.jpg",u=new d,n=this,r=new b({size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:f.title,onOk:function(){var b=this.picker._selection;b&&b[0]&&(f.set("value",b[0].path),u.resolve(b[0].path),r.value=b[0].path)},onShow:function(b,e){var f=a.addWidget(m,{ctx:n.ctx,owner:n,selection:h||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,mount:n.collection.mount,storeOptionsMixin:{includeList:"*,.*",excludeList:""},
Module:n.Module,permissions:a.clone(n.Module.DEFAULT_PERMISSIONS)},this,e,!0);this.picker=f;this.add(f,null,!1);this.startDfd.resolve();return[this.picker]}});r.show();return u}var x=c.ACTION;f={touch:function(){var b=new d;try{var e=this,f=this.getSelectedItem(),m=this.getCurrentFolder(),u=f?a.pathinfo(f.path,c.PATH_PARTS.ALL).filename:"",n=this.collection,r={inputs:[a.createCI("Name",13,u,{widget:{instant:!0,validator:function(b){return m?null==n.getSync(m.path+"/"+b)&&0<b.length:!0}}})]},k={select:f,
focus:!0,append:!1};(new h({cis:r,title:"Create new File",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto","min-height":"80px"},_onError:function(b,e,a){b=b||this.title;(a=a||this.notificationMessage)&&a.update({message:b+this.failedText+(e?"\x3cbr/\x3e"+e:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(e)},onCancel:function(){b.resolve()},onOk:function(){var a=this.getField("name");if(null==a)b.resolve(k);else{var f=(e.getCurrentFolder()||{path:"."}).path+
"/"+a;e.ctx.getFileManager().mkfile(n.mount,f,{checkErrors:!0,returnProm:!1}).then(function(a){e.runAction(x.RELOAD).then(function(){n.getSync(f)&&b.resolve({select:f,append:!1,focus:!0})})},function(e){b.resolve(k);logError(e,"error creating directory")})}}})).show()}catch(v){logError(v,"error creating dialog")}return b},newTabArgs:null,openInOS:function(b){var e=this.ctx.getResourceManager().getVariable("VFS_CONFIG")||{},f=b.mount.replace("/","");if(e[f]){var m=window.eRequire;m||console.error("have no electron");
var h=m("os"),c=m("electron").shell,m=m("path"),f=e[f],f=a.replaceAll(" ","",f);b=b.path.replace("./","/");b=a.replaceAll("/",m.sep,b);f=m.resolve(f+m.sep+b);f=a.replaceAll(" ","",f);"win32"!==h.platform()?c.openItem(f):c.openItem("file:///"+f)}else console.error("open in os failed: have no VFS config for "+f)},getFileActions:function(b){b=b||this.permissions;var e=[],f=c.ACTION,a=c.ACTION_ICON,m=this,h=m.ctx,u=m.domNode,d=h.getResourceManager();d&&d.getVariable("VFS_CONFIG");m.getActionStore();e.push(m.createAction({label:"Go up",
command:f.GO_UP,icon:a.GO_UP,tab:"Home",group:"Navigation",keycombo:["backspace"],mixin:{quick:!0}}));e.push(m.createAction({label:"Copy",command:f.COPY,icon:"fa-paste",tab:"Home",group:"Organize",keycombo:["f5"],shouldDisable:function(){return null==m.getSelectedItem()}}));e.push(m.createAction({label:"Close",command:f.CLOSE,icon:"fa-close",tab:"View",group:"Organize",keycombo:["ctrl 0"]}));e.push(m.createAction({label:"Move",command:f.MOVE,icon:"fa-long-arrow-right",tab:"Home",group:"Organize",
keycombo:["f6"],shouldDisable:function(){return null==m.getSelectedItem()}}));location.href.indexOf("electron\x3dtrue")||g("electronx");e.push(this.createAction("Open In New Tab","File/OpenInNewTab","fa-share",["alt enter"],"Home","Open","item",null,null,{quick:!0},null,function(){var b=m.getSelectedItem();return b&&b.isDir?!1:!0},b,u,m));if(h&&h.getMountManager&&p.hasAction(b,f.SOURCE)){b.push(f.SOURCE);var n=h.getMountManager().getMounts(),r=0;if(n&&0<n.length){var k=m.collection.mount;e.push(this.createAction({label:"Source",
command:f.SOURCE,icon:"fa-hdd-o",keyCombo:["ctrl f1"],tab:"Home",group:"Navigation",mixin:{data:n,addPermission:!0,quick:!0},onCreate:function(b){b.set("value",k)}}));_.each(n,function(a){var h=a.label;b.push(f.SOURCE+"/"+h);h=m.createAction({label:h,command:f.SOURCE+"/"+h,icon:"fa-hdd-o",keyCombo:["alt f"+r],tab:"Home",group:"Navigation",mixin:{data:n,item:a,closeOnClick:!1,quick:!0},onCreate:function(b){b.set("value",a.name);b._oldIcon=this.icon;b.actionType=c.ACTION_TYPE.SINGLE_TOGGLE}});e.push(h);
r++})}}return e.concat(this.getEditorActions(b))},rename:function(b){var e=new d,f=this,m=b||this.getSelectedItem();b=this.getSelection();var u=this.getCurrentFolder(),n=m?a.pathinfo(m.path,c.PATH_PARTS.ALL).basename:"",r=this.collection,k={select:b,focus:!0,append:!1};b={inputs:[a.createCI("name",c.ECIType.STRING,n,{widget:{instant:!0,title:"New Name",validator:function(b){return null==r.getSync(u.path+"/"+b)&&0<b.length}}})]};(new h({cis:b,title:"Rename",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,
bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){e.resolve(k)},onOk:function(){var b=this.getField("name");if(null==b)e.resolve(k);else{var a=f.getCurrentFolder();f.ctx.getFileManager().rename(m.mount,m.path,b,{checkErrors:!0,returnProm:!1}).then(function(m){f.runAction(x.RELOAD).then(function(){k.select=a.path+"/"+b;e.resolve(k)})},function(b){logError(b,"__error renaming file!");e.resolve(k)})}}})).show();return e},move:function(b){var e=new d,f=this;
b=this.getSelectedItem();var m=this.getSelection(),n=this.getCurrentFolder();b&&a.pathinfo(b.path,c.PATH_PARTS.ALL);var r=this.collection,k={select:m,focus:!0,append:!1};if(!b.directory){var v=b.getParent();v&&(b=v)}b={inputs:[a.createCI("Name",c.ECIType.FILE,b.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==r.getSync(n.path+"/"+b)&&0<b.length}}})]};var g=new h({cis:b,title:f.localize("Move"),ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,onCancel:function(){e.resolve(k)},
onOk:function(){var b=this.getField("name");if(null==b)e.resolve(k);else{var h=f._buildServerSelection(m),c=(b=f.collection.getSync(b))?a.normalizePath(b.mount+"/"+b.path):"";b&&(h.dstPath=c);b=u();f.getCurrentFolder();f.ctx.getFileManager().moveItem(h.selection,h.dstPath,b.includes,b.excludes,b.mode,{checkErrors:!0,returnProm:!1}).then(function(b){f.runAction(x.RELOAD).then(function(){e.resolve(k)})},function(b){logError(b,"__error creating file!");e.resolve(k)})}}});g._on("widget",function(b){b.widget._onSelect=
function(b){return y.apply(f,[g,b])}});g.show();return e},copy:function(b){var e=new d,f=this,m=this.getSelectedItem(),r=this.getSelection(),k=this.getCurrentFolder();m&&a.pathinfo(m.path,c.PATH_PARTS.ALL);var v=this.collection,g={select:r,focus:!0,append:!1};m.directory||(b=m.getParent())&&(m=b);b={inputs:[a.createCI("Name",c.ECIType.FILE,m.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==v.getSync(k.path+"/"+b)&&0<b.length}}})]};var w=new (q([n,h],{}))({cis:b,title:f.localize("Copy"),
ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){e.resolve(g)},onOk:function(){var b=this.getField("name");if(null==b)e.resolve(g);else{this.showMessage();var h=this,c=f._buildServerSelection(r),n=f.collection.getSync(b),d=n?a.normalizePath(n.mount+"/"+n.path):"";c.dstPath=n?d:a.normalizePath(m.mount+"/"+b);f.getCurrentFolder();b=f.ctx.getFileManager().copyItem(c.selection,c.dstPath,u(),{checkErrors:!0,returnProm:!1});
b.then(function(b){h._onSuccess(b)},function(b){h._onError()});b.then(function(b){f.runAction(x.RELOAD).then(function(){e.resolve(g)})},function(b){logError(b,"__error creating file!");e.resolve(g)})}}});w._on("widget",function(b){b.widget._onSelect=function(b){return y.apply(f,[w,b])}});w.show();return e},clipboardPaste:function(){var b=new d,e=this.currentCutSelection,f=e?this.currentCutSelection:this.currentCopySelection,m=this._buildServerSelection(f),e=e?"moveItem":"copyItem",a=this,h={select:f,
focus:!0,append:!1};if(!f)return b.resolve(),b;f=u();a.ctx.getFileManager()[e](m.selection,m.dstPath,{include:f.includes,exclude:f.excludes,mode:f.mode}).then(function(f){a.runAction(c.ACTION.RELOAD).then(function(){b.resolve(h)})},function(f){b.resolve(h)},function(f){b.resolve(h)});return b},mkdir:function(){var b=new d;try{var f=this,e=this.getSelectedItem(),m=this.getCurrentFolder(),u=e?a.pathinfo(e.path,c.PATH_PARTS.ALL).filename:"",n=this.collection,r={inputs:[a.createCI("Name",13,u,{widget:{instant:!0,
validator:function(b){return m?null==n.getSync(m.path+"/"+b)&&0<b.length:!0}}})]},k={select:e,focus:!0,append:!1};(new h({cis:r,title:"Create new Directory",ctx:this.ctx,size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},_onError:function(b,f,e){b=b||this.title;(e=e||this.notificationMessage)&&e.update({message:b+this.failedText+(f?"\x3cbr/\x3e"+f:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(f)},onCancel:function(){b.resolve()},
onOk:function(){var e=this.getField("name");if(null==e)b.resolve(k);else{var m=(f.getCurrentFolder()||{path:"."}).path+"/"+e;f.ctx.getFileManager().mkdir(n.mount,m,{checkErrors:!0,returnProm:!1}).then(function(e){f.runAction(x.RELOAD).then(function(){n.getSync(m)&&b.resolve({select:m,append:!1,focus:!0})})},function(e){b.resolve(k);logError(e,"error creating directory")})}}})).show()}catch(v){logError(v,"error creating dialog")}return b},_buildServerSelection:function(b,e){!e&&(e=this.getCurrentFolder());
e&&!e.directory&&(e=e.getParent());_.isArray(b)||(b=[b]);var f=[],m=b[0].getStore(),h=e?a.normalizePath(e.mount+"/"+e.path):"";_.each(b,function(b){m.getSync(b.path)&&f.push(a.normalizePath(b.mount+"/"+b.path))});return{selection:f,store:b[0]._S,dstPath:"/"+h+"/",firstItem:b[0],parent:e}},openPreview:function(b,e){var f=this.row(b).element,m=this,a=new d;if(this._preview)return this._preview.item=b,this._preview.open().then(function(){m._preview.preview.trigger($.Event("update",{file:b}))});var h=
new v({node:$(f),item:b,delegate:this.ctx.getFileManager(),parent:$(f),ctx:m.ctx,container:e?e.containerNode:null});e?h.buildRenderingEmbedded():h.buildRendering();h.init();h.exec();this._preview=h;this._preview.handler=this;m._on("selectionChanged",function(b){if(b=m.getSelectedItem())h.item=b,h.preview.trigger($.Event("update",{file:b}))});this.add(h,null,!1);h._emit("changeState",function(e){0===e&&a.resolve({select:b,focus:!0,append:!1})});return a},deleteSelection:function(b){b=b||this.getSelection();
var e=new d,f=this.getNext(b[0],null,!0),m=this.getPrevious(b[0],null,!0),a=f||m,h=this._buildServerSelection(b),u=this;(new n({ctx:u.ctx,notificationMessage:null,title:"Delete "+h.selection.length+" items",type:c.DIALOG_TYPE.DANGER,onBeforeOk:function(){},getOkDfd:function(){var b=this;return this.ctx.getFileManager().deleteItems(h.selection,{hints:[1]},{checkErrors:!1,returnProm:!1,onError:function(e){b._onError(null,e.message)}})},onCancel:function(){e.resolve({select:b,focus:!0,append:!1})},onSuccess:function(){u.runAction(c.ACTION.RELOAD).then(function(){e.resolve({select:a,
focus:!0,append:!1})})}})).show();return e},goUp:function(b){b=this._history.getNow();b=_.isString(b)?this.collection.getSync(b):b;var e=new d,f=this,m=this.getHistory().getNow();if(!b){var a=this.getRows();a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&(b=a)}b?(a=b._S.getParent(b))&&(b=this.openFolder(a,!0,!1))&&b.then&&b.then(function(){if(m){var b=f.collection.getSync(m);b&&e.resolve({select:b,focus:!0,delay:1})}}):m?(b=this.collection.getSync(m))&&this.select([b],null,!0,{focus:!0,
delay:1}):(a=this.getRows(),a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&this.openFolder(a,!0));return e},reload:function(b){var e=new d,f=this.getSelection();b=b||this.getRows()[0];var m=this.getCurrentFolder()||{path:"."},a=this;m.isBack&&(m=this.collection.getSync(m.rPath));var h=!1;this.isExpanded&&this.expand&&b&&(h=this._isExpanded(b))&&this.expand(b,null,!1);a.collection.resetQueryLog();this.collection.loadItem(m,!0).then(function(b){"."===m&&a.collection.resetQueryLog();
a.refresh().then(function(){var b=a.openItem(m,!1,!1);b&&b.then&&b.then(function(){e.resolve({select:f,append:!1,focus:!0,delay:1})});a.deselectAll();e.resolve({select:f,append:!1,focus:!0,delay:2})})});return e},toHistory:function(b){b=(b.getFolder?new w(b.getFolder()):new w(".")).getSegments();var e=this.collection.rootSegment,f=e;b&&"."===b[0]&&(b[0]=e);var m=[];_.each(b,function(b){b=b!==f?f+(f.endsWith("/")?"":"/")+b:b;m.push(b);f=b});return m},openFolder:function(b,e,f){var m=this.getCurrentFolder(),
a=this.collection,h=this.getHistory();h.getNow();h.getNow();var c=this;(b=_.isString(b)?a.getSync(b):a.getSync(b.path)||b)||(b=a.getRootItem());var u=c.toHistory(b);h.set(u);if(!b)return this.setQueryEx(a.getRootItem());if(!(m&&b&&e&&m.path===b.path)&&b){this.deselectAll();var m=(m=this.row(b))?m.element:null,n;b._S.isItemLoaded(b)||((m=$(m).find("span.fa"))&&m[0]&&(n=$(m[0])),n&&(n.removeClass("fa fa-folder"),n.addClass("fa-spinner fa-spin")));var r=new d;this._emit("openFolder",{item:b,back:e});
(m=this.setQueryEx(b,null))&&m.then(function(){n&&(n.addClass("fa fa-folder"),n.removeClass("fa-spinner fa-spin"));r.resolve({select:!1!==f?e?b:c.getRows()[0]:null,focus:!0,append:!1,delay:1});c._emit("openedFolder",{item:b,back:e})});return r}},changeSource:function(b,e){var f=new d,m=this,a=m.ctx||a,h=a.getFileManager(),c=k.createFileStore(b.name,null,h.config,null,a),u=this.collection,a=this.getAction(x.SOURCE),h=b.label||b.name,n=this.getAction(x.SOURCE+"/"+h);u.destroy();!0!==e&&this._emit("changeSource",
b);this.set("loading",!0);this.set("collection",c.getDefaultCollection());a.set("value",b.name);m.set("title","Files ("+b.label+")");c=a.getChildren();_.each(c,function(b){b.set("icon",b._oldIcon)});a.set("label",h);n&&n.set("icon","fa-spinner fa-spin");this.refresh().then(function(){m.set("loading",!1);n&&n.set("icon","fa-check");!0!==e&&m._emit("changedSource",b);m.select([0],null,!0,{append:!1,focus:!0}).then(function(){f.resolve()})});return f},openInNewTab:function(b){var e=this.ctx,f=e.getWindowManager(),
m=new d,h=null,h=_.isFunction(this.newTarget)?this.newTarget({title:b.name,icon:"fa-folder",target:this._parent,location:null,tabOrientation:null}):f.createTab(b.name,"fa-folder",this.newTarget||this),c=this.collection;b.isDir||(b=this.getCurrentFolder());var n=k.createFileStore(c.mount,c.options,c.config,null,e),e=a.mixin({showToolbar:this.showToolbar,collection:n,selectedRenderer:this.selectedRenderer,showHeader:this.showHeader,newTarget:this.newTarget,style:this.style,options:a.clone(this.options),
permissions:this.permissions,_columns:this._columns,attachDirect:!0,registerEditors:this.registerEditors},this.newTabArgs||{}),u=a.addWidget(this.getClass(),e,null,h,!1);m.resolve();u.set("loading",!0);n.initRoot().then(function(e){(e=n.getItem(b.path,!0))&&e.then(function(){u.startup();u.refresh().then(function(){u.openItem(b).then(function(){u.focus();u.select([0],null,!0,{focus:!0,append:!1,delay:1});u.set("loading",!1)});f.registerView(u,!0)})})});return m},openItem:function(b,e,f){if(!b){var m=
this.getRows();m[0]&&m[0].isBack&&(b=m[0])}if(b&&b.isBack)return b._S=null,this.goUp();if(b=_.isString(b)?this.collection.getSync(b):b){if(!0===b.directory)return this.openFolder(b,e,f);e=t.getEditors(b);return(e=_.find(e,function(b){return!0===b.isDefault}))?e.onEdit(b,this):this.ctx.getWindowManager().openItem(b,this.newTarget||this,{global:!0})}},getSelectedItem:function(){return this.getSelection()[0]},openDefaultEditor:function(b){return r.Implementation.open(b)},close:function(){var b=this._parent;
if(b){var e=b.docker();e&&(this.onAfterAction=null,e.removePanel(b))}return!1},compress:function(b){b=b||this.getSelection();var e=this;(b=this._buildServerSelection(b))&&b.store&&b.selection&&e.ctx.getFileManager().compressItem(b.firstItem.mount,b.selection,"zip").then(function(b){e.reload()})},runAction:function(b,e){_.isString(b)&&(b=this.getAction(b));if(b&&b.command){var f=c.ACTION,m=this.getSelectedItem()||e,a=this.getSelection();if(-1!=b.command.indexOf(x.SOURCE))return this.changeSource(b.item);
switch(b.command){case "File/Compress":return this.compress(a);case f.PREVIEW:return this.openPreview(m);case "File/OpenInNewTab":return this.openInNewTab(m||this.collection.getRootItem());case f.EDIT:return this.openItem(m);case f.NEW_FILE:return this.touch(m);case f.NEW_DIRECTORY:return this.mkdir(m);case f.RELOAD:return this.reload(m);case f.RENAME:return this.rename(m);case f.GO_UP:return this.goUp(null);case f.COPY:return this.copy(null);case f.MOVE:return this.move(null);case f.DELETE:return this.deleteSelection(null);
case f.OPEN_IN+"/Default Editor":return this.openDefaultEditor(m);case f.DOWNLOAD:return this.ctx.getFileManager().download(m);case f.CLOSE:return this.close();case "File/OpenInOS":return this.openInOS(m)}return-1!=b.command.indexOf(f.OPEN_IN+"/")?b.editor.onEdit(m):this.inherited(arguments)}},getEditorActions:function(b){function e(b){function f(b,e){e.handler=function(){b.onEdit(d.getSelection()[0])}}function m(b){b=t.getEditors(b)||[];for(var e=[],a=0;a<b.length;a++){var h=b[a];if("Default Editor"!==
h.name){var c=d.createAction(h.name,n.OPEN_IN+"/"+h.name,h.iconClass,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",editor:h,custom:!0},null,null,u,r,d);f(h,c);e.push(c)}}return e}var a=b.selection;if(a&&a[0]){var h=a[0],u=this.permissions,n=c.ACTION,d=this,r=d.domNode,k=d.getActionStore(),a=this.getContextMenu();"deselect"!=b.why&&(k.getSync(c.ACTION.OPEN_IN),b=d.addActions(m(h)),this._lastEditorActions&&(_.each(this._lastEditorActions,function(b){k.removeSync(b.command)}),
delete this._lastEditorActions),a&&a.removeCustomActions(),0<b.length&&(b=this.addActions(b),k._emit("onActionsAdded",b),this._lastEditorActions=b))}}b=b||this.permissions;var f=[],m=c.ACTION,a=c.ACTION_ICON,h=this,u=h.domNode;h.getActionStore();var n=null;this._selHandle||(this._selHandle=this._on("selectionChanged",function(b){e.apply(h,[b])}));n=this.createAction("Open In",m.OPEN_IN,a.EDIT,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",onCreate:function(b){}},null,p.shouldDisableDefaultFileOnly,
b,u,h);f.push(n);b=h.createAction("Default Editor",m.OPEN_IN+"/Default Editor","fa-code",null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",forceSubs:!0},null,null,b,u,h);f.push(b);return f}};l=l("xfile.FileActions",null,f);l.Implementation=f;l.createFilePicker=function(e,f,h,u,n,d,r,k){(new b({size:c.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:u,onOk:function(){var b=this.picker._selection;b&&b[0]&&
(h(b[0]),r&&r.resolve(b[0],b,this.picker))},onShow:function(b,h){var u=a.addWidget(m,a.mixin({ctx:e.ctx,owner:e,selection:f||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:k,permissions:n||a.clone(c.DEFAULT_FILE_GRID_PERMISSIONS)},d),this,h,!0);this.picker=u;this.add(u);this.startDfd.resolve();return[this.picker]}})).show();return r};return l})},"xfile/views/FileOperationDialog":function(){define(["dcl/dcl","xide/types","xide/views/_Dialog"],
function(q,l,g){return q(g,{title:"",type:l.DIALOG_TYPE.INFO,size:l.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{},failedText:" Failed!",successText:": Success!",showSpinner:!0,spinner:'  \x3cspan class\x3d"fa-spinner fa-spin"/\x3e',notificationMessage:null,doOk:function(d){this.onBeforeOk&&this.onBeforeOk();this.showMessage();var a=this;d.then(function(c){a._onSuccess(c)},function(c){a._onError()})},_onSuccess:function(d,a,c){d=d||this.title;(c=c||this.notificationMessage)&&c.update({message:d+this.successText+
(a?"\x3cbr/\x3e"+a:""),type:"info",actions:!1,duration:1500});this.onSuccess&&this.onSuccess()},_onError:function(d,a,c){d=d||this.title;(c=c||this.notificationMessage)&&c.update({message:d+this.failedText+(a?"\x3cbr/\x3e"+a:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(a)},onOk:function(){this.showMessage();this.doOk(this.getOkDfd())},showMessage:function(d){if(this.notificationMessage)return this.notificationMessage;d=d||this.title;return this.notificationMessage=d=this.ctx.getNotificationManager().postMessage({message:d+
(this.showSpinner?this.spinner:""),type:"info",showCloseButton:!0,duration:4500})}})})},"xfile/views/FilePreview":function(){define("dcl/dcl xide/types xide/utils xide/mixins/EventedMixin xide/widgets/_Widget dojo/cache dojo/Deferred dijit/registry xide/editor/Default xaction/DefaultActions".split(" "),function(q,l,g,d,a,c,k,w,p,t){var r=[function(f){var a=["image/jpeg","image/png","image/gif"],c=f.preview;$.each(navigator.mimeTypes,function(f,e){var b=e.type;0===b.indexOf("image/")&&$.inArray(b,
a)&&a.push(b)});c.bind("update",function(h){var e=h.file,b;f.opened()&&-1!==$.inArray(e.mime,a)&&(h.stopImmediatePropagation(),h=null,f.resizeToPreview&&(h={width:c.width()}),b=$("\x3cimg/\x3e").hide().appendTo(c).load(function(){setTimeout(function(){var e=(b.width()/b.height()).toFixed(2);c.bind("changesize",function(){var f=parseInt(c.width()),a=parseInt(c.height()),h;e<(f/a).toFixed(2)?(h=a,f=Math.floor(h*e)):h=Math.floor(f/e);b.width(f).height(h).css("margin-top",h<a?Math.floor((a-h)/2):0)}).trigger("changesize");
f.hideinfo();b.fadeIn(100)},1)}),b.attr("src",f.fm.url(e,null,h)))})},function(f){var a=["text/html","application/xhtml+xml"],c=f.preview;c.bind("update",function(h){var e=h.file;f.opened()&&-1!==$.inArray(e.mime,a)&&(h.stopImmediatePropagation(),f.ctx.getFileManager().getContent(e.mount,e.path,function(b){f.hideinfo();doc=$('\x3ciframe class\x3d"elfinder-quicklook-preview-html"/\x3e').appendTo(c)[0].contentWindow.document;doc.open();doc.write(b);doc.close()}))})},function(f){var a=f.preview,c="application/x-empty application/javascript application/xhtml+xml audio/x-mp3-playlist application/x-web-config application/docbook+xml application/x-php application/x-perl application/x-awk application/x-config application/x-csh application/xml application/x-empty text/html text/x-c text/x-php text/plain text/x-c++ text/x-lisp".split(" ");
a.bind("update",function(h){var e=h.file,b=e.mime;if(f.opened()&&(0===b.indexOf("text/")||-1!==$.inArray(b,c))&&(h.stopImmediatePropagation(),f.useAce)){f.hideinfo();h=$('\x3cdiv class\x3d"elfinder-quicklook-preview-text-wrapper"\x3e\x3c/div\x3e');h.appendTo(a);var m=f._editor,b=m;if(!m&&(m=p.Implementation.open(e,h[0],f.editorOptions,!1,f),f._editor=m,f.add(m,null,!1),t.hasAction(f.editorOptions.permissions,l.ACTION.TOOLBAR))){var u=m.getToolbar();u&&$(u.domNode).addClass("bg-opaque")}b&&(h.append(m.domNode),
m.set("item",e));a.bind("changesize",function(){parseInt(a.width());parseInt(a.height());g.resizeTo(m.domNode,a[0],!0,!0);m.resize()})}})},function(f){var a=f.preview,c=!1,c=!1;$.each(navigator.plugins,function(f,e){$.each(e,function(b,e){if("application/pdf"==e.type)return!(c=!0)})});c&&a.bind("update",function(h){var e=h.file,b;f.opened()&&"application/pdf"==e.mime&&(h.stopImmediatePropagation(),a.one("change",function(){b.unbind("load").remove()}),b=$('\x3ciframe class\x3d"elfinder-quicklook-preview-pdf"/\x3e').hide().appendTo(a).load(function(){f.hideinfo();
b.show()}).attr("src",f.fm.url(e)))})},function(f){var a=f.fm,c=f.preview,h=!1;$.each(navigator.plugins,function(e,b){$.each(b,function(b,e){if("application/x-shockwave-flash"==e.type)return!(h=!0)})});h&&c.bind("update",function(e){var b=e.file;f.opened()&&"application/x-shockwave-flash"==b.mime&&(e.stopImmediatePropagation(),f.hideinfo(),c.append($('\x3cembed class\x3d"elfinder-quicklook-preview-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer" src\x3d"'+a.url(b)+'" quality\x3d"high" type\x3d"application/x-shockwave-flash" /\x3e')))})},
function(f){var a=f.preview,c=!!f.options.autoplay,h={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},e;a.bind("update",function(b){if(f.opened()){var m=b.file;f.support.audio[h[m.mime]]&&(b.stopImmediatePropagation(),e=$('\x3caudio class\x3d"elfinder-quicklook-preview-audio" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
f.fm.url(m)+'" /\x3e\x3c/audio\x3e').appendTo(a),c&&e[0].play())}}).bind("change",function(){e&&e.parent().length&&(e[0].pause(),e.remove(),e=null)})},function(f){var a=f.preview,c=!!f.options.autoplay,h={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},e;a.bind("update",function(b){if(f.opened()){var m=b.file;f.support.video[h[m.mime]]&&(b.stopImmediatePropagation(),f.hideinfo(),e=$('\x3cvideo class\x3d"elfinder-quicklook-preview-video" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
f.fm.url(m)+'" /\x3e\x3c/video\x3e').appendTo(a),c&&e[0].play())}}).bind("change",function(){e&&e.parent().length&&(e[0].pause(),e.remove(),e=null)})},function(f){var a=f.preview,c=[],h;f.opened()&&($.each(navigator.plugins,function(e,b){$.each(b,function(b,e){0!==e.type.indexOf("audio/")&&0!==e.type.indexOf("video/")||c.push(e.type)})}),a.bind("update",function(e){if(f.opened()){var b=e.file,m=b.mime;-1!==$.inArray(b.mime,c)&&(e.stopImmediatePropagation(),(e=0===m.indexOf("video/"))&&f.hideinfo(),
h=$('\x3cembed src\x3d"'+f.fm.url(b)+'" type\x3d"'+m+'" class\x3d"elfinder-quicklook-preview-'+(e?"video":"audio")+'"/\x3e').appendTo(a))}}).bind("change",function(){h&&h.parent().length&&(h.remove(),h=null)}))}];d=q([a.dcl,d.dcl],{resizeToPreview:!0,useAce:!0,registerEditors:!1,editorPermissions:[],container:null,destroy:function(){this.window.empty();g.destroy(this.window[0]);this.inherited(arguments)},init:function(){var f=this.options={autoplay:!0,jplayer:"extensions/jplayer",ui:"button"},a=this,
c=this.window,h=this.preview,e=this.container;width=0<f.width?parseInt(f.width):450;height=0<f.height?parseInt(f.height):300;e||c.appendTo("body").zIndex(20);$(document).keydown(function(b){27==b.keyCode&&a.opened()&&c.trigger("close")});!e&&$.fn.resizable&&c.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){h.trigger("changesize")}});$.each(r||[],function(b,e){"function"==typeof e&&new e(a)});h.bind("update",function(){a.info.show()})},buildRenderingEmbedded:function(){var a=this,
c=this.navicon,d=this.container?$(this.container):null;$('\x3cdiv class\x3d"elfinder-quicklook-title" style\x3d"display: none"\x3e'+a.title+"\x3c/div\x3e");var h=$("\x3cdiv/\x3e"),e=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');a.openDfd=new k;a.fsicon=$('\x3cdiv class\x3d"'+c+" "+c+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var e=a.window,h=e.is("."+a.fullscreen),d=$(window);b.stopPropagation();h?(e.css(e.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(a.resize).unbind(a.resize),
a.navbar.unbind("mouseenter").unbind("mousemove")):(e.data("position",{left:e.css("left"),top:e.css("top"),width:e.width(),height:e.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){e.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(a.resize,function(b){a.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(a.resize),e.bind("mousemove",function(b){a.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),
a.navbar.mouseenter(function(){a.navbar.stop(!0,!0).show()}).mousemove(function(b){b.stopPropagation()}));a.navbar.attr("style","").draggable(h?"destroy":{});e.toggleClass(a.fullscreen);$(this).toggleClass(c+"-fullscreen-off");parent||(parent=$(".xapp"))});a.navbar=$('\x3cdiv class\x3d"" style\x3d"display: none;"/\x3e');a.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(b){a.info.attr("style","").hide();h.removeAttr("class").attr("style","");
e.html("")}).bind("update",function(b){var e=b.file;e?(!e.read&&b.stopImmediatePropagation(),a.preview.unbind("changesize").trigger("change").children().remove(),a.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});a.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(h).append(e);a.window=$('\x3cdiv id\x3d"'+a.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d""/\x3e').click(function(b){b.stopPropagation()}).append(a.preview).append(a.info.hide()).bind("open",
function(b){a._open=!0;b=a.window;var e=a.node;a.closed()&&(a.update(1,a.value),a.navbar.attr("style",""),a.state=1,e&&e.trigger("scrolltoview"),b.css(a.closedCss(e)).show().animate(a.openedCss(),550,function(){a.state=2;a.update(2,a.value);a.openDfd.resolve()}))}).bind("close",function(b){var e=a.window,h=a.preview.trigger("change");b={};var c=function(){a._open=!1;a.state=0;e.hide();h.children().remove();a.update(0,a.value)};a.opened()&&(state=1,e.is("."+a.fullscreen)&&a.fsicon.mousedown(),b.length?
e.animate(a.closedCss(b),500,c):c())});d&&(console.error("container!"),d.append(a.window));d=this.supportTest;a.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},buildRendering:function(){var a=this,c=this.navicon,
d=this.container?$(this.container):null,h=$('\x3cdiv class\x3d"elfinder-quicklook-title"\x3e'+a.title+"\x3c/div\x3e"),e=$("\x3cdiv/\x3e"),b=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');a.openDfd=new k;a.fsicon=$('\x3cdiv class\x3d"'+c+" "+c+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var e=a.window,h=e.is("."+a.fullscreen),d=$(window);b.stopPropagation();h?(e.css(e.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(a.resize).unbind(a.resize),a.navbar.unbind("mouseenter").unbind("mousemove")):
(e.data("position",{left:e.css("left"),top:e.css("top"),width:e.width(),height:e.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){e.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(a.resize,function(b){a.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(a.resize),e.bind("mousemove",function(b){a.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),a.navbar.mouseenter(function(){a.navbar.stop(!0,
!0).show()}).mousemove(function(b){b.stopPropagation()}));a.navbar.attr("style","").draggable(h?"destroy":{});e.toggleClass(a.fullscreen);$(this).toggleClass(c+"-fullscreen-off");parent||(parent=$(".xapp"))});a.navbar=$('\x3cdiv class\x3d"elfinder-quicklook-navbar"/\x3e').append($('\x3cdiv class\x3d"'+c+" "+c+' fa-2x fa-arrow-left"/\x3e').mousedown(function(){a.navtrigger(37)})).append(a.fsicon).append($('\x3cdiv class\x3d"'+c+" "+c+' fa-2x fa-arrow-right"/\x3e').mousedown(function(){a.navtrigger(39)})).append('\x3cdiv class\x3d"elfinder-quicklook-navbar-separator"/\x3e').append($('\x3cdiv class\x3d"'+
c+" "+c+'-close"/\x3e').mousedown(function(){a.window.trigger("close")}));a.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(m){a.info.attr("style","").hide();e.removeAttr("class").attr("style","");b.html("")}).bind("update",function(b){var e=b.file;e?(!e.read&&b.stopImmediatePropagation(),a.preview.unbind("changesize").trigger("change").children().remove(),a.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});a.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(e).append(b);
a.window=$('\x3cdiv id\x3d"'+a.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d"position:absolute"/\x3e').click(function(b){b.stopPropagation()}).append($('\x3cdiv class\x3d"elfinder-quicklook-titlebar"/\x3e').append(h).append($('\x3cspan class\x3d"fa-close" style\x3d"margin-left: 4px; color: white; font-size: 16px; text-align: center; position: absolute; left: 0px; top: 2px;"/\x3e').mousedown(function(b){b.stopPropagation();a.window.trigger("close")}))).append(a.preview.add(a.navbar)).append(a.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",
function(b){a._open=!0;b=a.window;var e=a.node;a.closed()&&(a.update(1,a.value),a.navbar.attr("style",""),a.state=1,e.trigger("scrolltoview"),b.css(a.closedCss(e)).show().animate(a.openedCss(),550,function(){a.state=2;a.update(2,a.value);a.openDfd.resolve()}))}).bind("close",function(b){var e=a.window,h=a.preview.trigger("change");b={};var c=function(){a._open=!1;a.state=0;e.hide();h.children().remove();a.update(0,a.value)};a.opened()&&(state=1,e.is("."+a.fullscreen)&&a.fsicon.mousedown(),b.length?
e.animate(a.closedCss(b),500,c):c())});d&&(console.error("container!"),d.append(a.window));d=this.supportTest;a.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},constructor:function(a){g.mixin(this,a)},editorOptions:{permissions:[l.ACTION.TOOLBAR,
l.ACTION.RELOAD,"Editor/Settings","View/Increase Font Size","View/Decrease Font Size","View/Themes","File/Search"]},title:"Preview",width:450,height:300,fm:null,state:0,navicon:"elfinder-quicklook-navbar-icon",fullscreen:"elfinder-quicklook-fullscreen",parent:null,cwd:null,resize:"resize.elfinder-finder",alwaysEnabled:!0,value:null,handlers:{select:function(){this.update(void 0,this.fm.selectedFiles()[0])},error:function(){self.window.is(":visible")&&self.window.data("hash","").trigger("close")},
"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}},shortcuts:[{pattern:"space"}],navtrigger:function(a){$(document).trigger($.Event("keydown",{keyCode:a,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1}))},closedCss:function(a){return{opacity:0,width:20,height:20,top:a?a.offset().top+"px":0,left:a?a.offset().left+"px":0}},openedCss:function(){var a=this.container?$(this.container):null,c=a||$(window),d=a?"100%":Math.min(this.width,c.width()-10),a=a?"100%":Math.min(this.height,
c.height()-80);return{opacity:1,width:d,height:a,top:parseInt((c.height()-a-60)/2+c.scrollTop()),left:parseInt((c.width()-d)/2+c.scrollLeft())}},supportTest:function(a){var c=document.createElement(a.substr(0,a.indexOf("/"))),d=!1;try{d=c.canPlayType&&c.canPlayType(a)}catch(h){}return d&&""!==d&&"no"!=d},changeView:function(a){this.currentView&&(g.destroy(this.currentView),this.currentView.destroy&&this.currentView.destroy())},update:function(a){this._open=a;this._emit("changeState",a);if(1==a&&this.onAnimate)this.onAnimate();
if(2==a&&this.onOpened)this.onOpened();if(0==a&&this.onClosed)this.onClosed()},closed:function(){return 0==this.state},opened:function(){return 2==this.state},bind:function(a,c){var d;if("function"==typeof c)for(a=(""+a).toLowerCase().split(/\s+/),d=0;d<a.length;d++)void 0===listeners[a[d]]&&(listeners[a[d]]=[]),listeners[a[d]].push(c);return this},one:function(a,c){var d=this,h=$.proxy(c,function(a){setTimeout(function(){d.unbind(a.type,h)},3);return c.apply(this,arguments)});return this.bind(a,
h)},open:function(a){var c=this;a=c.window;var d=c.node;c._open=!0;c.openDfd=new k;c.closed()?(c.navbar.attr("style",""),c._open=!0,c.state=1,d&&d.trigger("scrolltoview"),a.css(c.closedCss(d)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(1,c.value);c.openDfd.resolve()})):c.openDfd.resolve();return c.openDfd},close:function(a){this._open=!1;var c=this,d=c.window,h=c.preview.trigger("change");a=c.node;var e=function(){c.state=0;d.hide();h.children().remove();c.update(0,c.value);c.closeDfd&&
c.closeDfd.resolve()};c.opened()&&(c.state=1,d.is("."+c.fullscreen)&&c.fsicon.mousedown(),a&&a.length?d.animate(c.closedCss(a),500,e):e());return c.closeDfd},getstate:function(){return 2==this.state?1:0},exec:function(){this.window.trigger(this.opened()?"close":"open")},hideinfo:function(){this.info.stop(!0).hide()}});d=q(d,{destroy:function(){this.close();this.preview.trigger($.Event("update",{file:null}));this.inherited(arguments);g.destroy(this._editor);g.destroy(this.preview);g.destroy(this.window)},
onOpened:function(){var a=this;a.fm={url:function(c,d,h){return a.delegate.getImageUrl(c,d,h)}};a.preview.trigger($.Event("update",{file:a.item}))},onClosed:function(){},onAnimate:function(){}});q=q(d,{resize:function(){this.preview.trigger("changesize")},constructor:function(a){this.parent=$(a._parent.containerNode);this.container=a._parent.containerNode;this.resizeToParent=!0;this.delegate=a.ctx.getFileManager();this.item=a.item},openItem:function(a){this.id=g.createUUID();w.add(this);this.item=
a||this.item;this.buildRenderingEmbedded();this.init();this.exec();this.window.css({height:"100%",width:"100%"});this._parent.add(this,null,!1);this.preview.trigger($.Event("update",{file:this.item}));this._parent.resize();this.resize()}});d.EditorClass=q;return d})},"xfile/views/FilePicker":function(){define("dcl/dcl xide/types xide/utils xide/factory module xide/_base/_Widget xdocker/Docker2 xfile/ThumbRenderer dojo/promise/all xfile/Breadcrumb".split(" "),function(q,l,g,d,a,c,k,w,p,t){return q(c,
{declaredClass:"xfile.views.FilePicker",templateString:'\x3cdiv class\x3d"FilePicker"\x3e\x3c/div\x3e',resizeToParent:!0,docker:null,dockerOptions:{resizeToParent:!0},breadcrumb:null,leftStore:null,rightStore:null,storeOptionsMixin:null,storeOptions:null,leftGrid:null,leftGridArgs:null,rightGrid:null,rightGridArgs:null,removePermissions:[l.ACTION.OPEN_IN_TAB],defaultGridArgs:{registerEditors:!1,_columns:{Name:!0,Path:!1,Size:!1,Modified:!1}},selection:null,mount:"root",_selection:null,getDocker:function(){if(this.docker)return this.docker;
var a=this.dockerOptions||{resizeToParent:!0},a=this.docker||k.createDefault(this.domNode,a);a.resizeToParent=!0;this.add(a,null,!1);return this.docker=a},createLayout:function(){var a=this.getDocker();this.layoutTop=a.addPanel("DefaultFixed",l.DOCKER.DOCK.TOP,null,{h:50,title:!1});this.layoutTop._minSize.y=50;this.layoutTop._maxSize.y=50;this.layoutTop._scrollable={x:!1,y:!1};this.breadcrumb=g.addWidget(t,{},null,this.layoutTop,!0);this.layoutLeft=a.addPanel("DefaultFixed",l.DOCKER.DOCK.BOTTOM,null,
{w:100,title:!1});this.layoutLeft._minSize.x=150;this.layoutLeft.moveable(!0);this.layoutMain=a.addPanel("DefaultFixed",l.DOCKER.DOCK.RIGHT,this.layoutLeft,{w:"70%",title:!1});this.layoutTop.initSize(100,"100%");this.layoutLeft.initSize("100%",150);a.resize()},setSelection:function(a){this._selection=a},connectGrids:function(a,c){var d=this;c._on("selectionChanged",function(a){"deselect"!==a.why&&(a=c.getSelection(),c.getSelectedItem()&&d.setSelection(a))});a._on("selectionChanged",function(k){k=
a.getSelection();var h=a.getSelectedItem();h||(h=a.getCurrentFolder());if(h){var e=null;h.directory?e=h:(h.getParent||console.error("item has no item.getParent!"),e=h.getParent?h.getParent():null);e&&c.openFolder(e.path,!1);h&&d.setSelection(k)}})},createFileGrid:function(a,c,d){return this.Module.createDefault(this.ctx,d,c,!1,!0,a)},onLeftGridReady:function(a){},onRightGridReady:function(a){},onError:function(a,c){},startGrids:function(a,c){var d=this,k=a.collection,h=c.collection,e={focus:!0,append:!1},
b=[a.refresh(),c.refresh()],m=this.selection,u=g.pathinfo(m,l.PATH_PARTS.ALL).dirname||"";"."===u&&(u=m);a.showStatusbar&&a.showStatusbar(!1);a._on("changeSource",function(b){c.changeSource(b,!0)});a._on("changedSource",function(b){a.select([0],null,!0,e)});c._on("changeSource",function(b){a.changeSource(b,!0)});c._on("changedSource",function(b){a.select([0],null,!0,e)});p(b).then(function(){d.onLeftGridReady(a);d.onRightGridReady(c);d.getDocker().resize();p([k.getItem(u,!0),h.getItem(u,!0)]).then(function(b){p(_.invoke([a],
"openFolder",u)).then(function(){p(_.invoke([a,c],"select",[m],null,!0,e)).then(function(){m._selection=m;d.connectGrids(a,c);d.setupBreadcrumb(a,c,m)},function(b){d.onError(b,"selecting items")})},function(b){d.onError(b,"open folder")})},function(b){d.onError(b,"loading items")})},function(b){d.onError(err,"refresh grid")})},setupBreadcrumb:function(a,c,d){function k(b,a,c){h.grid!=c&&h.setSource(c);h.clear();h.setPath(".",e.getRootItem(),a.getPath(),b)}var h=this.breadcrumb;a.getCurrentFolder();
var e=a.collection,b=c.collection;h.setSource(a);this.addHandle("click",a.on("click",function(){h.setSource(a)}));this.addHandle("click",c.on("click",function(){h.setSource(c)}));a._on("openFolder",function(b){k(e,b.item,a)});c._on("openFolder",function(a){k(b,a.item,c)})},destroy:function(){g.destroy(this.leftStore);g.destroy(this.rightStore);g.destroy(this.leftGrid);g.destroy(this.rightGrid);g.destroy(this.breadcrumb);g.destroy(this.docker)},startup:function(){this.createLayout();var a=this.layoutLeft,
c=this.layoutMain,k=this.ctx,p=k.config,h=this.mount||"root",e=this.storeOptions,b=this.storeOptionsMixin||{includeList:"*.jpg,*.png",excludeList:"*"},m=this.leftStore||d.createFileStore(h,e,p,b,k),k=this.rightStore||d.createFileStore(h,e,p,b,k),h=this.layoutMain,p=g.mixin({},g.clone(this.defaultGridArgs)),u=this.removePermissions,h=g.mixin(p,this.leftGridArgs||{newTarget:h});_.remove(h.permissions,function(b){return-1!==_.indexOf(u,b)});this.leftGrid=a=this.leftGrid||this.createFileGrid(m,a,h);m=
g.mixin(p,this.rightGridArgs||{selectedRenderer:w});_.remove(m.permissions,function(b){return-1!==_.indexOf(u,b)});this.rightGrid=c=this.rightGrid||this.createFileGrid(k,c,m);return this.startGrids(a,c)}})})},"xfile/Breadcrumb":function(){define(["dcl/dcl","xide/widgets/TemplatedWidgetBase","xide/model/Path","xide/_base/_Widget"],function(q,l,g,d){return q(d,{templateString:"\x3cul attachTo\x3d'root' style\x3d'-webkit-app-region:drag' class\x3d'breadcrumb'\x3e\x3c/ul\x3e",grid:null,destroy:function(){this.clear();
this.grid=null},setSource:function(a){if(this.grid!=a){this.grid=a;var c=a.collection;this.clear();var d=a.getBreadcrumbPath?a.getBreadcrumbPath():null;!1!==d&&(d?this.setPath(d.root,null,d,null):c&&a.getCurrentFolder&&(a=(a=a.getCurrentFolder())?a.path:"",this.setPath(".",c.getRootItem(),a,c)))}},setPath:function(a,c,d,w,p){this.clear();c&&a&&this.addSegment(a,!0,c);a=(new g(d)).getSegments();var l=p||".";_.each(a,function(a){var c=l+"/"+a;this.addSegment(a,!0,w?w.getSync(c):null);l=c},this)},onClick:function(a,
c,d){this._emit("click",{element:d,event:c,label:a,data:d.data})},addSegment:function(a,c,d){if(d&&this.has(d))return null;var g=this;a=$("\x3cli class\x3d'"+(c?"active":"")+"'\x3e\x3ca href\x3d'#'\x3e"+a+"\x3c/a\x3e\x3c/li\x3e");_.each(this.all(),function(a){a.el.removeClass("active")});$(this.domNode).append(a);d&&(a.on("click",function(a){g.grid&&g.grid.openFolder(d)}),a[0].data=d);return a},pop:function(){this.last().remove()},last:function(){return $(this.root).children().last()},has:function(a){for(var c=
this.all(),d=0;d<c.length;d++)if(c[d].data.path===a.path)return!0;return!1},all:function(){var a=[];_.each(this.$root.children(),function(c){a.push({el:$(c),label:c.outerText,data:c.data})});return a},clear:function(){for(var a=this.all();a.length;){var c=a[a.length-1];c.el.remove();c.data=null;a.remove(c)}},unwind:function(a){var c=this.all().reverse();_.each(c,function(c){c.data&&c.data.path!==(a&&a.path)&&"."!==c.data.path&&this.pop()},this)},startup:function(){this._on("click",function(a){a=a.element[0].data;
var c=this.grid;a&&(this.unwind(a),c&&c.openFolder(a))}.bind(this))}})})},"xfile/Statusbar":function(){define(["xdojo/declare","xide/types","xfile/Breadcrumb"],function(q,l,g){return q("xgrid.Statusbar",null,{statusbar:null,setState:function(d){this.showStatusbar(d.statusBar);return this.inherited(arguments)},getState:function(d){d=this.inherited(arguments)||{};d.statusBar=null!=this.statusbar;return d},runAction:function(d){d.command==l.ACTION.STATUSBAR&&this.showStatusbar(this.statusbar?!1:!0);
return this.inherited(arguments)},showStatusbar:function(d,a){!d&&this.statusbar?this._destroyStatusbar():d&&this.getStatusbar();this.resize();this._statusbarAction&&!0!==a&&this._statusbarAction.set("value",d)},_destroyStatusbar:function(){this.statusbarRoot&&this.statusbarRoot.remove();this.statusbarRoot=this.statusbar=null},_statusbarAction:null,buildRendering:function(){this.inherited(arguments);var d=this;this._on("onAddActions",function(a){var c=a.actions,k=l.ACTION.STATUSBAR;a.store.getSync(k)||
(a=d.createAction({label:"Statusbar",command:k,icon:l.ACTION_ICON.STATUSBAR,tab:"View",group:"Show",mixin:{actionType:"multiToggle"},onCreate:function(a){a.set("value",null!==d.statusbar);d._statusbarAction=a},onChange:function(a,c,k){d.showStatusbar(c,!0)}}),c.push(a))})},getStatusbar:function(){return this.statusbar?this.statusbar:this.createStatusbar()},onRenderedStatusBar:function(d,a,c){d=this.__bc;!d&&a&&a.append&&(d=new g({},$("\x3cdiv\x3e")),a.append(d.domNode),$(d.domNode).css({"float":"right",
padding:0,"margin-right":10,top:0,right:50,position:"absolute"}),this.__bc=d,d.setSource(this));d&&(d.clear(),a=this.collection,c=(c=this.getCurrentFolder())?c.path:"",d.setPath(".",a.getRootItem(),c,a))},onStatusbarCollapse:function(d){},createStatusbar:function(d){d=d=this.footer;var a=this.statusbar,c=this;if(!a){var k=$('\x3cdiv class\x3d"statusbar widget" style\x3d"width:inherit;padding: 0;margin:0;padding-left: 4px;"\x3e\x3c/div\x3e')[0];d.appendChild(k);a=$('\x3cdiv class\x3d"status-bar-text ellipsis" style\x3d"display: inline-block;"\x3e0 items selected\x3c/div\x3e')[0];
k.appendChild(a);var g=$('\x3cdiv class\x3d"status-bar-collapser fa-caret-up" style\x3d"" \x3e\x3c/div\x3e');g.click(function(a){c.onStatusbarCollapse(g)});d=g[0];k.appendChild(d);this.statusbar=a;this.statusbarCollapse=d;this.statusbarRoot=k;this._emit("createStatusbar",{root:k,statusbar:a,collapser:d})}return a},startup:function(){function d(a){if(0==a)return"0 Byte";var c=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,c),2)+" "+["Bytes","KB","MB","GB","TB"][c]}
function a(a){var c=0,k="0 KB";_.each(a,function(a){c+=a.sizeBytes||0});0<c&&(k=d(c));return{bytes:c,sizeStr:k}}this.inherited(arguments);if(this.hasPermission(l.ACTION.STATUSBAR)){var c=this.getStatusbar(),k=this;c&&this._on("selectionChanged",function(d){var g=d.selection||[];d=g.length;g=a(g);d=d+"  "+k.localize("selected")+" ("+g.sizeStr+")";c.innerHTML=d;if(k.onRenderedStatusBar)k.onRenderedStatusBar(c,k.statusbarRoot,d)})}}})})},"xfile/views/UploadMixin":function(){define(["xdojo/declare","xide/utils",
"xide/types","dojo/promise/all"],function(q,l,g,d){return q("xfiles.views.UploadMixin",null,{cssClass:"uploadFilesList droparea dropareaHover",__currentDragOverRow:null,__currentDragOverTimer:null,__currentDragOverTimeRow:null,buildRendering:function(){this.inherited(arguments);$(this.domNode).addClass(this.cssClass)},_createUploadItemTemplate:function(a,c,d){return'\x3cdiv class\x3d"" style\x3d"position: relative;margin: 0.1em;height: auto"\x3e\x3cdiv style\x3d"margin:0;vertical-align: middle;padding: 1px;" class\x3d"progress" role\x3d"progressbar" aria-valuemin\x3d"0" aria-valuemax\x3d"100"\x3e\x3cdiv class\x3d"progress-bar progress-bar-info" style\x3d"width:'+
c+';background-color: rgba(102, 161, 179, 0.35);height:auto;magin:0;"\x3e\x3cspan class\x3d"'+(d.failed?"text-danger":"text-info")+'" style\x3d"left: 0px"\x3e'+a+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},_createUploadItems:function(a){function c(a){var c={sizeBytes:l.humanFileSize(a.size),size:l.humanFileSize(a.size),name:a.name,type:a.type,path:p.path+"/"+a.name+"__uploading__"+Math.random(2),isDir:!1,mount:p.mount,parent:p.path,progress:0,isUpload:!0,modified:a.lastModified/1E3,renderColumn:function(a,
c,h){if("name"===a)return d._createUploadItemTemplate(h.name,h.progress+"%",h);if("sizeBytes"===a&&100>h.progress)return l.humanFileSize(h.loaded)+" of "+l.humanFileSize(h.total)}};g.putSync(c);c=g.getSync(c.path);return a._item=c}var d=this,g=this.collection,p=this.getCurrentFolder();this.__currentDragOverRow&&(p=this.__currentDragOverRow.data);var t=[];_.each(a,function(a){t.push(c(a))});return t},_onAllUploaded:function(a){a=this._toUploadItems(a);var c=this;_.each(a,function(a){var c=a._store?
a:a._item;c&&(c.progress=c.failed?0:100,c.refresh(),setTimeout(function(){c.remove()},1))});setTimeout(function(){c.runAction(g.ACTION.RELOAD).then(function(){})},1)},_onBrowserFilesDropped:function(a,c,d){var g=this.ctx.getFileManager(),p=a.getCurrentFolder();this.__currentDragOverRow&&(p=this.__currentDragOverRow.data);this._createUploadItems(c);return g.upload(c,p.mount,p?p.path:"./tmp",a,d)},_onUploadFailed:function(a){a&&(a.failed=!0,a.done=!0)},_onSomeFileUploaded:function(a){var c=this;a&&
(a.progress=100,a.done=!0,a.renderColumn=null,a.renderRow=null,a.refresh(),setTimeout(function(){c.runAction(g.ACTION.RELOAD).then(function(){});a.remove()},1));return!0},_toUploadItems:function(a){var c=[];_.each(a,function(a){_.each(a,function(a){c.push(a)})});return c},_toUploadStoreItem:function(a){return a.file._item},onBrowserFilesDropped:function(a,c){function g(){var a=0;_.each(t,function(c){c.done&&a++});a==t.length&&p._onAllUploaded(c)}var l=this._onBrowserFilesDropped(this,c,a),p=this,
t=p._toUploadItems(c),r=1==t.length;d(l).then(this._onAllUploaded.bind(this,[c]));_.each(l,function(a){a.then(function(a){!r&&p._onSomeFileUploaded(p._toUploadStoreItem(a))&&g()},function(a){p._onUploadFailed(p._toUploadStoreItem(a));r&&p._onAllUploaded(c);!r&&g()},function(a){var c=a.progress;a=a.item.file._item;var h=Math.round(100*c.loaded/c.total);a&&(a.progress=h,a.loaded=c.loaded,a.total=c.total,a.refresh())})})},onBrowserUrlDropped:function(a,c){if(this.delegate&&this.delegate.onBrowserUrlDropped)this.delegate.onBrowserUrlDropped(this,
c)},dragEnter:function(a){a.preventDefault()},dragLeave:function(a){},dragOver:function(a){a.preventDefault();if(this.row){var c=this;a=this.row(a);var d=this.__currentDragOverRow,g=d?d.data:null;this.__currentDragOverRow&&$(this.__currentDragOverRow.element).removeClass("dgrid-focus");a&&a.element&&a.data&&!0===a.data.directory?(this.__currentDragOverTimer||(c.__currentDragOverTimeRow=a,c.__currentDragOverTimer=setTimeout(function(){var a=c.__currentDragOverTimeRow.data;a&&g&&a==g?(c.__currentDragOverTimeRow=
null,c.__currentDragOverTimer=null,c.openFolder(a)):c.__currentDragOverTimer=null},1550)),this.__currentDragOverRow=a,$(a.element).addClass("dgrid-focus")):this.__currentDragOverRow=null}},drop:function(a){a.preventDefault();var c=a.dataTransfer;if(c)if((c=c.files)&&c.length){if(this.onBrowserFilesDropped)this.onBrowserFilesDropped(this,c)}else try{var d=a.dataTransfer.getData("text/plain");if(d&&d.length)this.delegate.onBrowserUrlDropped(this,d)}catch(g){console.error("dropping url failed "+g)}},
initDND:function(){var a=this,c=this.domNode;c?(c.addEventListener("dragover",function(c){a.dragOver(c)},!1),c.addEventListener("drop",function(c){c.preventDefault();a.drop(c)},!1)):console.error("have not drop destination")},startup:function(){if(!this._started){var a=this.inherited(arguments);this.initDND();return a}}})})},"xfile/FolderSize":function(){define("xdojo/declare xide/types xide/utils xfile/Breadcrumb xide/layout/_TabContainer xfile/views/FileSize".split(" "),function(q,l,g,d,a,c){return q("xfile.FolderSize",
null,{__sizeDisplay:null,__bottomTabContainer:null,__bottomPanel:null,__sizesTab:null,showStats:function(d){var l=this.getBottomTabContainer(),p=this.__sizesTab,t=this.__sizeDisplay,r=this,f=this._getBottom(),n=f&&f.isExpanded();if(1==n&&f)d=!1;else if(!n&&f)return f.expand();if(d){f||(f=this.getBottomPanel(!1,.2));if(f&&t)return f.expand();l||(this.__bottomTabContainer=l=d=g.addWidget(a,{direction:"below"},null,f,!0),f._tabs=d);p||(p=this.__sizesTab=l.createTab("Sizes","fa-bar-chart"));t||(t=this.__sizeDisplay=
p.add(c,{owner:r},null,!1),t.startup(),this._on("openedFolder",function(a){g.destroy(r.__sizeDisplay);p.resize();r.resize();r.__sizeDisplay=null;r.__sizeDisplay=g.addWidget(c,{owner:r},null,p,!1);g.resizeTo(r.__sizeDisplay,p,!0,!0);r.__sizeDisplay.startup()}))}else f&&f.collapse()},_runAction:function(a){var c=this.getAction(a);return c&&c.command==l.ACTION.SIZE_STATS?this.showStats(this.__sizeDisplay?!1:!0):this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._on("onAddActions",
function(a){})}})})},"xfile/views/FileSize":function(){define(["dcl/dcl","xide/_base/_Widget"],function(q,l){return q(l,{_find:function(g,d){var a=_.find(d,{path:g}),c=this;if(a&&a.children&&a.children){var k=c._find(g,a.children);k&&(a=k)}a||_.each(d,function(d){var k=null;d.children&&d.children.length&&(k=c._find(g,d.children))&&(a=k)});return a},select:function(g){(g=this._find(g,this.d3Nodes))&&this.highlight(g)},direction:"left",templateString:'\x3cdiv class\x3d"sizeDisplay tabbable tabs-${!direction}" attachTo\x3d"containerNode" style\x3d"width: inherit;height: 100%;padding: 4px"\x3e\x3cul class\x3d"nav nav-tabs tabs-right" role\x3d"tablist"\x3e\x3cli class\x3d"active"\x3e\x3ca href\x3d"#_tab-content2_${!id}" data-toggle\x3d"tab"\x3eOverall\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca href\x3d"#_tab-content1_${!id}" data-toggle\x3d"tab"\x3eBy Type\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"body tab-content"\x3e\x3cdiv attachTo\x3d"tab2" id\x3d"_tab-content2_${!id}" class\x3d"tab-pane active clearfix"\x3e\x3cdiv class\x3d"chart1" attachTo\x3d"chart1" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3cdiv class\x3d"" style\x3d"" id\x3d"detailInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"widget" id\x3d"explanation" \x3e\x3cspan id\x3d"percentage"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan id\x3d"percentageDetail"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"tab1" id\x3d"_tab-content1_${!id}" class\x3d"tab-pane"\x3e\x3csvg class\x3d"chart2" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3c/svg\x3e\x3cdiv id\x3d"tooltip" class\x3d"hidden"\x3e\x3cspan id\x3d"chart2Per1"\x3eA\x3c/span\x3e \x3cbr\x3e\x3cspan id\x3d"chart2Per2"\x3e100\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
data:null,owner:self,vis:null,d3Nodes:null,colors:{dir:"#5687d1",jpeg:"#9b59b6",jpg:"#9b59b6",png:"#9b59b6",gif:"#9b59b6",psd:"#9b59b6",mp3:"#3498db",wav:"#3498db",wma:"#3498db",wmv:"#2ecc71","3gp":"#2ecc71",mp4:"#2ecc71",plv:"#2ecc71",mpg:"#2ecc71",mpeg:"#2ecc71",mkv:"#2ecc71",rm:"#2ecc71",rmvb:"#2ecc71",mov:"#2ecc71",doc:"#1abc9c",xls:"#1abc9c",ppt:"#1abc9c",docx:"#1abc9c",xlsx:"#1abc9c",pptx:"#1abc9c",pages:"#e74c3c",key:"#e74c3c",numbers:"#e74c3c",pdf:"#7b615c",epub:"#7b615c",c:"#f1c40f",cpp:"#f1c40f",
h:"#f1c40f",html:"#f1c40f",js:"#f1c40f",css:"#f1c40f",pl:"#f1c40f",py:"#f1c40f",php:"#f1c40f",sql:"#f1c40f",csv:"#de783b",odp:"#de783b",gz:"#6ab975",tar:"#6ab975",rar:"#6ab975",zip:"#6ab975","7z":"#6ab975","default":"#34495e"},totalSize:0,result:{},overallSize:0,buildHierarchy:function(g){for(var d={name:"root",children:[]},a=0;a<g.length;a++){var c=g[a][0],k=+g[a][1];if(!isNaN(k))for(var l=c.split("/"),p=d,t=0;t<l.length;t++){var r=p.children,f=l[t],n;if(t+1<l.length){for(var p=!1,q=0;q<r.length;q++)if(r[q].name==
f){n=r[q];p=!0;break}p||(n={name:f,type:"dir",children:[],path:c},r.push(n));p=n}else n=f.split(".").pop(),7>n.length&&(this.result[n]=n in this.result?this.result[n]+k:k),n={name:f,type:n,size:k,path:c},this.overallSize+=k,r.push(n)}}return d},bytesToSize:function(g){var d=["Bytes","KB","MB","GB","TB"];if(0==g)return"n/a";var a=parseInt(Math.floor(Math.log(g)/Math.log(1024)));return 0==a?g+" "+d[a]:(g/Math.pow(1024,a)).toFixed(1)+" "+d[a]},getAncestors:function(g){for(var d=[];g.parent;)d.unshift(g),
g=g.parent;return d},highlight:function(g){if(g){var d=(100*g.value/this.totalSize).toPrecision(3),a=d+"%";.1>d&&(a="\x3c 0.1%");var c=this.bytesToSize(g.value)+"/"+this.bytesToSize(this.totalSize),d=this.colors;d3.select("#percentage").text(a);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility","");var k=this.getAncestors(g);g=k.length;a="";for(c=0;c<g;c++)var l=k[c].type,a="dir"==l?a+('\x3cspan style\x3d"color:'+d[l]+'"\x3e'+k[c].name+"/\x3c/span\x3e"):a+('\x3cspan style\x3d"color:'+
d[l]+'"\x3e'+k[c].name+"\x3c/span\x3e");$("#detailInfo").html(a);d3.selectAll("path").style("opacity",.3);this.vis.selectAll("path").filter(function(a){return 0<=k.indexOf(a)}).style("opacity",1)}else console.error("cant find "+path)},createChart1:function(g,d,a,c,k){function l(a){var c=(100*a.value/t.totalSize).toPrecision(3),g=c+"%";.1>c&&(g="\x3c 0.1%");c=t.bytesToSize(a.value)+"/"+t.bytesToSize(t.totalSize);d3.select("#percentage").text(g);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility",
"");var k=t.getAncestors(a);a=k.length;g="";for(c=0;c<a;c++)var h=k[c].type,g="dir"==h?g+('\x3cspan style\x3d"color:'+p[h]+'"\x3e'+k[c].name+"/\x3c/span\x3e"):g+('\x3cspan style\x3d"color:'+p[h]+'"\x3e'+k[c].name+"\x3c/span\x3e");$("#detailInfo").html(g);d3.selectAll("path").style("opacity",.3);d.selectAll("path").filter(function(a){return 0<=k.indexOf(a)}).style("opacity",1)}d.append("svg:circle").attr("r",k).style("opacity",0);var p=this.colors,t=this;a=d3.layout.partition(k).size([2*Math.PI,k*
k]).value(function(a){return a.size}).nodes(g,k).filter(function(a){return.005<a.dx});c=d3.svg.arc().startAngle(function(a){return a.x}).endAngle(function(a){return a.x+a.dx}).innerRadius(function(a){return Math.sqrt(a.y)}).outerRadius(function(a){return Math.sqrt(a.y+a.dy)});g=d.data([g]).selectAll("path").data(a).enter().append("svg:path").attr("display",function(a){return a.depth?null:"none"}).attr("d",c).attr("fill-rule","evenodd").style("fill",function(a){return p[a.type]?p[a.type]:p["default"]}).style("opacity",
1).on("mouseover",l);d3.select("#container").on("mouseleave",function(a){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1E3).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",l)});d3.select("#explanation").transition().duration(1E3).style("visibility","hidden");$("#detailInfo").html("")});this.totalSize=g.node().__data__.value;return a},render:function(g){var d=$(this.tab2),a=d.height()-50,
d=d.height()-50;400>a&&(a=400);300>d&&(d=300);var c=d,k=d3.select(this.chart1).append("svg:svg").attr("width",a).attr("height",d).append("svg:g").attr("id","container").attr("transform","translate("+d/2+","+d/2+")"),a=this.createChart1(g,k,a,d,c/4,k);g=[];for(var l in this.result)if(c=this.result[l]/this.overallSize,!(.001>c)){var p=this.bytesToSize(this.result[l])+"/"+this.bytesToSize(this.overallSize);g.push({filetype:l,usage:c,detail:p})}this.vis=k;this.d3Nodes=a;a=$(this.tab1).width();400>a&&
(a=400);this.createChart2(g,a,d-100)},createChart2:function(g,d,a){var c=d3.scale.ordinal().rangeRoundBands([0,d],.1),k=d3.scale.linear().range([a,0]),l=d3.svg.axis().scale(c).orient("bottom"),p=d3.svg.axis().scale(k).orient("left"),t=this.colors;d=d3.select(this.tab1.children[0]).attr("width",d+40+30).attr("height",a+20+30).append("g").attr("transform","translate(40,20)");c.domain(g.map(function(a){return a.filetype}));k.domain([0,d3.max(g,function(a){return a.usage})]);d.append("g").attr("class",
"x axis").attr("transform","translate(0,"+a+")").call(l);d.append("g").attr("class","y axis").call(p);d.selectAll(".bar").data(g).enter().append("rect").attr("class","bar").attr("id",function(a){return"bar"+a.filetype}).attr("x",function(a){return c(a.filetype)}).attr("y",function(a){return k(a.usage)}).attr("height",function(c){return a-k(c.usage)}).attr("width",c.rangeBand()).attr("fill",function(a){return t[a.filetype]?t[a.filetype]:t["default"]}).on("mouseover",function(d){d3.select(this).transition().duration(50).attr("fill",
"#7f8c8d");var f=parseFloat(d3.select(this).attr("x"))+c.rangeBand()/2,g=parseFloat(d3.select(this).attr("y"))/2+a/2,k=parseFloat(100*d.usage).toFixed(2)+"%("+d.filetype+")";d3.select("#tooltip").style("left",f+"px").style("top",g+"px").select("#chart2Per2").text(d.detail);d3.select("#chart2Per1").text(k);d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){d3.select(this).transition().delay(100).duration(250).attr("fill",function(a){return t[a.filetype]?t[a.filetype]:t["default"]});
d3.select("#tooltip").classed("hidden",!0)})},startup:function(){if(this.owner){var g=this.owner,d=g.getRows(),a=[];_.each(d,function(c){a.push([c.path.replace("./",""),""+c.sizeBytes])});d=this.buildHierarchy(a);this.render(d);var c=this;g._on("selectionChanged",function(a){if("clear"!=a.why){a=(a=a.selection)?a[0]:null;var d=g.row(a),d=d?d.element:null;a&&d&&(a=a.path.replace("./",""),c.d3Nodes&&c.select(a))}})}}})})},"xfile/views/FileGrid":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/Grid xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),
function(q,l,g,d,a,c,k,w,p,t,r,f,n){t=f.DEFAULT_FILE_GRID_PERMISSIONS;var v=q("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:a.clone(d.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:d.ITEM_TYPE.FILE,permissions:t,
contextMenuArgs:{limitTo:null,actionFilter:{quick:!0}},setState:function(a){this.inherited(arguments);var e=this,b=e.collection,c=a.store.path;b.getSync(c);var d=e.refresh();try{d.then(function(){b.getItem(c,!0).then(function(a){e.openFolder(a)})})}catch(f){console.error("error restoring folder state")}return d},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,
this.collection=p.createFileStore(a.mount,a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(e){a._columns[e.label]=!this.isColumnHidden(e.id)},this);return a},onSaveLayout:function(a){a=a.data;var e=this.getState();a.widgets.push({widget:this.declaredClass,
state:e});return a},formatColumn:function(c,e,b){var m=this.selectedRenderer?this.selectedRenderer.prototype:this;if(m.formatColumn&&(m=m.formatColumn.apply(arguments))||b.renderColumn&&(m=b.renderColumn.apply(this,arguments)))return m;switch(c){case "fileType":if("folder"==e)return n.localize("kindFolder");if(b.mime){var m="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),d=n.localize(m);return m!==d?d:e}case "name":var d=b&&null!=b.directory&&!0===b.directory,f=!1===b.read&&!1===b.write,g=
".."==b.name,m="",m=d?g?"fa fa-level-up itemFolderList":f?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":f?"fa fa-lock itemFolderList":"itemFolderList fa "+a.getIconClass(b.path),d=!0===b.showPath?b.path:e;return'\x3cspan class\x3d"'+m+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+d+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return a.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||
"unknown";case "owner":return b&&(m=b.owner)&&m.user?m.user.name:"";case "modified":if(""===e)break;d=null==!b.directory;return!d&&n.translations.dateFormat?n.formatDate(e).replace("ms",""):""}return e},getColumns:function(){function a(b,c,d,h){null!=e._columns[b]&&(h=!e._columns[b]);e.columns.push({renderExpando:"Name"===b,label:b,field:c,sortable:d,formatter:function(a,b){return e.formatColumn(c,a,b)},hidden:h})}var e=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path",
"path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified","modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,e){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var b=this,c=new g;if(b){var d=this.collection;"."===a.path?(d.resetQueryLog(),b.set("collection",d.getDefaultCollection(a.getPath())),c.resolve&&
c.resolve()):d.open(a).then(function(e){d.resetQueryLog();b.set("collection",d.getDefaultCollection(a.getPath()));c.resolve&&c.resolve(e)});return c}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var e=this.collection.getSync(a.rPath);e&&(a=e)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(!0===a.isBack&&(e=this.getHistory().getNow()))return this.collection.getSync(e);if(a=
a._S.getParent(a))return a}return null},getClass:function(){return v},getHistory:function(){this._history||(this._history=new c);return this._history},renderArray:function(a,e){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);l.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var e=k.getDefaultActions(this.permissions,this,this),e=e.concat(this.getFileActions(this.permissions));this.addActions(e)}this._history=
new c;var b=this;this.subscribe(d.EVENTS.ON_CLIPBOARD_COPY,function(a){a.type===b.itemType&&(b.currentCopySelection=a.selection,b.refreshActions())});b._on("noData",function(){b.getRows();if(!(0<b._total)){var a=b._history.getNow();a&&"./."!==a&&b.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:b.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=b.getRows();a&&1<a.length&&
(a=_.find(a,{isBack:!0}))&&(b.removeRow(a),b.refresh())});this._on("openFolder",function(a){b.set("title",a.item.name)});b.selectedRenderer&&(a=this.refresh())&&a.then(function(){b.set("loading",!1);b.setRenderer(b.selectedRenderer,!1)});this._on("onChangeRenderer",function(){b.refresh()});setTimeout(function(){b.resize()},500);this._emit("startup");return a}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(c,e,b,d,f,g){e=a.mixin({collection:g.getDefaultCollection(),_parent:b,Module:v,
ctx:c},e||{});e=a.addWidget(v,e,null,b,f,null,null,!0,null);d&&c.getWindowManager().registerView(e,!1);return e};v.DEFAULT_PERMISSIONS=t;return v})},"xfile/factory/Store":function(){define(["xide/types","xide/factory","xide/utils","xfile/data/Store"],function(q,l,g,d){l.createFileStore=function(a,c,k,l,p){c=c||{fields:q.FIELDS.SHOW_ISDIR|q.FIELDS.SHOW_OWNER|q.FIELDS.SHOW_SIZE|q.FIELDS.SHOW_MIME|q.FIELDS.SHOW_PERMISSIONS|q.FIELDS.SHOW_TIME|q.FIELDS.SHOW_MEDIA_INFO};g.mixin(c,l);a=new d({data:[],ctx:p,
config:k,url:k.FILE_SERVICE,serviceUrl:k.serviceUrl,serviceClass:k.FILES_STORE_SERVICE_CLASS,mount:a,options:c});a._state={initiated:!1,filter:null,filterDef:null};a.reset();a.setData([]);a.init();p&&p.getFileManager().addStore(a);return a};return l})},"xfile/data/Store":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred xide/mixins/ReloadMixin xide/manager/ServerActionBase dstore/Cache dstore/QueryResults xide/types xide/utils dojo/when xide/data/TreeMemory dstore/Trackable xide/data/ObservableStore xfile/model/File xide/lodash".split(" "),
function(q,l,g,d,a,c,k,w,p,t,r,f,n,v,h){function e(){return{addDot:!0,recursive:!1,rootSegment:".",Model:v,idProperty:"path",parentField:"parent",mount:"path",options:{fields:1663,includeList:"*",excludeList:"*"},serviceUrl:null,serviceClass:null,singleton:!0,queryAccessors:!0,autoEmitEvents:!1,mayHaveChildren:function(a){return 0==a.mayHaveChildren?!1:!0===a.directory},_lastFilter:null,_lastFilterDef:null,_lastFilterItem:null,_initiated:{value:!1},id:null,_state:{initiated:!1,filter:null,filterDef:null},
isInitiated:function(){return this._state.initiated},setInitiated:function(a){this._state.initiated=a},_extraSortProperties:{name:{ignoreCase:!0}},constructor:function(){this.id=p.createUUID()},onSorted:function(a,e){if(1==a.length&&"name"===a[0].property){var c=a[0].descending,d=function(a){return a.name},f=h.groupBy(e,function(a){return!0===a.directory},this);e=h.sortBy(f["true"],d);e=e.concat(h.sortBy(f["false"],d));c&&e.reverse()}if(c=h.find(e,{name:".."}))e.remove(c),e.unshift(c);return e=this.onAfterSort(e)},
onAfterSort:function(a){var e=this.micromatch;if("undefined"!==typeof mm&&e&&a&&a[0]){var c=a[0].realPath?"realPath":"path",c="name",d=h.pluck(a,c),f=mm(d,e);a=a.filter(function(a){return-1===f.indexOf(a[c])?null:a});this._onAfterSort&&(a=this._onAfterSort(a))}return a},_createSortQuerier:function(a){var e=this;return function(c){c=c.slice();c.sort("function"==typeof a?a:function(c,d){for(var h=0;h<a.length;h++){var f;if("function"==typeof a[h])f=a[h](c,d);else{var g=a[h].property;e._extraSortProperties[g]&&
p.mixin(a[h],e._extraSortProperties[g]);f=a[h].descending;var u=c.get?c.get(g):c[g],g=d.get?d.get(g):d[g],k=!!a[h].ignoreCase;null!=u&&(u=u.valueOf());null!=g&&(g=g.valueOf());k&&(u.toUpperCase&&(u=u.toUpperCase()),g.toUpperCase&&(g=g.toUpperCase()));f=u===g?0:!!f===(null===u||u>g)?-1:1}if(0!==f)return f}return 0});return e.onSorted(a,c)}},_getItem:function(a,e){var c=this.getSync(a)||this.getSync("./"+a);return c&&(this.isItemLoaded(c)||1==e)?c:"."===a?this.getRootItem():null},getItem:function(a,
e){if(0==e)return this._getItem(a);if(1==e){var c=a.split("/"),d=this,f=[],k=d.getSync(a);k||(k=d.getSync(a.replace("./","")));if(k&&this.isItemLoaded(k))return k;for(var l=new g,p=function(){if(h.find(f,{loaded:!1}))for(var e=0;e<f.length;e++){if(!f[e].loaded){var c=d.getSync(f[e].path);if(c)if(!0===c.directory&&d.isItemLoaded(c)){f[e].loaded=!0;continue}else if(null==c.directory){l.resolve(c);break}d._loadPath(f[e].path).then(function(a){f[e].loaded=!0;p()},function(a){var b=Math.abs(Math.min(0,
e-1));a=f[b];a||(b=f.length-1,a=f[b]);d.getItem(a.path);t(d.getItem(f[b].path,!1),function(a){l.resolve(a,f[b].path)})});break}}else l.resolve(d.getItem(a,!1))},k=".",n=0;n<c.length;n++)"."!=c[n]&&(0<c.length&&(k+="/"),k+=c[n],f.push({path:k,loaded:!1}));p();return l}return"."===a?this.getRootItem():null},getRootItem:function(){return{_EX:!0,path:".",name:".",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},getItemByPath:function(){},getParents:function(){return null},
getParent:function(a){if(!a)return null;var e=a,c=null;l.isString(e)&&(e=this.getSync(a));e&&e.parent&&(c=this.getSync(e.parent));return c||this.getRootItem()},isItemLoaded:function(a){return a&&(!a.directory||this._isLoaded(a))},loadItem:function(a,e){return this._loadItem(a,e)},_parse:function(a){a._S=this;h.isEmpty(a.children)||(h.each(a.children,function(e){e.parent=a.path;this._parse(e)},this),a._EX=!0,a.children=this.addItems(a.children));a.getPath=function(){return this.path}},_loadPath:function(a,
e){var c=this;return this._request(a).then(function(d){var f=c._getItem(a,!0);if(f)return e&&(h.isEmpty(f.children)||c.removeItems(f.children)),f._EX=!0,c.addItems(d,e),f.children=d;throw Error("cant get item at "+a);}.bind(this),function(a){console.error("error in load")})},addSync:function(a,e){(e=e||{}).overwrite=!1;return this.putSync(a,e)},_loadItem:function(a,e){var c=new g,d=this;if(!a)return c.reject("need item"),c;e&&("."===a.path?(d.setInitiated(!1),d.fetchRange().then(function(e){c.resolve({store:d,
items:e,item:a})})):this._loadPath(a.path,!0).then(function(e){c.resolve(a)},function(a){console.error("error occured whilst loading items");c.reject(a)}));return c},_normalize:function(a){return a&&a.items?a.items[0]:[]},_isLoaded:function(a){return a&&!0===a._EX},fetch:function(){},put:function(){},add:function(a){var e=this.getSync(a.path);e||(e=this.addSync(a),e._S=this,e.getPath=function(){return this.path});return e},removeItems:function(a){h.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path)},
this)},addItems:function(a){var e=[];h.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path);e.push(this.add(a))},this);return e},open:function(a){var e=this;if(this._isLoaded(a)){var c=new g;e.resetQueryLog();c.resolve(a.children);return c}a.isLoading=!0;return e._request(a.path).then(function(c){a.isLoading=!1;a._EX=!0;e.addItems(c);return a.children=c})},getDefaultSort:function(){return[{property:"name",descending:!1,ignoreCase:!0}]},filter:function(a){a.parent&&(this._state.path=a.parent);
var e=this.getSync(a.parent);e&&(this.isItemLoaded(e)?this._state.filterDef=null:this._state.filterDef=this._loadPath(e.path));delete this._state.filter;this._state.filter=a;return this.inherited(arguments)},_request:function(a){var e=this;return this.runDeferred(null,"ls",{path:a,mount:this.mount,options:this.options,recursive:this.recursive},{checkErrors:!1,displayError:!0}).then(function(a){a=e._normalize(a);e._parse(a);return a=a.children||a},function(a){logError(a,"error in FileStore : "+this.mount+
" :"+a)})},fetchRangeSync:function(){var a=this.fetchSync(),e=new g;e.resolve(a.length);return new k(a,{totalLength:e})},reset:function(){this._state.filter=null;this._state.filterDef=null;this.resetQueryLog()},resetQueryLog:function(){this.queryLog=[]},fetchRange:function(){var a=this._fetchRange();return new k(a.then(function(a){return a}),{totalLength:a.then(function(a){return a.length})})},initRoot:function(){var a=this;if(!this.isInitiated())return a._request(".").then(function(e){a.isInitiated()||
(h.each(e,a._parse,a),a.setData(e),a.setInitiated(!0),a.emit("loaded"));return a.fetchRangeSync(arguments)}.bind(this));var e=new g;e.resolve();return e},_fetchRange:function(){if(this._state.filter){var a=this._state.filterDef;if(a)return a.then(function(e){this.reset();a&&a.resolve&&a.resolve(e)}.bind(this)),a}var e=this;if(this.isInitiated()){var c=e.fetchRangeSync(arguments),d=new g,f=new g;d.resolve(c);f.resolve(c.length);e.emit("loaded");return new k(d,{totalLength:c.totalLength})}return e._request(".").then(function(a){e.isInitiated()||
(h.each(a,e._parse,e),e.setData(a),e.setInitiated(!0),e.emit("loaded"));return e.fetchRangeSync(arguments)}.bind(this))},getDefaultCollection:function(a){var e=this.getDefaultSort();return a?this.filter({parent:a}).sort(e):this.sort(e)}}}q=q("xfile/data/Store",[r,c,f,n,a.declare,d],e());q.Implementation=e;return q})},"xfile/model/File":function(){define(["xdojo/declare","xide/data/Model","xide/utils","xide/types"],function(q,l,g,d){return q("xfile.model.File",[l],{getFolder:function(){var a=this.getPath();
return this.directory?a:g.pathinfo(a,d.PATH_PARTS.ALL).dirname},getChildren:function(){return this.children},getParent:function(){return(this.getStore()||this._S).getParent(this)},getStore:function(){return this._store||this._S}})})},"xfile/config":function(){define(["dojo/_base/declare","xide/types"],function(q,l){l.config={ROOT_NODE:"xapp",FILE_SERVICE:"",START_PATH:"./",FILES_STORE_SERVICE_CLASS:"XCOM_Directory_Service",IS_MEDIA_PICKER:null,EDITOR_NODE:null,EDITOR_AFTER_NODE:null,ACTION_TOOLBAR:null,
ALLOWED_DISPLAY_MODES:{TREE:1,LIST:1,THUMB:1,IMAGE_GRID:1},LAYOUT_PRESET:null,beanContextName:null};return l})},"xfile/manager/FileManager":function(){define("dcl/dcl dojo/_base/kernel xide/manager/ServerActionBase xide/types xfile/types xide/utils xide/encoding/SHA1 xide/manager/RPCService dojo/Deferred xdojo/has xfile/manager/FileManagerActions require xfile/factory/Store xide/lodash xdojo/has!electron?xfile/manager/Electron".split(" "),function(q,l,g,d,a,c,k,w,p,t,r,f,n,v,h){g=[g,r];t("electronx")&&
h&&g.push(h);return q(g,{declaredClass:"xfile.manager.FileManager",getNewName:function(a,b){for(var c=a.name.replace(".meta.json",""),d=!1,h=1,f=null;!d;)f=c+"-"+h+".meta.json",v.find(b,{name:f})?h++:d=!0;return f},_uploadXHR:null,store:null,config:null,filesToUpload:null,serviceUrl:"index.php",serviceClass:"XCOM_Directory_Service",settingsStore:null,stores:[],getStore:function(a,b){var c=v.find(this.stores,{mount:a});return c?c:n.createFileStore(a,null,this.config,null,this.ctx)},addStore:function(a){this.stores.push(a);
a._on("destroy",this.removeStore.bind(this))},removeStore:function(a){this.stores.indexOf(a)&&this.stores.remove(a)},download:function(a){[].push(a.path);var b=decodeURIComponent(this.serviceUrl),b=b.replace("view\x3drpc","view\x3dsmdCall"),b=-1!=b.indexOf("?")?b+"\x26":b+"?",d=this.serviceClass||"XCOM_Directory_Service";a=c.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);b+="service\x3d"+d+".get\x26path\x3d"+a+"\x26callback\x3dasdf";this.config.DOWNLOAD_URL&&(b=""+this.config.DOWNLOAD_URL,
b+="\x26path\x3d"+a+"\x26callback\x3dasdf");var b=b+"\x26raw\x3dhtml\x26attachment\x3d1",h=c.getUrlArgs(location.href);c.mixin(h,{service:d+".get",path:a,callback:"asdf",raw:"html",attachment:"1",send:"1"});delete h.theme;delete h.debug;delete h.width;delete h.attachment;delete h.send;d=l.toJson(JSON.string(h));d=k._hmac(d,this.config.RPC_PARAMS.rpcSignatureToken,1);b+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;b+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+
"\x3d"+d;window.open(b)},getImageUrl:function(a,b,d){b=-1!=location.href.indexOf("noImageCache")||!0===b||!0===a.dirty;var h=decodeURIComponent(this.serviceUrl),h=h.replace("view\x3drpc","view\x3dsmdCall");a=c.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);var f=this.ctx.getFileManager().serviceClass||"XCOM_Directory_Service",h=-1!=h.indexOf("?")?h+"\x26":h+"?",h=h+("service\x3d"+f+".get\x26path\x3d"+a+"\x26callback\x3dasdf");this.config.DOWNLOAD_URL&&(h=""+this.config.DOWNLOAD_URL,
h+="\x26path\x3d"+a+"\x26callback\x3dasdf");var h=h+"\x26raw\x3dhtml\x26attachment\x3d0",h=h+"\x26send\x3d1",g=c.getUrlArgs(location.href);c.mixin(g,{service:f+".get",path:a,callback:"asdf",raw:"html"});c.mixin(g,d);delete g.theme;delete g.debug;delete g.width;a=l.toJson(g);a=k._hmac(a,this.config.RPC_PARAMS.rpcSignatureToken,1);h+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;h+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+a;b&&(h+="\x26time\x3d"+
(new Date).getTime());if(d)for(var p in d)h+="\x26"+p+"\x3d"+d[p];return h},onFileUploadFailed:function(a){var b=d.EVENTS;a.dfd&&a.dfd.reject(a);this.filesToUpload.remove(a);this.publish(b.ON_UPLOAD_FAILED,{item:a},this)},onFileUploaded:function(a){var b=this,c=d.EVENTS;setTimeout(function(){b.publish(c.STATUS,{message:""+a.file.name+" uploaded to "+a.dstDir,messageArgs:{}},b);a.dfd&&a.dfd.resolve(a);b.filesToUpload.remove(a);b.publish(c.ON_UPLOAD_FINISH,{item:a})},500)},getUploadUrl:function(){var a=
""+decodeURIComponent(this.serviceUrl),a=a.replace("view\x3drpc","view\x3dupload"),a=a.replace("../../../../","./"),a=a+"\x26service\x3d"+this.serviceClass;return a+=".put\x26callback\x3dnada"},initXHRUpload:function(a,b,h,f){var g=new XMLHttpRequest;b=""+this.getUploadUrl();b+="\x26mount\x3d"+encodeURIComponent(f);b+="\x26dstDir\x3d"+encodeURIComponent(h);var k=this;h=g.upload;h.addEventListener("progress",function(b){if(b.lengthComputable)b={item:a,progress:b},a.isLoading=!0,a.dfd.progress(b);else k.onFileUploaded(a)}.bind(this),
!1);g.onreadystatechange=function(){if(4==g.readyState){if(g.responseText&&"OK"!=g.responseText){var b=c.getJson(g.responseText);!b&&g.responseText.indexOf("Fata Error")&&(b={result:[g.responseText],code:1});if(b&&b.result&&v.isArray(b.result)&&0<b.result.length){for(var h=null,f=0;f<b.result.length;f++)k.publish(d.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.result[f],k),h=b.result[f];h&&(a.error=h);k.onFileUploadFailed(a);k.submitNext();return}b&&b.error&&(k.publish(d.EVENTS.ERROR,"Error uploading : "+
a.name+" "+b.error.message,k),k.onFileUploadFailed(a))}k.onFileUploaded(a);k.submitNext()}}.bind(this);h.onerror=function(){k.publish(d.EVENTS.ERROR,"Error uploading : "+a.name,k)};g.open("POST",b,!0);return g},hasLoadingItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if("loading"==this.filesToUpload[a].status)return this.filesToUpload[a];return!1},upload:function(a,b,c,d,h){h=[];for(var f=0;f<a.length;f++){var g={file:a[f],dstDir:""+c,mount:""+b,callee:d,view:d,dfd:new p};h.push(g.dfd);
this.filesToUpload.push(g)}this.submitNext();return h},sendFileUsingFormData:function(a,b){var c=new FormData;c.append("userfile_0",b.file);a.send(c)},sendFileMultipart:function(a){a.status="loading";var b=this.initXHRUpload(a,"",a.dstDir,a.mount);this.publish(d.EVENTS.ON_UPLOAD_BEGIN,{item:a,name:a.name},this);window.FormData&&this.sendFileUsingFormData(b,a)},submitNext:function(){var a=this.getNextUploadItem();a&&this.sendFileMultipart(a)},getNextUploadItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if(!this.filesToUpload[a].status)return this.filesToUpload[a];
return!1},onError:function(a){if(a)if(1===a.code){if(a.message&&v.isArray(a.message)){this.publish(d.EVENTS.ERROR,a.message.join("\x3cbr/\x3e"),this);return}}else 0===a.code&&this.publish(d.EVENTS.STATUS,"Ok",this);this.publish(d.EVENTS.ERROR,{error:a},this)},addError:function(a){var b=this;a.addCallback(function(){b.onError()})},downloadItem:function(a,b){return this.callMethod(d.OPERATION.DOWNLOAD,[a],b,!0)},downloadTo:function(a,b,c,h,f){if(f){var g=this,k=function(a){var b=!1;a&&a.error&&1==a.error.code&&
(b=!0);g.publish(d.EVENTS.ON_DOWNLOAD_TO_END,{terminatorItem:f,failed:b},this);h(arguments)};g.publish(d.EVENTS.ON_DOWNLOAD_TO_BEGIN,{dst:f,url:a,items:[f]},this)}return this.callMethod(d.OPERATION.DOWNLOAD_TO,[a,b,c],k,!0)},find:function(a,b,c){try{return this.callMethod(d.OPERATION.FIND,[a,b],c,!0)}catch(h){logError(h,"find")}},getContent:function(a,b,h,g){if(this.getContentE){var k=this.getContentE.apply(this,arguments);if(k)return k}return t("php")?(k=this.serviceObject.base64_encode(c.buildPath(a,
b,!0)),this.callMethod(d.OPERATION.GET_CONTENT,[k,!1,!1],h,!1)):this._getText(f.toUrl(a).replace("main.js","")+"/"+b,{sync:!1,handleAs:"text"}).then(function(a){try{h&&h(a)}catch(b){logError(b,"error running RPC")}})},setContent:function(a,b,c,h){this.publish(d.EVENTS.ON_CHANGED_CONTENT,{mount:a,path:b,content:c});this.publish(d.EVENTS.ON_STATUS_MESSAGE,{text:"Did save file : "+a+"://"+b});if(this.setContentE){var f=this.setContentE.apply(this,arguments);if(f)return f}return this.callMethod(d.OPERATION.SET_CONTENT,
[a,b,c],h,!0)},onMessages:function(a){if((a=c.getJson(a.events))&&v.isArray(a))for(var b=0;b<a.length;b++){var d={path:a[b].relPath};c.mixin(d,a[b]);this.publish(a[b].clientEvent,d,this)}},onErrors:function(a){},init:function(){this.stores=[]},callMethodEx:function(a,b,h,f,g){var k=a||this.serviceClass,l=this;if(!this.serviceObject[k][b]){if(!0===g)this.onError({code:1,message:["Sorry, server doesnt know "+b]});return null}a={};a=c.mixin(a,this.config.RPC_PARAMS.rpcFixedParams);a[this.config.RPC_PARAMS.rpcUserField]=
this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=a;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;this.serviceObject[k][b](h).then(function(a){try{f&&f(a)}catch(c){console.error("bad news : callback for method "+b+" caused a crash in service class "+k)}a&&a.error&&3==a.error.code&&setTimeout(function(){l.onMessages(a.error)},50);if(a&&a.error&&a.error&&0!==a.error.code)l.onError(a.error);
else l.publish(d.EVENTS.STATUS,{message:"Ok!"},this)},function(a){l.onError(a)})},callMethod:function(a,b,h,f){var g=this,k=this.serviceClass;try{if(!this.serviceObject[k][a]){if(!0===f)this.onError({code:1,message:["Sorry, server doesnt know "+a]});return null}k={};k=c.mixin(k,this.config.RPC_PARAMS.rpcFixedParams);k[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=k;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=
this.config.RPC_PARAMS.rpcSignatureToken;var l=this.serviceObject[this.serviceClass][a](b);l.then(function(b){try{h&&h(b)}catch(c){console.error("crashed in "+a),logError(c,"error running RPC")}b&&b.error&&3==b.error.code&&setTimeout(function(){g.onMessages(b.error)},50);if(b&&b.error&&b.error&&1==b.error.code)g.onError(b.error);else!1!==f&&g.publish(d.EVENTS.STATUS,{message:"Ok!"},this)},function(a){g.onError(a)});return l}catch(p){console.error("crash calling method"+p,arguments),g.onError(p),logError(p,
"error ")}},_initService:function(){this.filesToUpload=[];!this.serviceObject&&this.serviceUrl&&(this.serviceObject=new w(decodeURIComponent(this.serviceUrl)),this.serviceObject.config=this.config)}})})},"xfile/manager/FileManagerActions":function(){define(["dcl/dcl","xide/types","xide/utils"],function(q,l,g){return q(null,{declaredClass:"xfile/manager/FileManagerActions",_publishProgress:function(d,a,c,k,l){a={terminatorItem:a,failed:k,items:c||a};g.mixin(a,l);this.publish(d,a,this)},doOperation:function(d,
a,c,g,l,p){var t=this,r=d.substring(0,1).toUpperCase()+d.substring(1),f="on"+r+"End";t._publishProgress("on"+r+"Begin",c,g,!1,l);return this.runDeferred(null,d,a,p).then(function(){t._publishProgress(f,c,g,!1,l)},function(a){t._publishProgress(f,c,g,!0,l)})},deleteItems:function(d,a,c){return this.doOperation(l.OPERATION.DELETE,[d,a,!0],d,d,null,c)},copyItem:function(d,a,c,g){return this.doOperation(l.OPERATION.COPY,[d,a,c,!1],d,d,{dst:a},g)},mkdir:function(d,a,c){return this.doOperation(l.OPERATION.NEW_DIRECTORY,
[d,a],a,null,null,c)},mkfile:function(d,a,c){return this.doOperation(l.OPERATION.NEW_FILE,[d,a],a)},rename:function(d,a,c){return this.doOperation(l.OPERATION.RENAME,[d,a,c],a)},moveItem:function(d,a,c,g,q,p){return this.doOperation(l.OPERATION.MOVE,[d,a,c,g,q],d,null,null,p)},compressItem:function(d,a,c,g){return this.doOperation(l.OPERATION.COMPRESS,[d,a,c],a)},extractItem:function(d,a,c){return this.doOperation(l.OPERATION.EXTRACT,[d,a],a)}})})},"xfile/manager/MountManager":function(){define("dcl/dcl dojo/_base/lang xide/manager/ResourceManager xide/mixins/ReloadMixin xide/mixins/EventedMixin xide/types xide/utils".split(" "),
function(q,l,g,d,a,c,k){return q([g,a.dcl,d.dcl],{declaredClass:"xfile.manager.MountManager",serviceClass:"XApp_Resource_Service",mountData:null,didReload:!1,editMount:function(a){},removeMount:function(a){},getMounts:function(){return this.mountData},_onDialogOk:function(a,c,d){var g=k.toOptions(c),f=this;a=null!=d.name;c={"class":"cmx.types.Resource",enabled:!0};for(var n=0;n<g.length;n++){var q=g[n];null==q.user?c[q.name]=q.value:(c.config||(c.config={}),c.config[q.name]=q.value)}g="";c.label?
g=c.label:c.config.label&&(g=c.config.label);c.name=""+(null!=d.name?d.name:g.toLowerCase());"FILE_PROXY"===c.config.type?(c.path=""+c.path+"",l.mixin(c,c.config)):"REMOTE_FILE_PROXY"===c.config.type&&(c.path=c.name+"://");d=function(){f.ls(function(a){f.onMountDataReady(a)})};a?this.updateResource(c,!1,d):this.createResource(c,!1,d)},registerLocalMount:function(a){},registerFTP:function(a){},registerSFTP:function(a){},registerDropbox:function(a){},registerWebDav:function(){},onMountDataReady:function(a){this.mountData=
a;this.publish(c.EVENTS.ON_MOUNT_DATA_READY,{data:a});var d=this;setTimeout(function(){d.publish(c.EVENTS.ON_MOUNT_DATA_READY,{data:a})},4E3)},check:function(){this.serviceObject||this._initService()},init:function(){this.ctx.getFileManager()&&(this.serviceObject=this.ctx.getFileManager().serviceObject)},createResource:function(a,c,d){return this.callMethodEx(null,"createResource",[a,c],d,!0)},removeResource:function(a,c,d){return this.callMethodEx(null,"removeResource",[a,!0],d,!0)},updateResource:function(a,
c,d){return this.callMethodEx(null,"updateResource",[a,!0],d,!0)},ls:function(a){return this.runDeferred(null,"ls",[]).then(function(c){this.mountData=c;this.onMountDataReady(c);a&&a(c)}.bind(this))}})})},"xfile/manager/BlockManager":function(){define(["dcl/dcl","xide/manager/ManagerBase","xide/mixins/ReloadMixin","xblox/manager/BlockManager"],function(q,l,g,d){return q([l,d,g.dcl],{declaredClass:"xfile/manager/BlockManager",currentItem:null,setScriptFunctions:function(a,c,d){this.inherited(arguments)}})})},
"xfile/views/FileConsole":function(){define("xdojo/declare dcl/dcl xide/types xide/utils xide/mixins/PersistenceMixin xide/layout/_TabContainer xide/views/_Console xide/views/_ConsoleWidget xfile/views/FileSize xide/views/ConsoleView xide/lodash dojo/has!xace?xace/views/Editor".split(" "),function(q,l,g,d,a,c,k,w,p,t,r,f){function n(){return l(null,{owner:null,onServerResponse:function(a,c,b){if(a&&c&&a.owner&&a.owner.onServerResponse)return a.owner.onServerResponse(c,b)},runBash:function(a,c,b,d){var f=
this,g=f.ctx.fileManager;c=g.serviceObject.base64_encode(c);g.runDeferred("XShell","run",["sh",c,b]).then(function(b){d&&$(d).find(".consoleRunningCommand").remove();f.onServerResponse(a,b,!1)})},runPHP:function(a,c,b){var d=this,f=d.ctx.fileManager;c=f.serviceObject.base64_encode(c);f.runDeferred("XShell","run",["php",c,b]).then(function(b){d.onServerResponse(a,b,!1)})},runJavascript:function(a,c,b,d){b=(new Function("{"+c+"; }")).call(b,d);return null!=b?(this.onServerResponse(a,b),b):c},onConsoleCommand:function(a,
c){var b=a.console;if("sh"===b.type){var f=this.onServerResponse(b,"\x3cspan class\x3d'consoleRunningCommand fa-spinner fa-spin'\x3e\x3c/span\x3e\x3cpre style\x3d'font-weight: bold'\x3e# "+c+"\x3c/pre\x3e",!0),g=null;if(this.owner&&this.owner.getCurrentFolder){var k=this.owner.getCurrentFolder();k&&(g=d.buildPath(k.mount,k.path,!1))}return this.runBash(b,c,g,f)}if("php"===b.type)return g=null,b.isLinked()&&(g=this.getCurrentPath()),this.runPHP(b,c,g);if("javascript"===b.type)return this.runJavascript(b,
c)},onConsoleEnter:function(a,c){return this.onConsoleCommand(a,c)}})}function v(){var a=l(t.Editor,{didAddMCompleter:!1,multiFileCompleter:null,blockScope:null,driverInstance:null,onACEReady:function(a){},onEditorCreated:function(a,b){this.inherited(arguments);this.onACEReady(a)}});return l(t,{EditorClass:a,onAddEditorActions:l.superCall(function(a){return function(b){a.call(this,b);b=b.actions;r.find(b,{command:"File/Save"});b.remove(r.find(b,{command:"File/Save"}));b.remove(r.find(b,{command:"File/Reload"}))}}),
logTemplate:'\x3cpre style\x3d"font-size:100%;padding: 0px;" class\x3d""\x3e    ${time} - ${result}\x3c/pre\x3e',_parse:function(a,b,c){var d=""+b;0<d.indexOf("{{")||0<d.indexOf("}}")?d=_parser.parse(g.EXPRESSION_PARSER.FILTREX,d,this,{variables:a.getVariablesAsObject(),delimiters:{begin:"{{",end:"}}"}}):(a=a.parseExpression(b,null,null,null,c))&&(d=a);return d},parse:function(a,b){var c=this.driverInstance;return c&&c.blockScope?this._parse(c.blockScope,a,b):a}})}q=q("xfile.views.FileConsole",null,
{isStatusbarOpen:!1,resizeToParent:!0,__bottomTabContainer:null,onCloseStatusPanel:function(a){},onOpenStatusPanel:function(a){if(!a._tabs){var e=this,b=this.__bottomTabContainer||d.addWidget(c,{direction:"below"},null,a,!0);this.__bottomTabContainer=a._tabs=b;var f=v(),g=new (n());g.ctx=e.ctx;g.owner=this;var k=b.createTab("Bash","fa-terminal");k.add(f,{type:"sh",title:"Bash",icon:"fa-terminal",ctx:e.ctx,owner:e,value:"ls -l --color\x3dalways"},null,!0).delegate=g;k._onShown();k=b.createTab("Javascript",
"fa-code").add(f,{type:"javascript",title:"Javascript",ctx:e.ctx,value:"return 2+2;",owner:e},null,!1);k.delegate=g;var k=b.createTab("PHP","fa-terminal").add(f,{type:"php",title:"PHP",ctx:e.ctx,value:"\x3c?php \n\n\x3e",owner:e},null,!1),l=b.createTab("Sizes","fa-bar-chart");this.__fileSize=l.add(p,{owner:this,ctx:e.ctx},null,!1);this._on("openedFolder",function(a){d.destroy(e.__fileSize);l.resize();e.resize();e.__fileSize=null;e.__fileSize=l.add(p,{owner:e,ctx:e.ctx},null,!1);d.resizeTo(e.__fileSize,
l,!0,!0);e.__fileSize.startup()});a.add(b,null,!1)}return this.inherited(arguments)},onStatusbarCollapse:function(a){var c=null;this.isStatusbarOpen?(c=this.getBottomPanel(!1,.2),c.collapse(),this.onCloseStatusPanel(a),a&&a.removeClass("fa-caret-down"),a&&a.addClass("fa-caret-up")):((c=this._getBottom())?c.expand():c=this.getBottomPanel(!1,.2),this.onOpenStatusPanel(c),a&&a.removeClass("fa-caret-up"),a&&a.addClass("fa-caret-down"));this.isStatusbarOpen=!this.isStatusbarOpen;c.resize()}});q.createEditor=
function(a,c,b,g){var k={filePath:"",fileName:""};c={_permissions:[],item:k,value:c,style:"padding:0px;top:0 !important",iconClass:"fa-code",options:d.mixin(g,{filePath:k.path,fileName:k.name}),storeDelegate:{},title:"No Title"};d.mixin(c,g);a=d.addWidget(f,c,b,a,!0,null,null,!1);a.resize();return a};q.createShellViewDelegate=n;return q})},"xfile/data/DriverStore":function(){define("dojo/_base/declare dojo/Deferred xide/data/ObservableStore xide/data/TreeMemory xfile/data/Store xide/manager/ServerActionBase xide/utils".split(" "),
function(q,l,g,d,a,c,k){a=a.Implementation;return q("driverFileStore",[d,g,c.declare],k.mixin(a(),{driver:null,addDot:!1,rootSegment:"/",getRootItem:function(){var a=this._root;return a?a:this._root={_EX:!1,path:"/",name:"/",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},_filter:function(a){return a},_request:function(a){var c=this,d=this;if("."===a||"/"===a){var g=new l,f=d.driver.callCommand("LSProg",{override:{args:["/*"]}});f.then(function(a){a=a.files;
_.each(a,function(a){a.parent="."});a=d._filter(a);a=c._normalize({items:[{mount:"root",path:"/",children:a,name:"/",isDir:!0}]});d._parse(a);a=a.children||a;g.resolve(a)})}else g=new l,f=d.driver.callCommand("LSProg",{override:{args:[a+(d.glob||"/*")]}}),f.then(function(f){f=f.files;_.each(f,function(c){c.parent=a});f=d._filter(f);f=c._normalize({items:[{mount:"root",path:a,children:f,isDir:!0}]});d._parse(f);f=f.children||f;g.resolve(f)});return g}}))})},"xfile/views/FileGridLight":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/GridLight xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),
function(q,l,g,d,a,c,k,w,p,t,r,f,n){t=f.DEFAULT_FILE_GRID_PERMISSIONS;var v=q("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:a.clone(d.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:d.ITEM_TYPE.FILE,permissions:t,
contextMenuArgs:{limitTo:null},setState:function(a){this.inherited(arguments);var c=this,b=c.collection,d=a.store.path;b.getSync(d);var f=c.refresh();try{f.then(function(){b.getItem(d,!0).then(function(a){c.openFolder(a)})})}catch(g){console.error("error restoring folder state")}return f},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=p.createFileStore(a.mount,
a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(c){a._columns[c.label]=!this.isColumnHidden(c.id)},this);return a},onSaveLayout:function(a){a=a.data;var c=this.getState();a.widgets.push({widget:this.declaredClass,state:c});return a},formatColumn:function(c,
d,b){var f=this.selectedRenderer?this.selectedRenderer.prototype:this;if(f.formatColumn&&(f=f.formatColumn.apply(arguments))||b.renderColumn&&(f=b.renderColumn.apply(this,arguments)))return f;switch(c){case "fileType":if("folder"==d)return n.localize("kindFolder");if(b.mime){var f="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),g=n.localize(f);return f!==g?g:d}case "name":var g=b&&null!=b.directory&&!0===b.directory,k=!1===b.read&&!1===b.write,l=".."==b.name,f="",f=g?l?"fa fa-level-up itemFolderList":
k?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":k?"fa fa-lock itemFolderList":"itemFolderList fa "+a.getIconClass(b.path),g=!0===b.showPath?b.path:d;return'\x3cspan class\x3d"'+f+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+g+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return a.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(f=b.owner)&&f.user?
f.user.name:"";case "modified":if(""===d)break;g=null==!b.directory;return!g&&n.translations.dateFormat?n.formatDate(d).replace("ms",""):""}return d},getColumns:function(){function a(b,d,f,h){null!=c._columns[b]&&(h=!c._columns[b]);c.columns.push({renderExpando:"Name"===b,label:b,field:d,sortable:f,formatter:function(a,b){return c.formatColumn(d,a,b)},hidden:h})}var c=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,c){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var b=this,d=new g;if(b){var f=this.collection;"."===a.path?(f.resetQueryLog(),b.set("collection",f.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):f.open(a).then(function(c){f.resetQueryLog();
b.set("collection",f.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(c)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var c=this.collection.getSync(a.rPath);c&&(a=c)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(1==a.isBack&&(c=this.getHistory().getNow()))return this.collection.getSync(c);if(a=a._S.getParent(a))return a}return null},getClass:function(){return v},
getHistory:function(){this._history||(this._history=new c);return this._history},renderArray:function(a,c){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);l.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var e=k.getDefaultActions(this.permissions,this,this),e=e.concat(this.getFileActions(this.permissions));this.addActions(e)}this._history=new c;var b=this;this.subscribe(d.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===b.itemType&&(b.currentCopySelection=a.selection,b.refreshActions())});b._on("noData",function(){b.getRows();if(!(0<b._total)){var a=b._history.getNow();a&&"./."!==a&&b.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:b.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=b.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(b.removeRow(a),b.refresh())});this._on("openFolder",
function(a){b.set("title",a.item.name)});b.selectedRenderer&&(a=this.refresh())&&a.then(function(){b.set("loading",!1);b.setRenderer(b.selectedRenderer,!1)});this._on("onChangeRenderer",function(){b.refresh()});setTimeout(function(){b.resize()},500);return a}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(c,d,b,f,g,k){d=a.mixin({collection:k.getDefaultCollection(),_parent:b,Module:v,ctx:c},d||{});d=a.addWidget(v,d,null,b,g,null,null,!0,null);f&&c.getWindowManager().registerView(d,!1);
return d};v.DEFAULT_PERMISSIONS=t;return v})},"xfile/views/GridLight":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Selection xide/mixins/_State xide/widgets/_Widget".split(" "),function(q,l,g,d,a,c,k,w,p,t,r,f,n){g=[g,d,a];q=q.classFactory("multiRenderer",{},g,k.Implementation);l=c.createGridClass("xfile.views.GridLight",{},{SELECTION:{CLASS:r},
KEYBOARD_SELECTION:!0,COLUMN_HIDER:!0,COLUMN_REORDER:!1,CONTEXT_MENU:l.GRID_FEATURES.CONTEXT_MENU,CLIPBOARD:l.GRID_FEATURES.CLIPBOARD,ACTIONS:l.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},SPLIT:{CLASS:p},KEYBOARD_NAVIGATION:{CLASS:t},STATE:{CLASS:f},WIDGET:{CLASS:n}},{RENDERER:q},{renderers:g,selectedRenderer:a});l.DEFAULT_RENDERERS=g;l.DEFAULT_MULTI_RENDERER=q;return l})},"xfile/manager/Electron":function(){define(["dcl/dcl","xdojo/has","xide/utils","dojo/Deferred"],function(q,l,g,d){l("electronx");
return q(null,{declaredClass:"xfile.manager.Electron",require:function(){return window.eRequire.apply(null,arguments)},srequire:function(){return this.require("electron").remote.require.apply(null,arguments)},remote:function(){return(0,window.eRequire)("electron").remote},getContentE:function(a,c,k,l){var p=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{};l=new d;this.require("os");this.require("electron");var q=this.require("path"),r=this.require("fs");a=a.replace("/","");if(p[a]){a=
p[a];if(!a)return console.error("cant resolve file "+a+"/"+c),!1;c=c.replace("./","/");c=g.replaceAll("/",q.sep,c);a=q.resolve(a+q.sep+c);if(r.existsSync(a)){c=r.statSync(a).size;q=new Buffer(c);a=r.openSync(a,"r");if(!c)return"";r.readSync(a,q,0,c,0);r.closeSync(a);r=q.toString();l.resolve(r);k&&k(r)}else return!1;return l}console.error("open in os failed: have no VFS config for "+a)},setContentE:function(a,c,k,l){var p=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{},q=new d;
this.require("os");var r=this.require("path"),f=this.require("fs");a=a.replace("/","");if(p[a]){a=p[a];if(!a)return!1;c=c.replace("./","/");c=g.replaceAll("/",r.sep,c);r=r.resolve(a+r.sep+c);if(f.existsSync(r))try{f.writeFileSync(r,k),l&&l(),q.resolve()}catch(n){return console.error("error saving file "+r),!1}else return console.error("path "+r+" doesnt exists, fallback to legacy setContent"),!1;return q}console.error("open in os failed: have no VFS config for "+a)}})})}}});
//# sourceMappingURL=xfile.js.map