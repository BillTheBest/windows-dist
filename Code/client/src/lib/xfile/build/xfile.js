//>>built
require({cache:{"xfile/main":function(){define("dojo/_base/kernel xfile/types xfile/component xfile/views/Grid xfile/views/FileGrid xfile/FileActions xfile/Statusbar xfile/ThumbRenderer xfile/Breadcrumb xfile/types xfile/component xfile/config xfile/model/File xfile/manager/FileManager xfile/manager/MountManager xfile/manager/BlockManager xfile/views/FileConsole xfile/data/DriverStore xfile/views/FileGridLight xfile/views/manager/Electron".split(" "),function(){return dojo.xfile})},"xfile/types":function(){define(["dojo/_base/lang",
"xide/types","xide/types/Types"],function(n,h){h.registerCustomMimeIconExtension=function(e,b){h.customMimeIcons[e]=b};var f=h.ACTION;h.DEFAULT_FILE_GRID_PERMISSIONS=[f.EDIT,f.COPY,f.CLOSE,f.MOVE,f.RENAME,f.DOWNLOAD,f.RELOAD,f.DELETE,f.NEW_FILE,f.NEW_DIRECTORY,f.CLIPBOARD,f.LAYOUT,f.COLUMNS,f.SELECTION,f.PREVIEW,f.OPEN_IN,f.GO_UP,f.SEARCH,f.OPEN_IN_TAB,f.TOOLBAR,f.STATUSBAR,f.UPLOAD,f.SOURCE,f.SIZE_STATS,f.CONSOLE,f.HEADER,"File/Compress","File/New",f.CONTEXT_MENU];h.FIELDS={SHOW_ISDIR:1602,SHOW_OWNER:1604,
SHOW_MIME:1608,SHOW_SIZE:1616,SHOW_PERMISSIONS:1632,SHOW_TIME:1633,SHOW_FOLDER_SIZE:1634,SHOW_FOLDER_HIDDEN:1635,SHOW_TYPE:1636,SHOW_MEDIA_INFO:1637};h.FILE_PANEL_LAYOUT={TREE:1,LIST:2,THUMB:3,PREVIEW:4,COVER:5,SPLIT_VERTICAL:6,SPLIT_HORIZONTAL:7,IMAGE_GRID:8};h.LAYOUT_PRESET={DUAL:1,SINGLE:2,BROWSER:3,PREVIEW:4,GALLERY:5,EDITOR:6};h.PANEL_OPTIONS={ALLOW_NEW_TABS:!0,ALLOW_MULTI_TAB:!1,ALLOW_INFO_VIEW:!0,ALLOW_LOG_VIEW:!0,ALLOW_CONTEXT_MENU:!0,ALLOW_LAYOUT_SELECTOR:!0,ALLOW_SOURCE_SELECTOR:!0,ALLOW_COLUMN_RESIZE:!0,
ALLOW_COLUMN_REORDER:!0,ALLOW_COLUMN_HIDE:!0,ALLOW_ACTION_TOOLBAR:!0,ALLOW_MAIN_MENU:!0};h.FILE_PANEL_OPTIONS_LEFT={LAYOUT:2,AUTO_OPEN:!0};h.FILE_PANEL_OPTIONS_MAIN={LAYOUT:3,AUTO_OPEN:!0};h.FILE_PANEL_OPTIONS_RIGHT={LAYOUT:3,AUTO_OPEN:!0};h.FILE_GRID_COLUMNS={NAME:"name",SIZE:"size",MODIFIED:"modified"};h.ACTION_TOOLBAR_MODE={SELF:"self"};n.mixin(h.ITEM_TYPE,{FILE:"BTFILE"});n.mixin(h.EVENTS,{STORE_CHANGED:"onStoreChange",BEFORE_STORE_CHANGE:"onBeforeStoreChange",STORE_REFRESHED:"onStoreRefreshed",
ON_FILE_STORE_READY:"onFileStoreReady",ON_DID_OPEN_ITEM:"onDidOpenItem",ON_SHOW_PANEL:"onShowPanel",ITEM_SELECTED:"onItemSelected",ERROR:"fileOperationError",STATUS:"fileOperationStatus",IMAGE_LOADED:"imageLoaded",IMAGE_ERROR:"imageError",RESIZE:"resize",ON_UPLOAD_BEGIN:"onUploadBegin",ON_UPLOAD_PROGRESS:"onUploadProgress",ON_UPLOAD_FINISH:"onUploadFinish",ON_UPLOAD_FAILED:"onUploadFailed",ON_CLIPBOARD_COPY:"onClipboardCopy",ON_CLIPBOARD_PASTE:"onClipboardPaste",ON_CLIPBOARD_CUT:"onClipboardCut",
ON_CONTEXT_MENU_OPEN:"onContextMenuOpen",ON_PLUGIN_LOADED:"onPluginLoaded",ON_PLUGIN_READY:"onPluginReady",ON_MAIN_VIEW_READY:"onMainViewReady",ON_FILE_CONTENT_CHANGED:"onFileContentChanged",ON_PANEL_CLOSED:"onPanelClosed",ON_PANEL_CREATED:"onPanelCreated",ON_COPY_BEGIN:"onCopyBegin",ON_COPY_END:"onCopyEnd",ON_DOWNLOAD_TO_BEGIN:"onDownloadToBegin",ON_DOWNLOAD_TO_END:"onDownloadToEnd",ON_DELETE_BEGIN:"onDeleteBegin",ON_DELETE_END:"onDeleteEnd",ON_MOVE_BEGIN:"onMoveBegin",ON_MOVE_END:"onMoveEnd",ON_COMPRESS_BEGIN:"onCompressBegin",
ON_COMPRESS_END:"onCompressEnd",ON_SOURCE_MENU_OPEN:"onSourceMenuOpen",ON_MOUNT_DATA_READY:"onMountDataReady",ON_XFILE_READY:"onXFileReady",ON_CHANGE_PERSPECTIVE:"onChangePerspective",ON_FILE_PROPERTIES_RENDERED:"onFilePropertiesRendered"});h.SELECTION_MODE={SINGLE:"single",MULTI:"multiple",EXTENDED:"extended"};h.OPERATION={COPY:"copy",MOVE:"move",RENAME:"rename",DELETE:"delete",OPEN:"open",EDIT:"edit",DOWNLOAD:"download",DOWNLOAD_TO:"downloadTo",INFO:"info",COMPRESS:"compress",RELOAD:"reload",PREVIEW:"preview",
INSERT_IMAGE:"insertImage",COPY_PASTE:"copypaste",DND:"dnd",OPTIONS:"options",NEW_FILE:"mkfile",NEW_DIRECTORY:"mkdir",GET_CONTENT:"get",SET_CONTENT:"set",FIND:"find",CUSTOM:"custom",PERMA_LINK:"permaLink",ADD_MOUNT:"ADD_MOUNT",REMOVE_MOUNT:"REMOVE_MOUNT",EDIT_MOUNT:"EDIT_MOUNT",PERSPECTIVE:"PERSPECTIVE",EXTRACT:"extract"};h.OPERATION_INT={NONE:0,EDIT:1,COPY:2,MOVE:3,INFO:4,DOWNLOAD:5,COMPRESS:6,DELETE:7,RENAME:8,DND:9,COPY_PASTE:10,OPEN:11,RELOAD:12,PREVIEW:13,INSERT_IMAGE:15,NEW_FILE:16,NEW_DIRECTORY:17,
UPLOAD:18,READ:19,WRITE:20,PLUGINS:21,CUSTOM:22,FIND:23,PERMA_LINK:24,ADD_MOUNT:25,REMOVE_MOUNT:26,EDIT_MOUNT:27,PERSPECTIVE:28,CLIPBOARD_COPY:29,CLIPBOARD_CUT:30,CLIPBOARD_PASTE:31,EXTRACT:32};return h})},"xfile/component":function(){define(["dojo/_base/declare","xide/model/Component"],function(n,h){return n("xfile.component",h,{beanType:"BTFILE",getDependencies:function(){return["xfile/types","xfile/manager/FileManager","xfile/manager/MountManager","xfile/factory/Store","xfile/views/FileGrid"]},
getLabel:function(){return"xfile"},getBeanType:function(){return this.beanType}})})},"xfile/views/Grid":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xfile/Statusbar xfile/views/UploadMixin xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Search xgrid/Selection xide/mixins/_State xide/widgets/_Widget xdojo/has!FileConsole?xfile/views/FileConsole xfile/FolderSize xide/noob".split(" "),function(n,
h,f,e,b,d,v,w,t,q,p,c,m,r,a,g,k,l,u){f=[f,e,b];n=n.classFactory("multiRenderer",{},f,v.Implementation);h=d.createGridClass("xfile.views.Grid",{},{SELECTION:{CLASS:r},KEYBOARD_SELECTION:!0,CONTEXT_MENU:h.GRID_FEATURES.CONTEXT_MENU,TOOLBAR:h.GRID_FEATURES.TOOLBAR,CLIPBOARD:h.GRID_FEATURES.CLIPBOARD,ACTIONS:h.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},STATUS_BAR:{CLASS:t},SPLIT:{CLASS:p},KEYBOARD_NAVIGATION:{CLASS:c},SEARCH:{CLASS:m},STATE:{CLASS:a},UPLOAD:{CLASS:q},WIDGET:{CLASS:g},CONSOLE:{CLASS:k?
k:u},SIZES:{CLASS:l}},{RENDERER:n},{renderers:f,selectedRenderer:b});h.DEFAULT_RENDERERS=f;h.DEFAULT_MULTI_RENDERER=n;return h})},"xfile/ThumbRenderer":function(){define(["xdojo/declare","xide/utils","dojo/dom-construct","xgrid/ThumbRenderer"],function(n,h,f,e){return n("xfile.ThumbRenderer",[e],{thumbSize:"400",resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){$(this.domNode.parentNode).removeClass("metro");$(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){$(this.domNode.parentNode).addClass("metro");
$(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_renderUpload:function(b,d,e){d=parseInt(d.replace("%",""));100==d&&(d=90);b='\x3cdiv class\x3d"tile widget uploadItem"\x3e\x3cdiv class\x3d"radial-progress tile widget " data-progress\x3d"'+d+'"\x3e\x3cdiv class\x3d"circle"\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"shadow"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"inset"\x3e\x3cdiv class\x3d"percentage"\x3e\x3cdiv class\x3d"numbers"\x3e\x3cspan\x3e-\x3c/span\x3e';
for(d=0;99>d;d++)b+="\x3cspan\x3e"+d+"%\x3c/span\x3e";return b+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},renderRow:function(b){if(!0===b.isUpload)return $(this._renderUpload(b.name,b.progress+"%",b))[0];if(b.renderRow){var d=b.renderRow.apply(this,[b]);if(d)return d}var d=f.create("div",{className:"tile widget"}),e=!1===b.read&&!1===b.write,w=".."==b.name,t=b&&!!b.directory,q=!1,p="",c="fa fa-folder fa-5x";this._doubleWidthThumbs=!0;var m="icon";t?(c=w?"fa fa-level-up fa-5x itemFolder":
e?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",q=!0):e?(c="fa fa-lock fa-5x itemFolder",q=!0):h.isImage(b.path)?(c=this.getImageUrl(b),b.icon=c?c:this.config.REPO_URL+"/"+b.path,c="imageFile"):(c="fa fa-5x "+h.getIconClass(b.path),q=!0);p=b.name;e='\x3cspan style\x3d"text-shadow: 2px 2px 5px rgba(0,0,0,0.3);font-size: 72px;opacity: 0.7" class\x3d"fa fa-6x '+c+'"\x3e\x3c/span\x3e';h.isImage(b.path)&&(c=this.getImageUrl(b),b.icon=c?c:this.config.REPO_URL+"/"+b.path,c="",m="image",e=
'\x3cdiv style\x3d"" class\x3d"tile-content image"\x3e\x3cimg class\x3d"'+c+'" src\x3d"'+b.icon+'"/\x3e\x3c/div\x3e',q=!0);p='\x3cdiv title\x3d"'+(p+"\n"+b.modified)+'" class\x3d"tile-content '+m+'"\x3e'+e+'\x3c/div\x3e\x3cdiv class\x3d"brand opacity"\x3e\x3cspan class\x3d"thumbText text opacity ellipsis" style\x3d""\x3e'+p+"\x3c/span\x3e\x3c/div\x3e";if(q)return d.innerHTML=p,d;d.innerHTML=t?p:'\x3cimg class\x3d"'+c+'" src\x3d"'+b.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+b.name+"\x3c/div\x3e";
return d},renderRow2:function(b){var d=f.create("span",{className:"cell"}),e=!1===b.read&&!1===b.write,w=".."==b.name,t=b&&!!b.directory,q="",p=!1,c="";t?(q=w?"fa fa-level-up fa-5x itemFolder":e?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",p=!0):e?(q="fa fa-lock fa-5x itemFolder",p=!0):h.isImage(b.path)?(e=this.getImageUrl(b),b.icon=e?e:this.config.REPO_URL+"/"+b.path,q="imageFile"):(q="fa fa-5x "+h.getIconClass(b.path),p=!0);c=!0===b.showPath?b.path:b.name;if(p)return d.innerHTML=
'\x3cspan class\x3d"'+q+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name" style\x3d""\x3e'+c+"\x3c/div\x3e",d;d.innerHTML=t?'\x3cspan class\x3d"'+q+'""\x3e\x3c/span\x3e \x3cdiv class\x3d"name"\x3e'+b.name+"\x3c/div\x3e":'\x3cimg class\x3d"'+q+'" src\x3d"'+b.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+b.name+"\x3c/div\x3e";return d},getImageUrl:function(b){var d=this.ctx.getFileManager();if(d&&d){var e=null;this.resizeThumb&&(e={width:this.thumbSize});return d.getImageUrl(b,null,e)}return null}})})},
"xfile/FileActions":function(){define("dcl/dcl xdojo/declare xdojo/has dojo/Deferred xide/utils xide/types xide/factory xide/model/Path xaction/DefaultActions xide/editor/Registry xide/editor/Default dojo/aspect xfile/views/FileOperationDialog xfile/views/FilePreview xide/views/_CIDialog xide/views/_Dialog xide/views/_PanelDialog xfile/views/FilePicker".split(" "),function(n,h,f,e,b,d,v,w,t,q,p,c,m,r,a,g,k,l){function u(){return{includes:["*",".*"],excludes:[],mode:1502}}function y(a,c){var g=c.userData.value||
"./AA/xfile_last/data/su.jpg",m=new e,u=this,r=new k({size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:c.title,onOk:function(){var a=this.picker._selection;a&&a[0]&&(c.set("value",a[0].path),m.resolve(a[0].path),r.value=a[0].path)},onShow:function(a,c){var k=b.addWidget(l,{ctx:u.ctx,owner:u,selection:g||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,mount:u.collection.mount,storeOptionsMixin:{includeList:"*,.*",excludeList:""},
Module:u.Module,permissions:b.clone(u.Module.DEFAULT_PERMISSIONS)},this,c,!0);this.picker=k;this.add(k,null,!1);this.startDfd.resolve();return[this.picker]}});r.show();return m}var x=d.ACTION;c={touch:function(){var c=new e;try{var g=this,k=this.getSelectedItem(),l=this.getCurrentFolder(),m=k?b.pathinfo(k.path,d.PATH_PARTS.ALL).filename:"",u=this.collection,r={inputs:[b.createCI("Name",13,m,{widget:{instant:!0,validator:function(a){return l?null==u.getSync(l.path+"/"+a)&&0<a.length:!0}}})]},p={select:k,
focus:!0,append:!1};(new a({cis:r,title:"Create new File",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto","min-height":"80px"},_onError:function(a,c,g){a=a||this.title;(g=g||this.notificationMessage)&&g.update({message:a+this.failedText+(c?"\x3cbr/\x3e"+c:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(c)},onCancel:function(){c.resolve()},onOk:function(){var a=this.getField("name");if(null==a)c.resolve(p);else{var k=(g.getCurrentFolder()||{path:"."}).path+
"/"+a;g.ctx.getFileManager().mkfile(u.mount,k,{checkErrors:!0,returnProm:!1}).then(function(a){g.runAction(x.RELOAD).then(function(){u.getSync(k)&&c.resolve({select:k,append:!1,focus:!0})})},function(a){c.resolve(p);logError(a,"error creating directory")})}}})).show()}catch(f){logError(f,"error creating dialog")}return c},newTabArgs:null,openInOS:function(a){var c=this.ctx.getResourceManager().getVariable("VFS_CONFIG")||{},g=a.mount.replace("/","");if(c[g]){var k=window.eRequire;k||console.error("have no electron");
var l=k("os"),m=k("electron").shell,k=k("path"),g=c[g],g=b.replaceAll(" ","",g);a=a.path.replace("./","/");a=b.replaceAll("/",k.sep,a);g=k.resolve(g+k.sep+a);g=b.replaceAll(" ","",g);"win32"!==l.platform()?m.openItem(g):m.openItem("file:///"+g)}else console.error("open in os failed: have no VFS config for "+g)},getFileActions:function(a){a=a||this.permissions;var c=[],g=d.ACTION,k=d.ACTION_ICON,l=this,b=l.ctx,m=l.domNode,e=b.getResourceManager();e&&e.getVariable("VFS_CONFIG");l.getActionStore();c.push(l.createAction({label:"Go up",
command:g.GO_UP,icon:k.GO_UP,tab:"Home",group:"Navigation",keycombo:["backspace"],mixin:{quick:!0}}));c.push(l.createAction({label:"Copy",command:g.COPY,icon:"fa-paste",tab:"Home",group:"Organize",keycombo:["f5"],shouldDisable:function(){return null==l.getSelectedItem()}}));c.push(l.createAction({label:"Close",command:g.CLOSE,icon:"fa-close",tab:"View",group:"Organize",keycombo:["ctrl 0"]}));c.push(l.createAction({label:"Move",command:g.MOVE,icon:"fa-long-arrow-right",tab:"Home",group:"Organize",
keycombo:["f6"],shouldDisable:function(){return null==l.getSelectedItem()}}));location.href.indexOf("electron\x3dtrue")||f("electronx");c.push(this.createAction("Open In New Tab","File/OpenInNewTab","fa-share",["alt enter"],"Home","Open","item",null,null,{quick:!0},null,function(){var a=l.getSelectedItem();return a&&a.isDir?!1:!0},a,m,l));if(b&&b.getMountManager&&t.hasAction(a,g.SOURCE)){a.push(g.SOURCE);var u=b.getMountManager().getMounts(),r=0;if(u&&0<u.length){var p=l.collection.mount;c.push(this.createAction({label:"Source",
command:g.SOURCE,icon:"fa-hdd-o",keyCombo:["ctrl f1"],tab:"Home",group:"Navigation",mixin:{data:u,addPermission:!0,quick:!0},onCreate:function(a){a.set("value",p)}}));_.each(u,function(k){var b=k.label;a.push(g.SOURCE+"/"+b);b=l.createAction({label:b,command:g.SOURCE+"/"+b,icon:"fa-hdd-o",keyCombo:["alt f"+r],tab:"Home",group:"Navigation",mixin:{data:u,item:k,closeOnClick:!1,quick:!0},onCreate:function(a){a.set("value",k.name);a._oldIcon=this.icon;a.actionType=d.ACTION_TYPE.SINGLE_TOGGLE}});c.push(b);
r++})}}return c.concat(this.getEditorActions(a))},rename:function(c){var g=new e,k=this,l=c||this.getSelectedItem();c=this.getSelection();var m=this.getCurrentFolder(),u=l?b.pathinfo(l.path,d.PATH_PARTS.ALL).basename:"",r=this.collection,p={select:c,focus:!0,append:!1};c={inputs:[b.createCI("name",d.ECIType.STRING,u,{widget:{instant:!0,title:"New Name",validator:function(a){return null==r.getSync(m.path+"/"+a)&&0<a.length}}})]};(new a({cis:c,title:"Rename",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,
bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){g.resolve(p)},onOk:function(){var a=this.getField("name");if(null==a)g.resolve(p);else{var c=k.getCurrentFolder();k.ctx.getFileManager().rename(l.mount,l.path,a,{checkErrors:!0,returnProm:!1}).then(function(l){k.runAction(x.RELOAD).then(function(){p.select=c.path+"/"+a;g.resolve(p)})},function(a){logError(a,"__error renaming file!");g.resolve(p)})}}})).show();return g},move:function(c){var g=new e,k=this;
c=this.getSelectedItem();var l=this.getSelection(),m=this.getCurrentFolder();c&&b.pathinfo(c.path,d.PATH_PARTS.ALL);var r=this.collection,p={select:l,focus:!0,append:!1};if(!c.directory){var f=c.getParent();f&&(c=f)}c={inputs:[b.createCI("Name",d.ECIType.FILE,c.path,{widget:{instant:!0,title:"Target",validator:function(a){return null==r.getSync(m.path+"/"+a)&&0<a.length}}})]};var v=new a({cis:c,title:k.localize("Move"),ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,onCancel:function(){g.resolve(p)},
onOk:function(){var a=this.getField("name");if(null==a)g.resolve(p);else{var c=k._buildServerSelection(l),m=(a=k.collection.getSync(a))?b.normalizePath(a.mount+"/"+a.path):"";a&&(c.dstPath=m);a=u();k.getCurrentFolder();k.ctx.getFileManager().moveItem(c.selection,c.dstPath,a.includes,a.excludes,a.mode,{checkErrors:!0,returnProm:!1}).then(function(a){k.runAction(x.RELOAD).then(function(){g.resolve(p)})},function(a){logError(a,"__error creating file!");g.resolve(p)})}}});v._on("widget",function(a){a.widget._onSelect=
function(a){return y.apply(k,[v,a])}});v.show();return g},copy:function(c){var g=new e,k=this,l=this.getSelectedItem(),r=this.getSelection(),p=this.getCurrentFolder();l&&b.pathinfo(l.path,d.PATH_PARTS.ALL);var f=this.collection,v={select:r,focus:!0,append:!1};l.directory||(c=l.getParent())&&(l=c);c={inputs:[b.createCI("Name",d.ECIType.FILE,l.path,{widget:{instant:!0,title:"Target",validator:function(a){return null==f.getSync(p.path+"/"+a)&&0<a.length}}})]};var w=new (n([m,a],{}))({cis:c,title:k.localize("Copy"),
ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){g.resolve(v)},onOk:function(){var a=this.getField("name");if(null==a)g.resolve(v);else{this.showMessage();var c=this,m=k._buildServerSelection(r),d=k.collection.getSync(a),e=d?b.normalizePath(d.mount+"/"+d.path):"";m.dstPath=d?e:b.normalizePath(l.mount+"/"+a);k.getCurrentFolder();a=k.ctx.getFileManager().copyItem(m.selection,m.dstPath,u(),{checkErrors:!0,returnProm:!1});
a.then(function(a){c._onSuccess(a)},function(a){c._onError()});a.then(function(a){k.runAction(x.RELOAD).then(function(){g.resolve(v)})},function(a){logError(a,"__error creating file!");g.resolve(v)})}}});w._on("widget",function(a){a.widget._onSelect=function(a){return y.apply(k,[w,a])}});w.show();return g},clipboardPaste:function(){var a=new e,c=this.currentCutSelection,g=c?this.currentCutSelection:this.currentCopySelection,k=this._buildServerSelection(g),c=c?"moveItem":"copyItem",l=this,b={select:g,
focus:!0,append:!1};if(!g)return a.resolve(),a;g=u();l.ctx.getFileManager()[c](k.selection,k.dstPath,{include:g.includes,exclude:g.excludes,mode:g.mode}).then(function(c){l.runAction(d.ACTION.RELOAD).then(function(){a.resolve(b)})},function(c){a.resolve(b)},function(c){a.resolve(b)});return a},mkdir:function(){var c=new e;try{var g=this,k=this.getSelectedItem(),l=this.getCurrentFolder(),m=k?b.pathinfo(k.path,d.PATH_PARTS.ALL).filename:"",u=this.collection,r={inputs:[b.createCI("Name",13,m,{widget:{instant:!0,
validator:function(a){return l?null==u.getSync(l.path+"/"+a)&&0<a.length:!0}}})]},p={select:k,focus:!0,append:!1};(new a({cis:r,title:"Create new Directory",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},_onError:function(a,c,g){a=a||this.title;(g=g||this.notificationMessage)&&g.update({message:a+this.failedText+(c?"\x3cbr/\x3e"+c:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(c)},onCancel:function(){c.resolve()},
onOk:function(){var a=this.getField("name");if(null==a)c.resolve(p);else{var k=(g.getCurrentFolder()||{path:"."}).path+"/"+a;g.ctx.getFileManager().mkdir(u.mount,k,{checkErrors:!0,returnProm:!1}).then(function(a){g.runAction(x.RELOAD).then(function(){u.getSync(k)&&c.resolve({select:k,append:!1,focus:!0})})},function(a){c.resolve(p);logError(a,"error creating directory")})}}})).show()}catch(v){logError(v,"error creating dialog")}return c},_buildServerSelection:function(a,c){!c&&(c=this.getCurrentFolder());
c&&!c.directory&&(c=c.getParent());_.isArray(a)||(a=[a]);var g=[],k=a[0].getStore(),l=c?b.normalizePath(c.mount+"/"+c.path):"";_.each(a,function(a){k.getSync(a.path)&&g.push(b.normalizePath(a.mount+"/"+a.path))});return{selection:g,store:a[0]._S,dstPath:"/"+l+"/",firstItem:a[0],parent:c}},openPreview:function(a,c){var g=this.row(a).element,k=this,l=new e;if(this._preview)return this._preview.item=a,this._preview.open().then(function(){k._preview.preview.trigger($.Event("update",{file:a}))});var b=
new r({node:$(g),item:a,delegate:this.ctx.getFileManager(),parent:$(g),ctx:k.ctx,container:c?c.containerNode:null});c?b.buildRenderingEmbedded():b.buildRendering();b.init();b.exec();this._preview=b;this._preview.handler=this;k._on("selectionChanged",function(a){if(a=k.getSelectedItem())b.item=a,b.preview.trigger($.Event("update",{file:a}))});this.add(b,null,!1);b._emit("changeState",function(c){0===c&&l.resolve({select:a,focus:!0,append:!1})});return l},deleteSelection:function(a){a=a||this.getSelection();
var c=new e,g=this.getNext(a[0],null,!0),k=this.getPrevious(a[0],null,!0),l=g||k,b=this._buildServerSelection(a),u=this;(new m({ctx:u.ctx,notificationMessage:null,title:"Delete "+b.selection.length+" items",type:d.DIALOG_TYPE.DANGER,onBeforeOk:function(){},getOkDfd:function(){var a=this;return this.ctx.getFileManager().deleteItems(b.selection,{hints:[1]},{checkErrors:!1,returnProm:!1,onError:function(c){a._onError(null,c.message)}})},onCancel:function(){c.resolve({select:a,focus:!0,append:!1})},onSuccess:function(){u.runAction(d.ACTION.RELOAD).then(function(){c.resolve({select:l,
focus:!0,append:!1})})}})).show();return c},goUp:function(a){a=this._history.getNow();a=_.isString(a)?this.collection.getSync(a):a;var c=new e,g=this,k=this.getHistory().getNow();if(!a){var l=this.getRows();l[0]&&l[0]._S&&(l=l[0]._S.getParent(l[0]))&&(l=l._S.getParent(l))&&(a=l)}a?(l=a._S.getParent(a))&&(a=this.openFolder(l,!0,!1))&&a.then&&a.then(function(){if(k){var a=g.collection.getSync(k);a&&c.resolve({select:a,focus:!0,delay:1})}}):k?(a=this.collection.getSync(k))&&this.select([a],null,!0,{focus:!0,
delay:1}):(l=this.getRows(),l[0]&&l[0]._S&&(l=l[0]._S.getParent(l[0]))&&(l=l._S.getParent(l))&&this.openFolder(l,!0));return c},reload:function(a){var c=new e,g=this.getSelection();a=a||this.getRows()[0];var k=this.getCurrentFolder()||{path:"."},l=this;k.isBack&&(k=this.collection.getSync(k.rPath));var b=!1;this.isExpanded&&this.expand&&a&&(b=this._isExpanded(a))&&this.expand(a,null,!1);l.collection.resetQueryLog();this.collection.loadItem(k,!0).then(function(a){"."===k&&l.collection.resetQueryLog();
l.refresh().then(function(){var a=l.openItem(k,!1,!1);a&&a.then&&a.then(function(){c.resolve({select:g,append:!1,focus:!0,delay:1})});l.deselectAll();c.resolve({select:g,append:!1,focus:!0,delay:2})})});return c},toHistory:function(a){a=(a.getFolder?new w(a.getFolder()):new w(".")).getSegments();var c=this.collection.rootSegment,g=c;a&&"."===a[0]&&(a[0]=c);var k=[];_.each(a,function(a){a=a!==g?g+(g.endsWith("/")?"":"/")+a:a;k.push(a);g=a});return k},openFolder:function(a,c,g){var k=this.getCurrentFolder(),
l=this.collection,b=this.getHistory();b.getNow();b.getNow();var m=this;(a=_.isString(a)?l.getSync(a):l.getSync(a.path)||a)||(a=l.getRootItem());var d=m.toHistory(a);b.set(d);if(!a)return this.setQueryEx(l.getRootItem());if(!(k&&a&&c&&k.path===a.path)&&a){this.deselectAll();var k=(k=this.row(a))?k.element:null,u;a._S.isItemLoaded(a)||((k=$(k).find("span.fa"))&&k[0]&&(u=$(k[0])),u&&(u.removeClass("fa fa-folder"),u.addClass("fa-spinner fa-spin")));var r=new e;this._emit("openFolder",{item:a,back:c});
(k=this.setQueryEx(a,null))&&k.then(function(){u&&(u.addClass("fa fa-folder"),u.removeClass("fa-spinner fa-spin"));r.resolve({select:!1!==g?c?a:m.getRows()[0]:null,focus:!0,append:!1,delay:1});m._emit("openedFolder",{item:a,back:c})});return r}},changeSource:function(a,c){var g=new e,k=this,l=k.ctx||l,b=l.getFileManager(),m=v.createFileStore(a.name,null,b.config,null,l),d=this.collection,l=this.getAction(x.SOURCE),b=a.label||a.name,u=this.getAction(x.SOURCE+"/"+b);d.destroy();!0!==c&&this._emit("changeSource",
a);this.set("loading",!0);this.set("collection",m.getDefaultCollection());l.set("value",a.name);k.set("title","Files ("+a.label+")");m=l.getChildren();_.each(m,function(a){a.set("icon",a._oldIcon)});l.set("label",b);u&&u.set("icon","fa-spinner fa-spin");this.refresh().then(function(){k.set("loading",!1);u&&u.set("icon","fa-check");!0!==c&&k._emit("changedSource",a);k.select([0],null,!0,{append:!1,focus:!0}).then(function(){g.resolve()})});return g},openInNewTab:function(a){var c=this.ctx,g=c.getWindowManager(),
k=new e,l=null,l=_.isFunction(this.newTarget)?this.newTarget({title:a.name,icon:"fa-folder",target:this._parent,location:null,tabOrientation:null}):g.createTab(a.name,"fa-folder",this.newTarget||this),m=this.collection;a.isDir||(a=this.getCurrentFolder());var d=v.createFileStore(m.mount,m.options,m.config,null,c),c=b.mixin({showToolbar:this.showToolbar,collection:d,selectedRenderer:this.selectedRenderer,showHeader:this.showHeader,newTarget:this.newTarget,style:this.style,options:b.clone(this.options),
permissions:this.permissions,_columns:this._columns,attachDirect:!0,registerEditors:this.registerEditors},this.newTabArgs||{}),u=b.addWidget(this.getClass(),c,null,l,!1);k.resolve();u.set("loading",!0);d.initRoot().then(function(c){(c=d.getItem(a.path,!0))&&c.then(function(){u.startup();u.refresh().then(function(){u.openItem(a).then(function(){u.focus();u.select([0],null,!0,{focus:!0,append:!1,delay:1});u.set("loading",!1)});g.registerView(u,!0)})})});return k},openItem:function(a,c,g){if(!a){var k=
this.getRows();k[0]&&k[0].isBack&&(a=k[0])}if(a&&a.isBack)return a._S=null,this.goUp();if(a=_.isString(a)?this.collection.getSync(a):a){if(!0===a.directory)return this.openFolder(a,c,g);c=q.getEditors(a);return(c=_.find(c,function(a){return!0===a.isDefault}))?c.onEdit(a,this):this.ctx.getWindowManager().openItem(a,this.newTarget||this,{global:!0})}},getSelectedItem:function(){return this.getSelection()[0]},openDefaultEditor:function(a){return p.Implementation.open(a)},close:function(){var a=this._parent;
if(a){var c=a.docker();c&&(this.onAfterAction=null,c.removePanel(a))}return!1},compress:function(a){a=a||this.getSelection();var c=this;(a=this._buildServerSelection(a))&&a.store&&a.selection&&c.ctx.getFileManager().compressItem(a.firstItem.mount,a.selection,"zip").then(function(a){c.reload()})},runAction:function(a,c){_.isString(a)&&(a=this.getAction(a));if(a&&a.command){var g=d.ACTION,k=this.getSelectedItem()||c,l=this.getSelection();if(-1!=a.command.indexOf(x.SOURCE))return this.changeSource(a.item);
switch(a.command){case "File/Compress":return this.compress(l);case g.PREVIEW:return this.openPreview(k);case "File/OpenInNewTab":return this.openInNewTab(k||this.collection.getRootItem());case g.EDIT:return this.openItem(k);case g.NEW_FILE:return this.touch(k);case g.NEW_DIRECTORY:return this.mkdir(k);case g.RELOAD:return this.reload(k);case g.RENAME:return this.rename(k);case g.GO_UP:return this.goUp(null);case g.COPY:return this.copy(null);case g.MOVE:return this.move(null);case g.DELETE:return this.deleteSelection(null);
case g.OPEN_IN+"/Default Editor":return this.openDefaultEditor(k);case g.DOWNLOAD:return this.ctx.getFileManager().download(k);case g.CLOSE:return this.close();case "File/OpenInOS":return this.openInOS(k)}return-1!=a.command.indexOf(g.OPEN_IN+"/")?a.editor.onEdit(k):this.inherited(arguments)}},getEditorActions:function(a){function c(a){function g(a,c){c.handler=function(){a.onEdit(e.getSelection()[0])}}function k(a){a=q.getEditors(a)||[];for(var c=[],l=0;l<a.length;l++){var b=a[l];if("Default Editor"!==
b.name){var d=e.createAction(b.name,u.OPEN_IN+"/"+b.name,b.iconClass,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",editor:b,custom:!0},null,null,m,r,e);g(b,d);c.push(d)}}return c}var l=a.selection;if(l&&l[0]){var b=l[0],m=this.permissions,u=d.ACTION,e=this,r=e.domNode,p=e.getActionStore(),l=this.getContextMenu();"deselect"!=a.why&&(p.getSync(d.ACTION.OPEN_IN),a=e.addActions(k(b)),this._lastEditorActions&&(_.each(this._lastEditorActions,function(a){p.removeSync(a.command)}),
delete this._lastEditorActions),l&&l.removeCustomActions(),0<a.length&&(a=this.addActions(a),p._emit("onActionsAdded",a),this._lastEditorActions=a))}}a=a||this.permissions;var g=[],k=d.ACTION,l=d.ACTION_ICON,b=this,m=b.domNode;b.getActionStore();var u=null;this._selHandle||(this._selHandle=this._on("selectionChanged",function(a){c.apply(b,[a])}));u=this.createAction("Open In",k.OPEN_IN,l.EDIT,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",onCreate:function(a){}},null,t.shouldDisableDefaultFileOnly,
a,m,b);g.push(u);a=b.createAction("Default Editor",k.OPEN_IN+"/Default Editor","fa-code",null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",forceSubs:!0},null,null,a,m,b);g.push(a);return g}};h=h("xfile.FileActions",null,c);h.Implementation=c;h.createFilePicker=function(a,c,g,m,u,e,r,p){(new k({size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:m,onOk:function(){var a=this.picker._selection;a&&a[0]&&
(g(a[0]),r&&r.resolve(a[0],a,this.picker))},onShow:function(g,k){var m=b.addWidget(l,b.mixin({ctx:a.ctx,owner:a,selection:c||"./AA/xfile_last/data/su.jpg",resizeToParent:!0,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:p,permissions:u||b.clone(d.DEFAULT_FILE_GRID_PERMISSIONS)},e),this,k,!0);this.picker=m;this.add(m);this.startDfd.resolve();return[this.picker]}})).show();return r};return h})},"xfile/views/FileOperationDialog":function(){define(["dcl/dcl","xide/types","xide/views/_Dialog"],
function(n,h,f){return n(f,{title:"",type:h.DIALOG_TYPE.INFO,size:h.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{},failedText:" Failed!",successText:": Success!",showSpinner:!0,spinner:'  \x3cspan class\x3d"fa-spinner fa-spin"/\x3e',notificationMessage:null,doOk:function(e){this.onBeforeOk&&this.onBeforeOk();this.showMessage();var b=this;e.then(function(d){b._onSuccess(d)},function(d){b._onError()})},_onSuccess:function(e,b,d){e=e||this.title;(d=d||this.notificationMessage)&&d.update({message:e+this.successText+
(b?"\x3cbr/\x3e"+b:""),type:"info",actions:!1,duration:1500});this.onSuccess&&this.onSuccess()},_onError:function(e,b,d){e=e||this.title;(d=d||this.notificationMessage)&&d.update({message:e+this.failedText+(b?"\x3cbr/\x3e"+b:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(b)},onOk:function(){this.showMessage();this.doOk(this.getOkDfd())},showMessage:function(e){if(this.notificationMessage)return this.notificationMessage;e=e||this.title;return this.notificationMessage=e=this.ctx.getNotificationManager().postMessage({message:e+
(this.showSpinner?this.spinner:""),type:"info",showCloseButton:!0,duration:4500})}})})},"xfile/views/FilePreview":function(){define("dcl/dcl xide/types xide/utils xide/mixins/EventedMixin xide/widgets/_Widget dojo/cache dojo/Deferred dijit/registry xide/editor/Default xaction/DefaultActions".split(" "),function(n,h,f,e,b,d,v,w,t,q){var p=[function(c){var b=["image/jpeg","image/png","image/gif"],d=c.preview;$.each(navigator.mimeTypes,function(a,c){var k=c.type;0===k.indexOf("image/")&&$.inArray(k,
b)&&b.push(k)});d.bind("update",function(a){var g=a.file,k;c.opened()&&-1!==$.inArray(g.mime,b)&&(a.stopImmediatePropagation(),a=null,c.resizeToPreview&&(a={width:d.width()}),k=$("\x3cimg/\x3e").hide().appendTo(d).load(function(){setTimeout(function(){var a=(k.width()/k.height()).toFixed(2);d.bind("changesize",function(){var c=parseInt(d.width()),g=parseInt(d.height()),b;a<(c/g).toFixed(2)?(b=g,c=Math.floor(b*a)):b=Math.floor(c/a);k.width(c).height(b).css("margin-top",b<g?Math.floor((g-b)/2):0)}).trigger("changesize");
c.hideinfo();k.fadeIn(100)},1)}),k.attr("src",c.fm.url(g,null,a)))})},function(c){var b=["text/html","application/xhtml+xml"],d=c.preview;d.bind("update",function(a){var g=a.file;c.opened()&&-1!==$.inArray(g.mime,b)&&(a.stopImmediatePropagation(),c.ctx.getFileManager().getContent(g.mount,g.path,function(a){c.hideinfo();doc=$('\x3ciframe class\x3d"elfinder-quicklook-preview-html"/\x3e').appendTo(d)[0].contentWindow.document;doc.open();doc.write(a);doc.close()}))})},function(c){var b=c.preview,d="application/x-empty application/javascript application/xhtml+xml audio/x-mp3-playlist application/x-web-config application/docbook+xml application/x-php application/x-perl application/x-awk application/x-config application/x-csh application/xml application/x-empty text/html text/x-c text/x-php text/plain text/x-c++ text/x-lisp".split(" ");
b.bind("update",function(a){var g=a.file,k=g.mime;if(c.opened()&&(0===k.indexOf("text/")||-1!==$.inArray(k,d))&&(a.stopImmediatePropagation(),c.useAce)){c.hideinfo();a=$('\x3cdiv class\x3d"elfinder-quicklook-preview-text-wrapper"\x3e\x3c/div\x3e');a.appendTo(b);var l=c._editor,k=l;if(!l&&(l=t.Implementation.open(g,a[0],c.editorOptions,!1,c),c._editor=l,c.add(l,null,!1),q.hasAction(c.editorOptions.permissions,h.ACTION.TOOLBAR))){var u=l.getToolbar();u&&$(u.domNode).addClass("bg-opaque")}k&&(a.append(l.domNode),
l.set("item",g));b.bind("changesize",function(){parseInt(b.width());parseInt(b.height());f.resizeTo(l.domNode,b[0],!0,!0);l.resize()})}})},function(c){var b=c.preview,d=!1,d=!1;$.each(navigator.plugins,function(a,c){$.each(c,function(a,c){if("application/pdf"==c.type)return!(d=!0)})});d&&b.bind("update",function(a){var g=a.file,k;c.opened()&&"application/pdf"==g.mime&&(a.stopImmediatePropagation(),b.one("change",function(){k.unbind("load").remove()}),k=$('\x3ciframe class\x3d"elfinder-quicklook-preview-pdf"/\x3e').hide().appendTo(b).load(function(){c.hideinfo();
k.show()}).attr("src",c.fm.url(g)))})},function(c){var b=c.fm,d=c.preview,a=!1;$.each(navigator.plugins,function(c,k){$.each(k,function(c,g){if("application/x-shockwave-flash"==g.type)return!(a=!0)})});a&&d.bind("update",function(a){var k=a.file;c.opened()&&"application/x-shockwave-flash"==k.mime&&(a.stopImmediatePropagation(),c.hideinfo(),d.append($('\x3cembed class\x3d"elfinder-quicklook-preview-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer" src\x3d"'+b.url(k)+'" quality\x3d"high" type\x3d"application/x-shockwave-flash" /\x3e')))})},
function(c){var b=c.preview,d=!!c.options.autoplay,a={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},g;b.bind("update",function(k){if(c.opened()){var l=k.file;c.support.audio[a[l.mime]]&&(k.stopImmediatePropagation(),g=$('\x3caudio class\x3d"elfinder-quicklook-preview-audio" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(l)+'" /\x3e\x3c/audio\x3e').appendTo(b),d&&g[0].play())}}).bind("change",function(){g&&g.parent().length&&(g[0].pause(),g.remove(),g=null)})},function(c){var b=c.preview,d=!!c.options.autoplay,a={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},g;b.bind("update",function(k){if(c.opened()){var l=k.file;c.support.video[a[l.mime]]&&(k.stopImmediatePropagation(),c.hideinfo(),g=$('\x3cvideo class\x3d"elfinder-quicklook-preview-video" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(l)+'" /\x3e\x3c/video\x3e').appendTo(b),d&&g[0].play())}}).bind("change",function(){g&&g.parent().length&&(g[0].pause(),g.remove(),g=null)})},function(c){var b=c.preview,d=[],a;c.opened()&&($.each(navigator.plugins,function(a,c){$.each(c,function(a,c){0!==c.type.indexOf("audio/")&&0!==c.type.indexOf("video/")||d.push(c.type)})}),b.bind("update",function(g){if(c.opened()){var k=g.file,l=k.mime;-1!==$.inArray(k.mime,d)&&(g.stopImmediatePropagation(),(g=0===l.indexOf("video/"))&&c.hideinfo(),
a=$('\x3cembed src\x3d"'+c.fm.url(k)+'" type\x3d"'+l+'" class\x3d"elfinder-quicklook-preview-'+(g?"video":"audio")+'"/\x3e').appendTo(b))}}).bind("change",function(){a&&a.parent().length&&(a.remove(),a=null)}))}];e=n([b.dcl,e.dcl],{resizeToPreview:!0,useAce:!0,registerEditors:!1,editorPermissions:[],container:null,destroy:function(){this.window.empty();f.destroy(this.window[0]);this.inherited(arguments)},init:function(){var c=this.options={autoplay:!0,jplayer:"extensions/jplayer",ui:"button"},b=this,
d=this.window,a=this.preview,g=this.container;width=0<c.width?parseInt(c.width):450;height=0<c.height?parseInt(c.height):300;g||d.appendTo("body").zIndex(20);$(document).keydown(function(a){27==a.keyCode&&b.opened()&&d.trigger("close")});!g&&$.fn.resizable&&d.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){a.trigger("changesize")}});$.each(p||[],function(a,c){"function"==typeof c&&new c(b)});a.bind("update",function(){b.info.show()})},buildRenderingEmbedded:function(){var c=this,
b=this.navicon,d=this.container?$(this.container):null;$('\x3cdiv class\x3d"elfinder-quicklook-title" style\x3d"display: none"\x3e'+c.title+"\x3c/div\x3e");var a=$("\x3cdiv/\x3e"),g=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new v;c.fsicon=$('\x3cdiv class\x3d"'+b+" "+b+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(a){var g=c.window,d=g.is("."+c.fullscreen),e=$(window);a.stopPropagation();d?(g.css(g.data("position")).unbind("mousemove"),e.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),
c.navbar.unbind("mouseenter").unbind("mousemove")):(g.data("position",{left:g.css("left"),top:g.css("top"),width:g.width(),height:g.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){g.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(a){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),g.bind("mousemove",function(a){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),
c.navbar.mouseenter(function(){c.navbar.stop(!0,!0).show()}).mousemove(function(a){a.stopPropagation()}));c.navbar.attr("style","").draggable(d?"destroy":{});g.toggleClass(c.fullscreen);$(this).toggleClass(b+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"" style\x3d"display: none;"/\x3e');c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(k){c.info.attr("style","").hide();a.removeAttr("class").attr("style","");
g.html("")}).bind("update",function(a){var g=a.file;g?(!g.read&&a.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):a.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(a).append(g);c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d""/\x3e').click(function(a){a.stopPropagation()}).append(c.preview).append(c.info.hide()).bind("open",
function(a){c._open=!0;a=c.window;var g=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,g&&g.trigger("scrolltoview"),a.css(c.closedCss(g)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(a){var g=c.window,b=c.preview.trigger("change");a={};var d=function(){c._open=!1;c.state=0;g.hide();b.children().remove();c.update(0,c.value)};c.opened()&&(state=1,g.is("."+c.fullscreen)&&c.fsicon.mousedown(),a.length?
g.animate(c.closedCss(a),500,d):d())});d&&(console.error("container!"),d.append(c.window));d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},buildRendering:function(){var c=this,b=this.navicon,
d=this.container?$(this.container):null,a=$('\x3cdiv class\x3d"elfinder-quicklook-title"\x3e'+c.title+"\x3c/div\x3e"),g=$("\x3cdiv/\x3e"),k=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new v;c.fsicon=$('\x3cdiv class\x3d"'+b+" "+b+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(a){var g=c.window,k=g.is("."+c.fullscreen),d=$(window);a.stopPropagation();k?(g.css(g.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),c.navbar.unbind("mouseenter").unbind("mousemove")):
(g.data("position",{left:g.css("left"),top:g.css("top"),width:g.width(),height:g.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){g.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(a){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),g.bind("mousemove",function(a){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),c.navbar.mouseenter(function(){c.navbar.stop(!0,
!0).show()}).mousemove(function(a){a.stopPropagation()}));c.navbar.attr("style","").draggable(k?"destroy":{});g.toggleClass(c.fullscreen);$(this).toggleClass(b+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"elfinder-quicklook-navbar"/\x3e').append($('\x3cdiv class\x3d"'+b+" "+b+' fa-2x fa-arrow-left"/\x3e').mousedown(function(){c.navtrigger(37)})).append(c.fsicon).append($('\x3cdiv class\x3d"'+b+" "+b+' fa-2x fa-arrow-right"/\x3e').mousedown(function(){c.navtrigger(39)})).append('\x3cdiv class\x3d"elfinder-quicklook-navbar-separator"/\x3e').append($('\x3cdiv class\x3d"'+
b+" "+b+'-close"/\x3e').mousedown(function(){c.window.trigger("close")}));c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(a){c.info.attr("style","").hide();g.removeAttr("class").attr("style","");k.html("")}).bind("update",function(a){var g=a.file;g?(!g.read&&a.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):a.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(g).append(k);
c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d"position:absolute"/\x3e').click(function(a){a.stopPropagation()}).append($('\x3cdiv class\x3d"elfinder-quicklook-titlebar"/\x3e').append(a).append($('\x3cspan class\x3d"fa-close" style\x3d"margin-left: 4px; color: white; font-size: 16px; text-align: center; position: absolute; left: 0px; top: 2px;"/\x3e').mousedown(function(a){a.stopPropagation();c.window.trigger("close")}))).append(c.preview.add(c.navbar)).append(c.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",
function(a){c._open=!0;a=c.window;var g=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,g.trigger("scrolltoview"),a.css(c.closedCss(g)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(a){var g=c.window,k=c.preview.trigger("change");a={};var b=function(){c._open=!1;c.state=0;g.hide();k.children().remove();c.update(0,c.value)};c.opened()&&(state=1,g.is("."+c.fullscreen)&&c.fsicon.mousedown(),a.length?
g.animate(c.closedCss(a),500,b):b())});d&&(console.error("container!"),d.append(c.window));d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},constructor:function(c){f.mixin(this,c)},editorOptions:{permissions:[h.ACTION.TOOLBAR,
h.ACTION.RELOAD,"Editor/Settings","View/Increase Font Size","View/Decrease Font Size","View/Themes","File/Search"]},title:"Preview",width:450,height:300,fm:null,state:0,navicon:"elfinder-quicklook-navbar-icon",fullscreen:"elfinder-quicklook-fullscreen",parent:null,cwd:null,resize:"resize.elfinder-finder",alwaysEnabled:!0,value:null,handlers:{select:function(){this.update(void 0,this.fm.selectedFiles()[0])},error:function(){self.window.is(":visible")&&self.window.data("hash","").trigger("close")},
"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}},shortcuts:[{pattern:"space"}],navtrigger:function(c){$(document).trigger($.Event("keydown",{keyCode:c,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1}))},closedCss:function(c){return{opacity:0,width:20,height:20,top:c?c.offset().top+"px":0,left:c?c.offset().left+"px":0}},openedCss:function(){var c=this.container?$(this.container):null,b=c||$(window),d=c?"100%":Math.min(this.width,b.width()-10),c=c?"100%":Math.min(this.height,
b.height()-80);return{opacity:1,width:d,height:c,top:parseInt((b.height()-c-60)/2+b.scrollTop()),left:parseInt((b.width()-d)/2+b.scrollLeft())}},supportTest:function(c){var b=document.createElement(c.substr(0,c.indexOf("/"))),d=!1;try{d=b.canPlayType&&b.canPlayType(c)}catch(a){}return d&&""!==d&&"no"!=d},changeView:function(c){this.currentView&&(f.destroy(this.currentView),this.currentView.destroy&&this.currentView.destroy())},update:function(c){this._open=c;this._emit("changeState",c);if(1==c&&this.onAnimate)this.onAnimate();
if(2==c&&this.onOpened)this.onOpened();if(0==c&&this.onClosed)this.onClosed()},closed:function(){return 0==this.state},opened:function(){return 2==this.state},bind:function(c,b){var d;if("function"==typeof b)for(c=(""+c).toLowerCase().split(/\s+/),d=0;d<c.length;d++)void 0===listeners[c[d]]&&(listeners[c[d]]=[]),listeners[c[d]].push(b);return this},one:function(c,b){var d=this,a=$.proxy(b,function(c){setTimeout(function(){d.unbind(c.type,a)},3);return b.apply(this,arguments)});return this.bind(c,
a)},open:function(c){var b=this;c=b.window;var d=b.node;b._open=!0;b.openDfd=new v;b.closed()?(b.navbar.attr("style",""),b._open=!0,b.state=1,d&&d.trigger("scrolltoview"),c.css(b.closedCss(d)).show().animate(b.openedCss(),550,function(){b.state=2;b.update(1,b.value);b.openDfd.resolve()})):b.openDfd.resolve();return b.openDfd},close:function(c){this._open=!1;var b=this,d=b.window,a=b.preview.trigger("change");c=b.node;var g=function(){b.state=0;d.hide();a.children().remove();b.update(0,b.value);b.closeDfd&&
b.closeDfd.resolve()};b.opened()&&(b.state=1,d.is("."+b.fullscreen)&&b.fsicon.mousedown(),c&&c.length?d.animate(b.closedCss(c),500,g):g());return b.closeDfd},getstate:function(){return 2==this.state?1:0},exec:function(){this.window.trigger(this.opened()?"close":"open")},hideinfo:function(){this.info.stop(!0).hide()}});e=n(e,{destroy:function(){this.close();this.preview.trigger($.Event("update",{file:null}));this.inherited(arguments);f.destroy(this._editor);f.destroy(this.preview);f.destroy(this.window)},
onOpened:function(){var c=this;c.fm={url:function(b,d,a){return c.delegate.getImageUrl(b,d,a)}};c.preview.trigger($.Event("update",{file:c.item}))},onClosed:function(){},onAnimate:function(){}});n=n(e,{resize:function(){this.preview.trigger("changesize")},constructor:function(c){this.parent=$(c._parent.containerNode);this.container=c._parent.containerNode;this.resizeToParent=!0;this.delegate=c.ctx.getFileManager();this.item=c.item},openItem:function(c){this.id=f.createUUID();w.add(this);this.item=
c||this.item;this.buildRenderingEmbedded();this.init();this.exec();this.window.css({height:"100%",width:"100%"});this._parent.add(this,null,!1);this.preview.trigger($.Event("update",{file:this.item}));this._parent.resize();this.resize()}});e.EditorClass=n;return e})},"xfile/views/FilePicker":function(){define("dcl/dcl xide/types xide/utils xide/factory module xide/_base/_Widget xdocker/Docker2 xfile/ThumbRenderer dojo/promise/all xfile/Breadcrumb".split(" "),function(n,h,f,e,b,d,v,w,t,q){return n(d,
{declaredClass:"xfile.views.FilePicker",templateString:'\x3cdiv class\x3d"FilePicker"\x3e\x3c/div\x3e',resizeToParent:!0,docker:null,dockerOptions:{resizeToParent:!0},breadcrumb:null,leftStore:null,rightStore:null,storeOptionsMixin:null,storeOptions:null,leftGrid:null,leftGridArgs:null,rightGrid:null,rightGridArgs:null,removePermissions:[h.ACTION.OPEN_IN_TAB],defaultGridArgs:{registerEditors:!1,_columns:{Name:!0,Path:!1,Size:!1,Modified:!1}},selection:null,mount:"root",_selection:null,getDocker:function(){if(this.docker)return this.docker;
var b=this.dockerOptions||{resizeToParent:!0},b=this.docker||v.createDefault(this.domNode,b);b.resizeToParent=!0;this.add(b,null,!1);return this.docker=b},createLayout:function(){var b=this.getDocker();this.layoutTop=b.addPanel("DefaultFixed",h.DOCKER.DOCK.TOP,null,{h:50,title:!1});this.layoutTop._minSize.y=50;this.layoutTop._maxSize.y=50;this.layoutTop._scrollable={x:!1,y:!1};this.breadcrumb=f.addWidget(q,{},null,this.layoutTop,!0);this.layoutLeft=b.addPanel("DefaultFixed",h.DOCKER.DOCK.BOTTOM,null,
{w:100,title:!1});this.layoutLeft._minSize.x=150;this.layoutLeft.moveable(!0);this.layoutMain=b.addPanel("DefaultFixed",h.DOCKER.DOCK.RIGHT,this.layoutLeft,{w:"70%",title:!1});this.layoutTop.initSize(100,"100%");this.layoutLeft.initSize("100%",150);b.resize()},setSelection:function(b){this._selection=b},connectGrids:function(b,c){var d=this;c._on("selectionChanged",function(b){"deselect"!==b.why&&(b=c.getSelection(),c.getSelectedItem()&&d.setSelection(b))});b._on("selectionChanged",function(e){e=
b.getSelection();var a=b.getSelectedItem();a||(a=b.getCurrentFolder());if(a){var g=null;a.directory?g=a:(a.getParent||console.error("item has no item.getParent!"),g=a.getParent?a.getParent():null);g&&c.openFolder(g.path,!1);a&&d.setSelection(e)}})},createFileGrid:function(b,c,d){return this.Module.createDefault(this.ctx,d,c,!1,!0,b)},onLeftGridReady:function(b){},onRightGridReady:function(b){},onError:function(b,c){},startGrids:function(b,c){var d=this,e=b.collection,a=c.collection,g={focus:!0,append:!1},
k=[b.refresh(),c.refresh()],l=this.selection,u=f.pathinfo(l,h.PATH_PARTS.ALL).dirname||"";"."===u&&(u=l);b.showStatusbar&&b.showStatusbar(!1);b._on("changeSource",function(a){c.changeSource(a,!0)});b._on("changedSource",function(a){b.select([0],null,!0,g)});c._on("changeSource",function(a){b.changeSource(a,!0)});c._on("changedSource",function(a){b.select([0],null,!0,g)});t(k).then(function(){d.onLeftGridReady(b);d.onRightGridReady(c);d.getDocker().resize();t([e.getItem(u,!0),a.getItem(u,!0)]).then(function(a){t(_.invoke([b],
"openFolder",u)).then(function(){t(_.invoke([b,c],"select",[l],null,!0,g)).then(function(){l._selection=l;d.connectGrids(b,c);d.setupBreadcrumb(b,c,l)},function(a){d.onError(a,"selecting items")})},function(a){d.onError(a,"open folder")})},function(a){d.onError(a,"loading items")})},function(a){d.onError(err,"refresh grid")})},setupBreadcrumb:function(b,c,d){function e(c,b,k){a.grid!=k&&a.setSource(k);a.clear();a.setPath(".",g.getRootItem(),b.getPath(),c)}var a=this.breadcrumb;b.getCurrentFolder();
var g=b.collection,k=c.collection;a.setSource(b);this.addHandle("click",b.on("click",function(){a.setSource(b)}));this.addHandle("click",c.on("click",function(){a.setSource(c)}));b._on("openFolder",function(a){e(g,a.item,b)});c._on("openFolder",function(a){e(k,a.item,c)})},destroy:function(){f.destroy(this.leftStore);f.destroy(this.rightStore);f.destroy(this.leftGrid);f.destroy(this.rightGrid);f.destroy(this.breadcrumb);f.destroy(this.docker)},startup:function(){this.createLayout();var b=this.layoutLeft,
c=this.layoutMain,d=this.ctx,v=d.config,a=this.mount||"root",g=this.storeOptions,k=this.storeOptionsMixin||{includeList:"*.jpg,*.png",excludeList:"*"},l=this.leftStore||e.createFileStore(a,g,v,k,d),d=this.rightStore||e.createFileStore(a,g,v,k,d),a=this.layoutMain,v=f.mixin({},f.clone(this.defaultGridArgs)),u=this.removePermissions,a=f.mixin(v,this.leftGridArgs||{newTarget:a});_.remove(a.permissions,function(a){return-1!==_.indexOf(u,a)});this.leftGrid=b=this.leftGrid||this.createFileGrid(l,b,a);l=
f.mixin(v,this.rightGridArgs||{selectedRenderer:w});_.remove(l.permissions,function(a){return-1!==_.indexOf(u,a)});this.rightGrid=c=this.rightGrid||this.createFileGrid(d,c,l);return this.startGrids(b,c)}})})},"xfile/Breadcrumb":function(){define(["dcl/dcl","xide/widgets/TemplatedWidgetBase","xide/model/Path","xide/_base/_Widget"],function(n,h,f,e){return n(e,{templateString:"\x3cul attachTo\x3d'root' style\x3d'-webkit-app-region:drag' class\x3d'breadcrumb'\x3e\x3c/ul\x3e",grid:null,destroy:function(){this.clear();
this.grid=null},setSource:function(b){if(this.grid!=b){this.grid=b;var d=b.collection;this.clear();var e=b.getBreadcrumbPath?b.getBreadcrumbPath():null;!1!==e&&(e?this.setPath(e.root,null,e,null):d&&b.getCurrentFolder&&(b=(b=b.getCurrentFolder())?b.path:"",this.setPath(".",d.getRootItem(),b,d)))}},setPath:function(b,d,e,w,h){this.clear();d&&b&&this.addSegment(b,!0,d);b=(new f(e)).getSegments();var q=h||".";_.each(b,function(b){var c=q+"/"+b;this.addSegment(b,!0,w?w.getSync(c):null);q=c},this)},onClick:function(b,
d,e){this._emit("click",{element:e,event:d,label:b,data:e.data})},addSegment:function(b,d,e){if(e&&this.has(e))return null;var f=this;b=$("\x3cli class\x3d'"+(d?"active":"")+"'\x3e\x3ca href\x3d'#'\x3e"+b+"\x3c/a\x3e\x3c/li\x3e");_.each(this.all(),function(b){b.el.removeClass("active")});$(this.domNode).append(b);e&&(b.on("click",function(b){f.grid&&f.grid.openFolder(e)}),b[0].data=e);return b},pop:function(){this.last().remove()},last:function(){return $(this.root).children().last()},has:function(b){for(var d=
this.all(),e=0;e<d.length;e++)if(d[e].data.path===b.path)return!0;return!1},all:function(){var b=[];_.each(this.$root.children(),function(d){b.push({el:$(d),label:d.outerText,data:d.data})});return b},clear:function(){for(var b=this.all();b.length;){var d=b[b.length-1];d.el.remove();d.data=null;b.remove(d)}},unwind:function(b){var d=this.all().reverse();_.each(d,function(d){d.data&&d.data.path!==(b&&b.path)&&"."!==d.data.path&&this.pop()},this)},startup:function(){this._on("click",function(b){b=b.element[0].data;
var d=this.grid;b&&(this.unwind(b),d&&d.openFolder(b))}.bind(this))}})})},"xfile/Statusbar":function(){define(["xdojo/declare","xide/types","xfile/Breadcrumb"],function(n,h,f){return n("xgrid.Statusbar",null,{statusbar:null,setState:function(e){this.showStatusbar(e.statusBar);return this.inherited(arguments)},getState:function(e){e=this.inherited(arguments)||{};e.statusBar=null!=this.statusbar;return e},runAction:function(e){e.command==h.ACTION.STATUSBAR&&this.showStatusbar(this.statusbar?!1:!0);
return this.inherited(arguments)},showStatusbar:function(e,b){!e&&this.statusbar?this._destroyStatusbar():e&&this.getStatusbar();this.resize();this._statusbarAction&&!0!==b&&this._statusbarAction.set("value",e)},_destroyStatusbar:function(){this.statusbarRoot&&this.statusbarRoot.remove();this.statusbarRoot=this.statusbar=null},_statusbarAction:null,buildRendering:function(){this.inherited(arguments);var e=this;this._on("onAddActions",function(b){var d=b.actions,f=h.ACTION.STATUSBAR;b.store.getSync(f)||
(b=e.createAction({label:"Statusbar",command:f,icon:h.ACTION_ICON.STATUSBAR,tab:"View",group:"Show",mixin:{actionType:"multiToggle"},onCreate:function(b){b.set("value",null!==e.statusbar);e._statusbarAction=b},onChange:function(b,d,f){e.showStatusbar(d,!0)}}),d.push(b))})},getStatusbar:function(){return this.statusbar?this.statusbar:this.createStatusbar()},onRenderedStatusBar:function(e,b,d){e=this.__bc;!e&&b&&b.append&&(e=new f({},$("\x3cdiv\x3e")),b.append(e.domNode),$(e.domNode).css({"float":"right",
padding:0,"margin-right":10,top:0,right:50,position:"absolute"}),this.__bc=e,e.setSource(this));e&&(e.clear(),b=this.collection,d=(d=this.getCurrentFolder())?d.path:"",e.setPath(".",b.getRootItem(),d,b))},onStatusbarCollapse:function(e){},createStatusbar:function(e){e=e=this.footer;var b=this.statusbar,d=this;if(!b){var f=$('\x3cdiv class\x3d"statusbar widget" style\x3d"width:inherit;padding: 0;margin:0;padding-left: 4px;"\x3e\x3c/div\x3e')[0];e.appendChild(f);b=$('\x3cdiv class\x3d"status-bar-text ellipsis" style\x3d"display: inline-block;"\x3e0 items selected\x3c/div\x3e')[0];
f.appendChild(b);var h=$('\x3cdiv class\x3d"status-bar-collapser fa-caret-up" style\x3d"" \x3e\x3c/div\x3e');h.click(function(b){d.onStatusbarCollapse(h)});e=h[0];f.appendChild(e);this.statusbar=b;this.statusbarCollapse=e;this.statusbarRoot=f;this._emit("createStatusbar",{root:f,statusbar:b,collapser:e})}return b},startup:function(){function e(b){if(0==b)return"0 Byte";var d=parseInt(Math.floor(Math.log(b)/Math.log(1024)));return Math.round(b/Math.pow(1024,d),2)+" "+["Bytes","KB","MB","GB","TB"][d]}
function b(b){var d=0,f="0 KB";_.each(b,function(b){d+=b.sizeBytes||0});0<d&&(f=e(d));return{bytes:d,sizeStr:f}}this.inherited(arguments);if(this.hasPermission(h.ACTION.STATUSBAR)){var d=this.getStatusbar(),f=this;d&&this._on("selectionChanged",function(e){var h=e.selection||[];e=h.length;h=b(h);e=e+"  "+f.localize("selected")+" ("+h.sizeStr+")";d.innerHTML=e;if(f.onRenderedStatusBar)f.onRenderedStatusBar(d,f.statusbarRoot,e)})}}})})},"xfile/views/UploadMixin":function(){define(["xdojo/declare","xide/utils",
"xide/types","dojo/promise/all"],function(n,h,f,e){return n("xfiles.views.UploadMixin",null,{cssClass:"uploadFilesList droparea dropareaHover",__currentDragOverRow:null,__currentDragOverTimer:null,__currentDragOverTimeRow:null,buildRendering:function(){this.inherited(arguments);$(this.domNode).addClass(this.cssClass)},_createUploadItemTemplate:function(b,d,e){return'\x3cdiv class\x3d"" style\x3d"position: relative;margin: 0.1em;height: auto"\x3e\x3cdiv style\x3d"margin:0;vertical-align: middle;padding: 1px;" class\x3d"progress" role\x3d"progressbar" aria-valuemin\x3d"0" aria-valuemax\x3d"100"\x3e\x3cdiv class\x3d"progress-bar progress-bar-info" style\x3d"width:'+
d+';background-color: rgba(102, 161, 179, 0.35);height:auto;magin:0;"\x3e\x3cspan class\x3d"'+(e.failed?"text-danger":"text-info")+'" style\x3d"left: 0px"\x3e'+b+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},_createUploadItems:function(b){function d(b){var c={sizeBytes:h.humanFileSize(b.size),size:h.humanFileSize(b.size),name:b.name,type:b.type,path:t.path+"/"+b.name+"__uploading__"+Math.random(2),isDir:!1,mount:t.mount,parent:t.path,progress:0,isUpload:!0,modified:b.lastModified/1E3,renderColumn:function(c,
b,a){if("name"===c)return e._createUploadItemTemplate(a.name,a.progress+"%",a);if("sizeBytes"===c&&100>a.progress)return h.humanFileSize(a.loaded)+" of "+h.humanFileSize(a.total)}};f.putSync(c);c=f.getSync(c.path);return b._item=c}var e=this,f=this.collection,t=this.getCurrentFolder();this.__currentDragOverRow&&(t=this.__currentDragOverRow.data);var q=[];_.each(b,function(b){q.push(d(b))});return q},_onAllUploaded:function(b){b=this._toUploadItems(b);var d=this;_.each(b,function(b){var d=b._store?
b:b._item;d&&(d.progress=d.failed?0:100,d.refresh(),setTimeout(function(){d.remove()},1))});setTimeout(function(){d.runAction(f.ACTION.RELOAD).then(function(){})},1)},_onBrowserFilesDropped:function(b,d,e){var f=this.ctx.getFileManager(),h=b.getCurrentFolder();this.__currentDragOverRow&&(h=this.__currentDragOverRow.data);this._createUploadItems(d);return f.upload(d,h.mount,h?h.path:"./tmp",b,e)},_onUploadFailed:function(b){b&&(b.failed=!0,b.done=!0)},_onSomeFileUploaded:function(b){var d=this;b&&
(b.progress=100,b.done=!0,b.renderColumn=null,b.renderRow=null,b.refresh(),setTimeout(function(){d.runAction(f.ACTION.RELOAD).then(function(){});b.remove()},1));return!0},_toUploadItems:function(b){var d=[];_.each(b,function(b){_.each(b,function(b){d.push(b)})});return d},_toUploadStoreItem:function(b){return b.file._item},onBrowserFilesDropped:function(b,d){function f(){var c=0;_.each(q,function(b){b.done&&c++});c==q.length&&t._onAllUploaded(d)}var h=this._onBrowserFilesDropped(this,d,b),t=this,
q=t._toUploadItems(d),p=1==q.length;e(h).then(this._onAllUploaded.bind(this,[d]));_.each(h,function(c){c.then(function(c){!p&&t._onSomeFileUploaded(t._toUploadStoreItem(c))&&f()},function(c){t._onUploadFailed(t._toUploadStoreItem(c));p&&t._onAllUploaded(d);!p&&f()},function(c){var b=c.progress;c=c.item.file._item;var a=Math.round(100*b.loaded/b.total);c&&(c.progress=a,c.loaded=b.loaded,c.total=b.total,c.refresh())})})},onBrowserUrlDropped:function(b,d){if(this.delegate&&this.delegate.onBrowserUrlDropped)this.delegate.onBrowserUrlDropped(this,
d)},dragEnter:function(b){b.preventDefault()},dragLeave:function(b){},dragOver:function(b){b.preventDefault();if(this.row){var d=this;b=this.row(b);var e=this.__currentDragOverRow,f=e?e.data:null;this.__currentDragOverRow&&$(this.__currentDragOverRow.element).removeClass("dgrid-focus");b&&b.element&&b.data&&!0===b.data.directory?(this.__currentDragOverTimer||(d.__currentDragOverTimeRow=b,d.__currentDragOverTimer=setTimeout(function(){var b=d.__currentDragOverTimeRow.data;b&&f&&b==f?(d.__currentDragOverTimeRow=
null,d.__currentDragOverTimer=null,d.openFolder(b)):d.__currentDragOverTimer=null},1550)),this.__currentDragOverRow=b,$(b.element).addClass("dgrid-focus")):this.__currentDragOverRow=null}},drop:function(b){b.preventDefault();var d=b.dataTransfer;if(d)if((d=d.files)&&d.length){if(this.onBrowserFilesDropped)this.onBrowserFilesDropped(this,d)}else try{var e=b.dataTransfer.getData("text/plain");if(e&&e.length)this.delegate.onBrowserUrlDropped(this,e)}catch(f){console.error("dropping url failed "+f)}},
initDND:function(){var b=this,d=this.domNode;d?(d.addEventListener("dragover",function(d){b.dragOver(d)},!1),d.addEventListener("drop",function(d){d.preventDefault();b.drop(d)},!1)):console.error("have not drop destination")},startup:function(){if(!this._started){var b=this.inherited(arguments);this.initDND();return b}}})})},"xfile/FolderSize":function(){define("xdojo/declare xide/types xide/utils xfile/Breadcrumb xide/layout/_TabContainer xfile/views/FileSize".split(" "),function(n,h,f,e,b,d){return n("xfile.FolderSize",
null,{__sizeDisplay:null,__bottomTabContainer:null,__bottomPanel:null,__sizesTab:null,showStats:function(e){var h=this.getBottomTabContainer(),t=this.__sizesTab,q=this.__sizeDisplay,p=this,c=this._getBottom(),m=c&&c.isExpanded();if(1==m&&c)e=!1;else if(!m&&c)return c.expand();if(e){c||(c=this.getBottomPanel(!1,.2));if(c&&q)return c.expand();h||(this.__bottomTabContainer=h=e=f.addWidget(b,{direction:"below"},null,c,!0),c._tabs=e);t||(t=this.__sizesTab=h.createTab("Sizes","fa-bar-chart"));q||(q=this.__sizeDisplay=
t.add(d,{owner:p},null,!1),q.startup(),this._on("openedFolder",function(c){f.destroy(p.__sizeDisplay);t.resize();p.resize();p.__sizeDisplay=null;p.__sizeDisplay=f.addWidget(d,{owner:p},null,t,!1);f.resizeTo(p.__sizeDisplay,t,!0,!0);p.__sizeDisplay.startup()}))}else c&&c.collapse()},_runAction:function(b){var d=this.getAction(b);return d&&d.command==h.ACTION.SIZE_STATS?this.showStats(this.__sizeDisplay?!1:!0):this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._on("onAddActions",
function(b){})}})})},"xfile/views/FileSize":function(){define(["dcl/dcl","xide/_base/_Widget"],function(n,h){return n(h,{_find:function(f,e){var b=_.find(e,{path:f}),d=this;if(b&&b.children&&b.children){var h=d._find(f,b.children);h&&(b=h)}b||_.each(e,function(e){var h=null;e.children&&e.children.length&&(h=d._find(f,e.children))&&(b=h)});return b},select:function(f){(f=this._find(f,this.d3Nodes))&&this.highlight(f)},direction:"left",templateString:'\x3cdiv class\x3d"sizeDisplay tabbable tabs-${!direction}" attachTo\x3d"containerNode" style\x3d"width: inherit;height: 100%;padding: 4px"\x3e\x3cul class\x3d"nav nav-tabs tabs-right" role\x3d"tablist"\x3e\x3cli class\x3d"active"\x3e\x3ca href\x3d"#_tab-content2_${!id}" data-toggle\x3d"tab"\x3eOverall\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca href\x3d"#_tab-content1_${!id}" data-toggle\x3d"tab"\x3eBy Type\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"body tab-content"\x3e\x3cdiv attachTo\x3d"tab2" id\x3d"_tab-content2_${!id}" class\x3d"tab-pane active clearfix"\x3e\x3cdiv class\x3d"chart1" attachTo\x3d"chart1" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3cdiv class\x3d"" style\x3d"" id\x3d"detailInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"widget" id\x3d"explanation" \x3e\x3cspan id\x3d"percentage"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan id\x3d"percentageDetail"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"tab1" id\x3d"_tab-content1_${!id}" class\x3d"tab-pane"\x3e\x3csvg class\x3d"chart2" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3c/svg\x3e\x3cdiv id\x3d"tooltip" class\x3d"hidden"\x3e\x3cspan id\x3d"chart2Per1"\x3eA\x3c/span\x3e \x3cbr\x3e\x3cspan id\x3d"chart2Per2"\x3e100\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
data:null,owner:self,vis:null,d3Nodes:null,colors:{dir:"#5687d1",jpeg:"#9b59b6",jpg:"#9b59b6",png:"#9b59b6",gif:"#9b59b6",psd:"#9b59b6",mp3:"#3498db",wav:"#3498db",wma:"#3498db",wmv:"#2ecc71","3gp":"#2ecc71",mp4:"#2ecc71",plv:"#2ecc71",mpg:"#2ecc71",mpeg:"#2ecc71",mkv:"#2ecc71",rm:"#2ecc71",rmvb:"#2ecc71",mov:"#2ecc71",doc:"#1abc9c",xls:"#1abc9c",ppt:"#1abc9c",docx:"#1abc9c",xlsx:"#1abc9c",pptx:"#1abc9c",pages:"#e74c3c",key:"#e74c3c",numbers:"#e74c3c",pdf:"#7b615c",epub:"#7b615c",c:"#f1c40f",cpp:"#f1c40f",
h:"#f1c40f",html:"#f1c40f",js:"#f1c40f",css:"#f1c40f",pl:"#f1c40f",py:"#f1c40f",php:"#f1c40f",sql:"#f1c40f",csv:"#de783b",odp:"#de783b",gz:"#6ab975",tar:"#6ab975",rar:"#6ab975",zip:"#6ab975","7z":"#6ab975","default":"#34495e"},totalSize:0,result:{},overallSize:0,buildHierarchy:function(f){for(var e={name:"root",children:[]},b=0;b<f.length;b++){var d=f[b][0],h=+f[b][1];if(!isNaN(h))for(var n=d.split("/"),t=e,q=0;q<n.length;q++){var p=t.children,c=n[q],m;if(q+1<n.length){for(var t=!1,r=0;r<p.length;r++)if(p[r].name==
c){m=p[r];t=!0;break}t||(m={name:c,type:"dir",children:[],path:d},p.push(m));t=m}else m=c.split(".").pop(),7>m.length&&(this.result[m]=m in this.result?this.result[m]+h:h),m={name:c,type:m,size:h,path:d},this.overallSize+=h,p.push(m)}}return e},bytesToSize:function(f){var e=["Bytes","KB","MB","GB","TB"];if(0==f)return"n/a";var b=parseInt(Math.floor(Math.log(f)/Math.log(1024)));return 0==b?f+" "+e[b]:(f/Math.pow(1024,b)).toFixed(1)+" "+e[b]},getAncestors:function(f){for(var e=[];f.parent;)e.unshift(f),
f=f.parent;return e},highlight:function(f){if(f){var e=(100*f.value/this.totalSize).toPrecision(3),b=e+"%";.1>e&&(b="\x3c 0.1%");var d=this.bytesToSize(f.value)+"/"+this.bytesToSize(this.totalSize),e=this.colors;d3.select("#percentage").text(b);d3.select("#percentageDetail").text(d);d3.select("#explanation").style("visibility","");var h=this.getAncestors(f);f=h.length;b="";for(d=0;d<f;d++)var n=h[d].type,b="dir"==n?b+('\x3cspan style\x3d"color:'+e[n]+'"\x3e'+h[d].name+"/\x3c/span\x3e"):b+('\x3cspan style\x3d"color:'+
e[n]+'"\x3e'+h[d].name+"\x3c/span\x3e");$("#detailInfo").html(b);d3.selectAll("path").style("opacity",.3);this.vis.selectAll("path").filter(function(b){return 0<=h.indexOf(b)}).style("opacity",1)}else console.error("cant find "+path)},createChart1:function(f,e,b,d,h){function n(b){var c=(100*b.value/q.totalSize).toPrecision(3),d=c+"%";.1>c&&(d="\x3c 0.1%");c=q.bytesToSize(b.value)+"/"+q.bytesToSize(q.totalSize);d3.select("#percentage").text(d);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility",
"");var f=q.getAncestors(b);b=f.length;d="";for(c=0;c<b;c++)var a=f[c].type,d="dir"==a?d+('\x3cspan style\x3d"color:'+t[a]+'"\x3e'+f[c].name+"/\x3c/span\x3e"):d+('\x3cspan style\x3d"color:'+t[a]+'"\x3e'+f[c].name+"\x3c/span\x3e");$("#detailInfo").html(d);d3.selectAll("path").style("opacity",.3);e.selectAll("path").filter(function(a){return 0<=f.indexOf(a)}).style("opacity",1)}e.append("svg:circle").attr("r",h).style("opacity",0);var t=this.colors,q=this;b=d3.layout.partition(h).size([2*Math.PI,h*
h]).value(function(b){return b.size}).nodes(f,h).filter(function(b){return.005<b.dx});d=d3.svg.arc().startAngle(function(b){return b.x}).endAngle(function(b){return b.x+b.dx}).innerRadius(function(b){return Math.sqrt(b.y)}).outerRadius(function(b){return Math.sqrt(b.y+b.dy)});f=e.data([f]).selectAll("path").data(b).enter().append("svg:path").attr("display",function(b){return b.depth?null:"none"}).attr("d",d).attr("fill-rule","evenodd").style("fill",function(b){return t[b.type]?t[b.type]:t["default"]}).style("opacity",
1).on("mouseover",n);d3.select("#container").on("mouseleave",function(b){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1E3).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",n)});d3.select("#explanation").transition().duration(1E3).style("visibility","hidden");$("#detailInfo").html("")});this.totalSize=f.node().__data__.value;return b},render:function(f){var e=$(this.tab2),b=e.height()-50,
e=e.height()-50;400>b&&(b=400);300>e&&(e=300);var d=e,h=d3.select(this.chart1).append("svg:svg").attr("width",b).attr("height",e).append("svg:g").attr("id","container").attr("transform","translate("+e/2+","+e/2+")"),b=this.createChart1(f,h,b,e,d/4,h);f=[];for(var n in this.result)if(d=this.result[n]/this.overallSize,!(.001>d)){var t=this.bytesToSize(this.result[n])+"/"+this.bytesToSize(this.overallSize);f.push({filetype:n,usage:d,detail:t})}this.vis=h;this.d3Nodes=b;b=$(this.tab1).width();400>b&&
(b=400);this.createChart2(f,b,e-100)},createChart2:function(f,e,b){var d=d3.scale.ordinal().rangeRoundBands([0,e],.1),h=d3.scale.linear().range([b,0]),n=d3.svg.axis().scale(d).orient("bottom"),t=d3.svg.axis().scale(h).orient("left"),q=this.colors;e=d3.select(this.tab1.children[0]).attr("width",e+40+30).attr("height",b+20+30).append("g").attr("transform","translate(40,20)");d.domain(f.map(function(b){return b.filetype}));h.domain([0,d3.max(f,function(b){return b.usage})]);e.append("g").attr("class",
"x axis").attr("transform","translate(0,"+b+")").call(n);e.append("g").attr("class","y axis").call(t);e.selectAll(".bar").data(f).enter().append("rect").attr("class","bar").attr("id",function(b){return"bar"+b.filetype}).attr("x",function(b){return d(b.filetype)}).attr("y",function(b){return h(b.usage)}).attr("height",function(d){return b-h(d.usage)}).attr("width",d.rangeBand()).attr("fill",function(b){return q[b.filetype]?q[b.filetype]:q["default"]}).on("mouseover",function(e){d3.select(this).transition().duration(50).attr("fill",
"#7f8c8d");var c=parseFloat(d3.select(this).attr("x"))+d.rangeBand()/2,f=parseFloat(d3.select(this).attr("y"))/2+b/2,h=parseFloat(100*e.usage).toFixed(2)+"%("+e.filetype+")";d3.select("#tooltip").style("left",c+"px").style("top",f+"px").select("#chart2Per2").text(e.detail);d3.select("#chart2Per1").text(h);d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){d3.select(this).transition().delay(100).duration(250).attr("fill",function(b){return q[b.filetype]?q[b.filetype]:q["default"]});
d3.select("#tooltip").classed("hidden",!0)})},startup:function(){if(this.owner){var f=this.owner,e=f.getRows(),b=[];_.each(e,function(d){b.push([d.path.replace("./",""),""+d.sizeBytes])});e=this.buildHierarchy(b);this.render(e);var d=this;f._on("selectionChanged",function(b){if("clear"!=b.why){b=(b=b.selection)?b[0]:null;var e=f.row(b),e=e?e.element:null;b&&e&&(b=b.path.replace("./",""),d.d3Nodes&&d.select(b))}})}}})})},"xfile/views/FileGrid":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/Grid xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),
function(n,h,f,e,b,d,v,w,t,q,p,c,m){q=c.DEFAULT_FILE_GRID_PERMISSIONS;var r=n("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:b.clone(e.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:e.ITEM_TYPE.FILE,permissions:q,
contextMenuArgs:{limitTo:null},setState:function(a){this.inherited(arguments);var b=this,c=b.collection,d=a.store.path;c.getSync(d);var e=b.refresh();try{e.then(function(){c.getItem(d,!0).then(function(a){b.openFolder(a)})})}catch(f){console.error("error restoring folder state")}return e},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=t.createFileStore(a.mount,
a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(b){a._columns[b.label]=!this.isColumnHidden(b.id)},this);return a},onSaveLayout:function(a){a=a.data;var b=this.getState();a.widgets.push({widget:this.declaredClass,state:b});return a},formatColumn:function(a,
c,k){var d=this.selectedRenderer?this.selectedRenderer.prototype:this;if(d.formatColumn&&(d=d.formatColumn.apply(arguments))||k.renderColumn&&(d=k.renderColumn.apply(this,arguments)))return d;switch(a){case "fileType":if("folder"==c)return m.localize("kindFolder");if(k.mime){var d="kind"+(k.mime.split("/")[1]||"unknown").toUpperCase(),e=m.localize(d);return d!==e?e:c}case "name":var e=k&&null!=k.directory&&!0===k.directory,f=!1===k.read&&!1===k.write,h=".."==k.name,d="",d=e?h?"fa fa-level-up itemFolderList":
f?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":f?"fa fa-lock itemFolderList":"itemFolderList fa "+b.getIconClass(k.path),e=!0===k.showPath?k.path:c;return'\x3cspan class\x3d"'+d+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+e+"\x3c/span\x3e";case "sizeBytes":return k.size;case "fileType":return b.capitalize(k.fileType||"unknown");case "mediaInfo":return k.mediaInfo||"unknown";case "owner":return k&&(d=k.owner)&&d.user?
d.user.name:"";case "modified":if(""===c)break;e=null==!k.directory;return!e&&m.translations.dateFormat?m.formatDate(c).replace("ms",""):""}return c},getColumns:function(){function a(a,c,d,e){null!=b._columns[a]&&(e=!b._columns[a]);b.columns.push({renderExpando:"Name"===a,label:a,field:c,sortable:d,formatter:function(a,k){return b.formatColumn(c,a,k)},hidden:e})}var b=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,b){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var c=this,d=new f;if(c){var e=this.collection;"."===a.path?(e.resetQueryLog(),c.set("collection",e.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):e.open(a).then(function(b){e.resetQueryLog();
c.set("collection",e.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(b)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var b=this.collection.getSync(a.rPath);b&&(a=b)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(!0===a.isBack&&(b=this.getHistory().getNow()))return this.collection.getSync(b);if(a=a._S.getParent(a))return a}return null},getClass:function(){return r},
getHistory:function(){this._history||(this._history=new d);return this._history},renderArray:function(a,b){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);h.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var b=v.getDefaultActions(this.permissions,this,this),b=b.concat(this.getFileActions(this.permissions));this.addActions(b)}this._history=new d;var c=this;this.subscribe(e.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===c.itemType&&(c.currentCopySelection=a.selection,c.refreshActions())});c._on("noData",function(){c.getRows();if(!(0<c._total)){var a=c._history.getNow();a&&"./."!==a&&c.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:c.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=c.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(c.removeRow(a),c.refresh())});this._on("openFolder",
function(a){c.set("title",a.item.name)});c.selectedRenderer&&(a=this.refresh())&&a.then(function(){c.set("loading",!1);c.setRenderer(c.selectedRenderer,!1)});this._on("onChangeRenderer",function(){c.refresh()});setTimeout(function(){c.resize()},500);return a}}});r.prototype.Module=r;r.Module=r;r.createDefault=function(a,c,k,d,e,f){c=b.mixin({collection:f.getDefaultCollection(),_parent:k,Module:r,ctx:a},c||{});c=b.addWidget(r,c,null,k,e,null,null,!0,null);d&&a.getWindowManager().registerView(c,!1);
return c};r.DEFAULT_PERMISSIONS=q;return r})},"xfile/factory/Store":function(){define(["xide/types","xide/factory","xide/utils","xfile/data/Store"],function(n,h,f,e){h.createFileStore=function(b,d,h,w,t){d=d||{fields:n.FIELDS.SHOW_ISDIR|n.FIELDS.SHOW_OWNER|n.FIELDS.SHOW_SIZE|n.FIELDS.SHOW_FOLDER_SIZE|n.FIELDS.SHOW_MIME|n.FIELDS.SHOW_PERMISSIONS|n.FIELDS.SHOW_TIME|n.FIELDS.SHOW_MEDIA_INFO};f.mixin(d,w);b=new e({data:[],ctx:t,config:h,url:h.FILE_SERVICE,serviceUrl:h.serviceUrl,serviceClass:h.FILES_STORE_SERVICE_CLASS,
mount:b,options:d});b._state={initiated:!1,filter:null,filterDef:null};b.reset();b.setData([]);b.init();t&&t.getFileManager().addStore(b);return b};return h})},"xfile/data/Store":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred xide/mixins/ReloadMixin xide/manager/ServerActionBase dstore/Cache dstore/QueryResults xide/types xide/utils dojo/when xide/data/TreeMemory dstore/Trackable xide/data/ObservableStore xfile/model/File".split(" "),function(n,h,f,e,b,d,v,w,t,q,p,c,m,r){function a(){return{addDot:!0,
rootSegment:".",Model:r,idProperty:"path",parentField:"parent",mount:"path",options:{fields:1663,includeList:"*",excludeList:"*"},serviceUrl:null,serviceClass:null,singleton:!0,queryAccessors:!0,autoEmitEvents:!1,mayHaveChildren:function(a){return 0==a.mayHaveChildren?!1:!0===a.directory},getChildren:function(a){return this.inherited(arguments)},_lastFilter:null,_lastFilterDef:null,_lastFilterItem:null,_initiated:{value:!1},id:null,_state:{initiated:!1,filter:null,filterDef:null},isInitiated:function(){return this._state.initiated},
setInitiated:function(a){this._state.initiated=a},_extraSortProperties:{name:{ignoreCase:!0}},constructor:function(){this.id=t.createUUID()},sort:function(){return this.inherited(arguments)},onSorted:function(a,b){if(1==a.length&&"name"===a[0].property){var c=a[0].descending,d=function(a){return a.name},e=_.groupBy(b,function(a){return!0===a.directory},this);b=_.sortBy(e["true"],d);b=b.concat(_.sortBy(e["false"],d));c&&b.reverse()}if(c=_.find(b,{name:".."}))b.remove(c),b.unshift(c);return b=this.onAfterSort(b)},
onAfterSort:function(a){var b=this.micromatch;if("undefined"!==typeof mm&&b&&a&&a[0]){var c=a[0].realPath?"realPath":"path",c="name",d=_.pluck(a,c),e=mm(d,b);a=a.filter(function(a){return-1===e.indexOf(a[c])?null:a})}return a},_createSortQuerier:function(a){var b=this;return function(c){c=c.slice();c.sort("function"==typeof a?a:function(c,d){for(var e=0;e<a.length;e++){var l;if("function"==typeof a[e])l=a[e](c,d);else{var f=a[e].property;b._extraSortProperties[f]&&h.mixin(a[e],b._extraSortProperties[f]);
l=a[e].descending;var m=c.get?c.get(f):c[f],f=d.get?d.get(f):d[f],r=!!a[e].ignoreCase;null!=m&&(m=m.valueOf());null!=f&&(f=f.valueOf());r&&(m.toUpperCase&&(m=m.toUpperCase()),f.toUpperCase&&(f=f.toUpperCase()));l=m===f?0:!!l===(null===m||m>f)?-1:1}if(0!==l)return l}return 0});return b.onSorted(a,c)}},_getItem:function(a,b){var c=this.getSync(a)||this.getSync("./"+a);return c&&(this.isItemLoaded(c)||1==b)?c:"."===a?this.getRootItem():null},getItem:function(a,b){if(0==b)return this._getItem(a);if(1==
b){var c=a.split("/"),d=this,e=[],h=d.getSync(a);h||(h=d.getSync(a.replace("./","")));if(h&&this.isItemLoaded(h))return h;for(var m=new f,r=function(){if(_.find(e,{loaded:!1}))for(var b=0;b<e.length;b++){if(!e[b].loaded){var c=d.getSync(e[b].path);if(c)if(!0===c.directory&&d.isItemLoaded(c)){e[b].loaded=!0;continue}else if(null==c.directory){m.resolve(c);break}d._loadPath(e[b].path).then(function(a){e[b].loaded=!0;r()},function(a){var c=Math.abs(Math.min(0,b-1));a=e[c];a||(c=e.length-1,a=e[c]);d.getItem(a.path);
q(d.getItem(e[c].path,!1),function(a){m.resolve(a,e[c].path)})});break}}else m.resolve(d.getItem(a,!1))},h=".",n=0;n<c.length;n++)"."!=c[n]&&(0<c.length&&(h+="/"),h+=c[n],e.push({path:h,loaded:!1}));r();return m}return"."===a?this.getRootItem():null},getRootItem:function(){return{_EX:!0,path:".",name:".",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},getItemByPath:function(){},getParents:function(){return null},getParent:function(a){if(!a)return null;var b=
a,c=null;h.isString(b)&&(b=this.getSync(a));b&&b.parent&&(c=this.getSync(b.parent));return c||this.getRootItem()},isItemLoaded:function(a){return a&&(!a.directory||this._isLoaded(a))},loadItem:function(a,b){return this._loadItem(a,b)},_parse:function(a){a._S=this;_.isEmpty(a.children)||_.each(a.children,function(b){b.parent=a.path;this._parse(b)},this);a.getPath=function(){return this.path}},_itemReloaded:function(){},_loadPath:function(a,b){var c=this.getSync(a),d=this;if(c&&!0!==c.directory)debugger;
return this._request(a).then(function(c){var e=d._getItem(a,!0);if(e)return b&&(_.isEmpty(e.children)||d.removeItems(e.children)),e._EX=!0,d.addItems(c,b),e.children=c;throw Error("cant get item at "+a);},function(a){console.error("error in load")})},addSync:function(a,b){(b=b||{}).overwrite=!1;return this.putSync(a,b)},_loadItem:function(a,b){var c=new f,d=this;if(!a)return c.reject("need item"),c;b&&("."===a.path?(d.setInitiated(!1),d.fetchRange().then(function(b){c.resolve({store:d,items:b,item:a})})):
this._loadPath(a.path,!0).then(function(b){c.resolve(a)},function(a){console.error("error occured whilst loading items");c.reject(a)}));return c},_normalize:function(a){return a&&a.items?a.items[0]:[]},_isLoaded:function(a){return a&&!0===a._EX},fetch:function(){},put:function(){},add:function(a){var b=this.getSync(a.path);b||(b=this.addSync(a),b._S=this,b.getPath=function(){return this.path});return b},removeItems:function(a){_.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path)},this)},
addItems:function(a,b){_.each(a,function(a){this.getSync(a.path)&&this.removeSync(a.path);this.add(a)},this)},open:function(a){var b=this;if(this._isLoaded(a)){var c=new f;b.resetQueryLog();c.resolve(a.children);return c}a.isLoading=!0;return b._request(a.path).then(function(c){a.isLoading=!1;a._EX=!0;b.addItems(c);return a.children=c})},onReloaded:function(){},getDefaultSort:function(){return[{property:"name",descending:!1,ignoreCase:!0}]},lastOpenedPath:function(){var a=this._state.path;return a&&
(a=this.getSync(a))&&(a=this.getParent(a.getPath()))?a.getPath():null},filter:function(a){a.parent&&(this._state.path=a.parent);var b=this.getSync(a.parent);b&&(this.isItemLoaded(b)?this._state.filterDef=null:this._state.filterDef=this._loadPath(b.path));this._state.filter=a;return this.inherited(arguments)},_request:function(a){var b=this;return this.runDeferred(null,"ls",{path:a,mount:this.mount,options:this.options},{checkErrors:!1,displayError:!0}).then(function(a){a=b._normalize(a);b._parse(a);
return a=a.children||a},function(a){console.error("error in FileStore : "+this.mount+" :"+a,a)})},fetchSync:function(){return this.inherited(arguments)},fetchRangeSync:function(a){a=this.fetchSync();var b=new f;b.resolve(a.length);return new v(a,{totalLength:b})},reset:function(){this._state.filter=null;this._state.filterDef=null;this.resetQueryLog()},resetQueryLog:function(){this.queryLog=[]},fetchRange:function(){var a=this._fetchRange();return new v(a.then(function(a){return a}),{totalLength:a.then(function(a){return a.length})})},
initRoot:function(){var a=this;if(!this.isInitiated())return a._request(".").then(function(b){a.isInitiated()||(_.each(b,function(b){a._parse(b)}),a.setData(b),a.setInitiated(!0),a.emit("loaded"));return a.fetchRangeSync(arguments)}.bind(this));var b=new f;b.resolve();return b},_fetchRange:function(){this.isInitiated();if(this._state.filter){var a=this._state.filterDef;if(a)return a.then(function(b){this.reset();a&&a.resolve&&a.resolve(b)}.bind(this)),a;this.getSync(this._state.filter.parent)}var b=
this;if(this.isInitiated()){var c=b.fetchRangeSync(arguments),d=new f,e=new f;d.resolve(c);e.resolve(c.length);b.emit("loaded");return new v(d,{totalLength:c.totalLength})}return b._request(".").then(function(a){b.isInitiated()||(_.each(a,function(a){b._parse(a)}),b.setData(a),b.setInitiated(!0),b.emit("loaded"));return b.fetchRangeSync(arguments)}.bind(this))},getDefaultCollection:function(a){var b=this.getDefaultSort();return a?this.filter({parent:a}).sort(b):this.sort(b)}}}n=n("xfile/data/Store",
[p,d,c,m,b.declare,e],a());n.Implementation=a;return n})},"xfile/model/File":function(){define(["xdojo/declare","xide/data/Model","xide/utils","xide/types"],function(n,h,f,e){return n("xfile.model.File",[h],{getFolder:function(){var b=this.getPath();return this.directory?b:f.pathinfo(b,e.PATH_PARTS.ALL).dirname},getChildren:function(){return this.children},getParent:function(){return(this.getStore()||this._S).getParent(this)},getStore:function(){return this._store||this._S}})})},"xfile/config":function(){define(["dojo/_base/declare",
"xide/types"],function(n,h){h.config={ROOT_NODE:"xapp",FILE_SERVICE:"",START_PATH:"./",FILES_STORE_SERVICE_CLASS:"XCOM_Directory_Service",IS_MEDIA_PICKER:null,EDITOR_NODE:null,EDITOR_AFTER_NODE:null,ACTION_TOOLBAR:null,ALLOWED_DISPLAY_MODES:{TREE:1,LIST:1,THUMB:1,IMAGE_GRID:1},LAYOUT_PRESET:null,beanContextName:null};return h})},"xfile/manager/FileManager":function(){define("dcl/dcl dojo/_base/lang xide/manager/ServerActionBase xide/types xfile/types xide/utils xide/encoding/SHA1 xide/manager/RPCService dojo/Deferred xdojo/has xfile/manager/FileManagerActions require xfile/factory/Store xdojo/has!electron?xfile/manager/Electron".split(" "),
function(n,h,f,e,b,d,v,w,t,q,p,c,m,r){f=[f,p];q("electronx")&&r&&f.push(r);return n(f,{declaredClass:"xfile.manager.FileManager",getNewName:function(a,b){for(var c=a.name.replace(".meta.json",""),d=!1,e=1,f=null;!d;)f=c+"-"+e+".meta.json",_.find(b,{name:f})?e++:d=!0;return f},_uploadXHR:null,store:null,config:null,filesToUpload:null,serviceUrl:"index.php",serviceClass:"XCOM_Directory_Service",settingsStore:null,stores:[],getStore:function(a,b){var c=_.find(this.stores,{mount:a});return c?c:m.createFileStore(a,
null,this.config,null,this.ctx)},addStore:function(a){this.stores.push(a);a._on("destroy",this.removeStore.bind(this))},removeStore:function(a){this.stores.indexOf(a)&&this.stores.remove(a)},download:function(a){[].push(a.path);var b=decodeURIComponent(this.serviceUrl),b=b.replace("view\x3drpc","view\x3dsmdCall"),b=-1!=b.indexOf("?")?b+"\x26":b+"?",c=this.serviceClass||"XCOM_Directory_Service";a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);b+="service\x3d"+c+".get\x26path\x3d"+
a+"\x26callback\x3dasdf";this.config.DOWNLOAD_URL&&(b=""+this.config.DOWNLOAD_URL,b+="\x26path\x3d"+a+"\x26callback\x3dasdf");var b=b+"\x26raw\x3dhtml\x26attachment\x3d1",e=d.getUrlArgs(location.href);d.mixin(e,{service:c+".get",path:a,callback:"asdf",raw:"html",attachment:"1",send:"1"});delete e.theme;delete e.debug;delete e.width;delete e.attachment;delete e.send;c=dojo.toJson(e);c=v._hmac(c,this.config.RPC_PARAMS.rpcSignatureToken,1);b+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;
b+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+c;window.open(b)},getImageUrl:function(a,b,c){a||console.error("invalid item!");b=-1!=location.href.indexOf("noImageCache")||!0===b||!0===a.dirty;var e=decodeURIComponent(this.serviceUrl),e=e.replace("view\x3drpc","view\x3dsmdCall");a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);var f=this.ctx.getFileManager().serviceClass||"XCOM_Directory_Service",e=-1!=e.indexOf("?")?e+"\x26":e+"?",e=e+("service\x3d"+f+".get\x26path\x3d"+
a+"\x26callback\x3dasdf");this.config.DOWNLOAD_URL&&(e=""+this.config.DOWNLOAD_URL,e+="\x26path\x3d"+a+"\x26callback\x3dasdf");var e=e+"\x26raw\x3dhtml\x26attachment\x3d0",e=e+"\x26send\x3d1",h=d.getUrlArgs(location.href);d.mixin(h,{service:f+".get",path:a,callback:"asdf",raw:"html"});d.mixin(h,c);delete h.theme;delete h.debug;delete h.width;a=dojo.toJson(h);a=v._hmac(a,this.config.RPC_PARAMS.rpcSignatureToken,1);e+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;
e+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+a;b&&(e+="\x26time\x3d"+(new Date).getTime());if(c)for(var m in c)e+="\x26"+m+"\x3d"+c[m];return e},onFileUploadFailed:function(a){var b=e.EVENTS;a.dfd&&a.dfd.reject(a);this.filesToUpload.remove(a);this.publish(b.ON_UPLOAD_FAILED,{item:a},this)},onFileUploaded:function(a){var b=this,c=e.EVENTS;setTimeout(function(){b.publish(c.STATUS,{message:""+a.file.name+" uploaded to "+a.dstDir,messageArgs:{}},b);a.dfd&&a.dfd.resolve(a);b.filesToUpload.remove(a);
b.publish(c.ON_UPLOAD_FINISH,{item:a})},500)},getUploadUrl:function(){var a=""+decodeURIComponent(this.serviceUrl),a=a.replace("view\x3drpc","view\x3dupload"),a=a.replace("../../../../","./"),a=a+"\x26service\x3d"+this.serviceClass;return a+=".put\x26callback\x3dnada"},initXHRUpload:function(a,b,c,l){var f=new XMLHttpRequest;b=""+this.getUploadUrl();b+="\x26mount\x3d"+encodeURIComponent(l);b+="\x26dstDir\x3d"+encodeURIComponent(c);var m=this;c=f.upload;c.addEventListener("progress",function(b){if(b.lengthComputable)b=
{item:a,progress:b},a.isLoading=!0,a.dfd.progress(b);else m.onFileUploaded(a)}.bind(this),!1);f.onreadystatechange=function(){if(4==f.readyState){if(f.responseText&&"OK"!=f.responseText){var b=d.getJson(f.responseText);!b&&f.responseText.indexOf("Fata Error")&&(b={result:[f.responseText],code:1});if(b&&b.result&&h.isArray(b.result)&&0<b.result.length){for(var c=null,g=0;g<b.result.length;g++)m.publish(e.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.result[g],m),c=b.result[g];c&&(a.error=c);m.onFileUploadFailed(a);
m.submitNext();return}b&&b.error&&(m.publish(e.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.error.message,m),m.onFileUploadFailed(a))}m.onFileUploaded(a);m.submitNext()}}.bind(this);c.onerror=function(){m.publish(e.EVENTS.ERROR,"Error uploading : "+a.name,m)};f.open("POST",b,!0);return f},hasLoadingItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if("loading"==this.filesToUpload[a].status)return this.filesToUpload[a];return!1},upload:function(a,b,c,d,e){e=[];for(var f=0;f<a.length;f++){var h=
{file:a[f],dstDir:""+c,mount:""+b,callee:d,view:d,dfd:new t};e.push(h.dfd);this.filesToUpload.push(h)}this.submitNext();return e},sendFileUsingFormData:function(a,b){var c=new FormData;c.append("userfile_0",b.file);a.send(c)},sendFileMultipart:function(a){a.status="loading";var b=this.initXHRUpload(a,"",a.dstDir,a.mount);this.publish(e.EVENTS.ON_UPLOAD_BEGIN,{item:a,name:a.name},this);window.FormData&&this.sendFileUsingFormData(b,a)},submitNext:function(){var a=this.getNextUploadItem();a&&this.sendFileMultipart(a)},
getNextUploadItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if(!this.filesToUpload[a].status)return this.filesToUpload[a];return!1},onError:function(a){if(a)if(1===a.code){if(a.message&&h.isArray(a.message)){this.publish(e.EVENTS.ERROR,a.message.join("\x3cbr/\x3e"),this);return}}else 0===a.code&&this.publish(e.EVENTS.STATUS,"Ok",this);this.publish(e.EVENTS.ERROR,{error:a},this)},addError:function(a){var b=this;a.addCallback(function(){b.onError()})},downloadItem:function(a,b){return this.callMethod(e.OPERATION.DOWNLOAD,
[a],b,!0)},downloadTo:function(a,b,c,d,f){if(f){var h=this,m=function(a){var b=!1;a&&a.error&&1==a.error.code&&(b=!0);h.publish(e.EVENTS.ON_DOWNLOAD_TO_END,{terminatorItem:f,failed:b},this);d(arguments)};h.publish(e.EVENTS.ON_DOWNLOAD_TO_BEGIN,{dst:f,url:a,items:[f]},this)}return this.callMethod(e.OPERATION.DOWNLOAD_TO,[a,b,c],m,!0)},find:function(a,b,c){try{return this.callMethod(e.OPERATION.FIND,[a,b],c,!0)}catch(d){logError(d,"find")}},getContent:function(a,b,k,f){if(this.getContentE){var h=this.getContentE.apply(this,
arguments);if(h)return h}return q("php")?(h=this.serviceObject.base64_encode(d.buildPath(a,b,!0)),this.callMethod(e.OPERATION.GET_CONTENT,[h,!1,!1],k,!1)):this._getText(c.toUrl(a).replace("main.js","")+"/"+b,{sync:!1,handleAs:"text"}).then(function(a){try{k&&k(a)}catch(b){logError(b,"error running RPC")}})},setContent:function(a,b,c,d){this.publish(e.EVENTS.ON_CHANGED_CONTENT,{mount:a,path:b,content:c});this.publish(e.EVENTS.ON_STATUS_MESSAGE,{text:"Did save file : "+a+"://"+b});if(this.setContentE){var f=
this.setContentE.apply(this,arguments);if(f)return f}return this.callMethod(e.OPERATION.SET_CONTENT,[a,b,c],d,!0)},onMessages:function(a){if((a=d.getJson(a.events))&&h.isArray(a))for(var b=0;b<a.length;b++){var c={path:a[b].relPath};h.mixin(c,a[b]);this.publish(a[b].clientEvent,c,this)}},onErrors:function(a){},init:function(){this.stores=[]},callMethodEx:function(a,b,c,d,f){var m=a||this.serviceClass,r=this;if(!this.serviceObject[m][b]){if(!0===f)this.onError({code:1,message:["Sorry, server doesnt know "+
b]});return null}a={};a=h.mixin(a,this.config.RPC_PARAMS.rpcFixedParams);a[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=a;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;this.serviceObject[m][b](c).then(function(a){try{d&&d(a)}catch(c){console.error("bad news : callback for method "+b+" caused a crash in service class "+m)}a&&a.error&&3==a.error.code&&
setTimeout(function(){r.onMessages(a.error)},50);if(a&&a.error&&a.error&&0!==a.error.code)r.onError(a.error);else r.publish(e.EVENTS.STATUS,{message:"Ok!"},this)},function(a){r.onError(a)})},callMethod:function(a,b,c,d){var f=this,m=this.serviceClass;try{if(!this.serviceObject[m][a]){if(!0===d)this.onError({code:1,message:["Sorry, server doesnt know "+a]});return null}m={};m=h.mixin(m,this.config.RPC_PARAMS.rpcFixedParams);m[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;
this.serviceObject.extraArgs=m;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;var r=this.serviceObject[this.serviceClass][a](b);r.then(function(b){try{c&&c(b)}catch(g){console.error("crashed in "+a),logError(g,"error running RPC")}b&&b.error&&3==b.error.code&&setTimeout(function(){f.onMessages(b.error)},50);if(b&&b.error&&b.error&&1==b.error.code)f.onError(b.error);else!1!==d&&f.publish(e.EVENTS.STATUS,
{message:"Ok!"},this)},function(a){f.onError(a)});return r}catch(n){console.error("crash calling method"+n,arguments),f.onError(n),logError(n,"error ")}},_initService:function(){this.filesToUpload=[];!this.serviceObject&&this.serviceUrl&&(this.serviceObject=new w(decodeURIComponent(this.serviceUrl)),this.serviceObject.config=this.config)}})})},"xfile/manager/FileManagerActions":function(){define(["dcl/dcl","xide/types","xide/utils"],function(n,h,f){return n(null,{declaredClass:"xfile/manager/FileManagerActions",
_publishProgress:function(e,b,d,h,n){b={terminatorItem:b,failed:h,items:d||b};f.mixin(b,n);this.publish(e,b,this)},doOperation:function(e,b,d,f,h,n){var q=this,p=e.substring(0,1).toUpperCase()+e.substring(1),c="on"+p+"End";q._publishProgress("on"+p+"Begin",d,f,!1,h);return this.runDeferred(null,e,b,n).then(function(){q._publishProgress(c,d,f,!1,h)},function(b){q._publishProgress(c,d,f,!0,h)})},deleteItems:function(e,b,d){return this.doOperation(h.OPERATION.DELETE,[e,b,!0],e,e,null,d)},copyItem:function(e,
b,d,f){return this.doOperation(h.OPERATION.COPY,[e,b,d,!1],e,e,{dst:b},f)},mkdir:function(e,b,d){return this.doOperation(h.OPERATION.NEW_DIRECTORY,[e,b],b,null,null,d)},mkfile:function(e,b,d){return this.doOperation(h.OPERATION.NEW_FILE,[e,b],b)},rename:function(e,b,d){return this.doOperation(h.OPERATION.RENAME,[e,b,d],b)},moveItem:function(e,b,d,f,n,t){return this.doOperation(h.OPERATION.MOVE,[e,b,d,f,n],e,null,null,t)},compressItem:function(e,b,d,f){return this.doOperation(h.OPERATION.COMPRESS,
[e,b,d],b)},extractItem:function(e,b,d){return this.doOperation(h.OPERATION.EXTRACT,[e,b],b)}})})},"xfile/manager/MountManager":function(){define("dcl/dcl xdojo/has dojo/_base/lang dojo/dom-class xide/manager/ResourceManager xide/mixins/ReloadMixin xide/mixins/EventedMixin xide/types dojo/aspect xide/utils xide/views/CIActionDialog".split(" "),function(n,h,f,e,b,d,v,w,t,q,p){return n([b,v.dcl,d.dcl],{declaredClass:"xfile.manager.MountManager",serviceClass:"XApp_Resource_Service",mountData:null,didReload:!1,
editMount:function(b){b&&("FILE_PROXY"===b.type?this.registerLocalMount(b):"REMOTE_FILE_PROXY"===b.type&&h("remote-vfs")&&("Ftp"===b.adapter&&this.registerFTP(b),"Sftp"===b.adapter&&this.registerSFTP(b),"Dropbox"===b.adapter&&this.registerDropbox(b),"Webdav"===b.adapter&&this.registerWebDav(b)))},removeMount:function(b){if(b){var d=this,f=function(){d.removeResource(b,!1,function(){d.ls(function(a){d.onMountDataReady(a)})})},a=new FileDeleteDialog({title:"Remove "+b.name,config:this.config,delegate:{onOk:function(){f()}},
ctx:this.ctx,titleBarClass:"ui-state-error",inserts:[{query:".dijitDialogPaneContent",insert:'\x3cdiv\x3e\x3cspan class\x3d"fileManagerDialogText"\x3eDo you really want to remove this item?\x3c/span\x3e\x3c/div\x3e',place:"first"}]});e.add(a.domNode,"fileOperationDialog");a.show();a.addActionButtons();a.fixHeight();a.resize();setTimeout(function(){a.resize()},1E3)}},getMounts:function(){return this.mountData},_patchMenu:function(b){t.after(b,"onOpen",function(){this._popupWrapper&&this._popupWrapper&&
e.add(this._popupWrapper,"ui-widget ui-widget-content")})},_onDialogOk:function(b,d,e){var a=q.toOptions(d),g=this;b=null!=e.name;d={"class":"cmx.types.Resource",enabled:!0};for(var k=0;k<a.length;k++){var l=a[k];null==l.user?d[l.name]=l.value:(d.config||(d.config={}),d.config[l.name]=l.value)}a="";d.label?a=d.label:d.config.label&&(a=d.config.label);d.name=""+(null!=e.name?e.name:a.toLowerCase());"FILE_PROXY"===d.config.type?(d.path=""+d.path+"",f.mixin(d,d.config)):"REMOTE_FILE_PROXY"===d.config.type&&
(d.path=d.name+"://");e=function(){g.ls(function(a){g.onMountDataReady(a)})};b?this.updateResource(d,!1,e):this.createResource(d,!1,e)},registerLocalMount:function(b){var d=b?b.name:"",e=b?b.path:"";b&&b.config&&b.config.path&&(e=b.config.path);var a=this;(new p({title:d?"Edit Mount "+d:"New Local Mount",style:"max-width:400px;min-height:300px",delegate:{onOk:function(d,e){a._onDialogOk(d,e,b)}},cis:[q.createCI("label",13,"",{group:"Common",title:"Name",value:d}),q.createCI("path",13,"",{group:"Common",
title:"Path",value:e}),q.createCI("type",13,"",{visible:!1,value:"FILE_PROXY"})]})).show()},registerFTP:function(b){b=b||{};var d=b.config||{},e=this;(new p({title:b.name?"Edit Ftp "+b.name:"New Ftp",style:"max-width:400px",delegate:{onOk:function(a,d){e._onDialogOk(a,d,b)}},cis:[xide.utils.createCI("label",13,"",{group:"Common",title:"Name",value:b.name}),xide.utils.createCI("root",13,"",{group:"Ftp",title:"Start Path",value:d.root,user:{config:!0}}),xide.utils.createCI("adapter",13,"",{visible:!1,
value:"Ftp"}),xide.utils.createCI("host",13,"",{group:"Ftp",title:"Host",user:{config:!0},value:d.host}),xide.utils.createCI("username",13,"",{group:"Ftp",title:"User",user:{config:!0},value:d.username}),xide.utils.createCI("password",13,"",{group:"Ftp",title:"Password",user:{config:!0},value:d.password}),xide.utils.createCI("passive",0,"",{group:"Ftp",title:"Passive",user:{config:!0},value:d.passive}),xide.utils.createCI("ssl",0,"",{group:"Ftp",title:"SSL",user:{config:!0},value:null!=d.ssl?d.ssl:
!1}),xide.utils.createCI("port",13,"",{group:"Ftp",title:"Port",user:{config:!0},value:null!=d.port?d.port:21}),xide.utils.createCI("type",13,"",{visible:!1,value:"REMOTE_FILE_PROXY"})]})).show()},registerSFTP:function(b){b=b||{};var d=b.config||{},e=this;(new p({title:b.name?"Edit Ftp "+b.name:"New Ftp",style:"max-width:400px",delegate:{onOk:function(a,d){e._onDialogOk(a,d,b)}},cis:[xide.utils.createCI("label",13,"",{group:"Common",title:"Name",value:b.name}),xide.utils.createCI("root",13,"",{group:"SFtp",
title:"Start Path",value:d.root,user:{config:!0}}),xide.utils.createCI("adapter",13,"",{visible:!1,value:"Sftp"}),xide.utils.createCI("host",13,"",{group:"SFtp",title:"Host",user:{config:!0},value:d.host}),xide.utils.createCI("username",13,"",{group:"SFtp",title:"User",user:{config:!0},value:d.username}),xide.utils.createCI("password",13,"",{group:"SFtp",title:"Password",user:{config:!0},value:d.password}),xide.utils.createCI("port",13,"",{group:"SFtp",title:"Port",user:{config:!0},value:null!=d.port?
d.port:22}),xide.utils.createCI("type",13,"",{visible:!1,value:"REMOTE_FILE_PROXY"})]})).show()},registerDropbox:function(b){var d=this;(new p({title:"New Dropbox",style:"max-width:400px",delegate:{onOk:function(e,a){d._onDialogOk(e,a,b)}},cis:[xide.utils.createCI("label",13,"",{group:"Common",title:"Name",value:"Dropbox1"}),xide.utils.createCI("pathPrefix",13,"",{group:"Common",title:"Start Path",user:{config:!0}}),xide.utils.createCI("adapter",13,"",{visible:!1,value:"Dropbox"}),xide.utils.createCI("token",
13,"",{group:"Dropbox",title:"Token",user:{config:!0},value:"h16UVItP7qQAAAAAAAAABP3qmBJFOHj3fA5ffKyaHH-j7HCLvFOceZxhENV0sy24"}),xide.utils.createCI("appname",13,"",{group:"Dropbox",title:"App Name",user:{config:!0},value:"xapp_local"}),xide.utils.createCI("type",13,"",{visible:!1,value:"REMOTE_FILE_PROXY"})]})).show()},registerWebDav:function(){var b=this;(new p({title:"New Webdav",style:"max-width:400px",delegate:{onOk:function(d,e){b._onDialogOk(d,e)}},cis:[xide.utils.createCI("label",13,"",{group:"Common",
title:"name"}),xide.utils.createCI("pathPrefix",13,"",{group:"Common",title:"Start Path"}),xide.utils.createCI("adapter",13,"",{visible:!1,value:"WebDav"}),xide.utils.createCI("host",13,"",{group:"WebDav",title:"Host"}),xide.utils.createCI("baseUri",13,"",{group:"WebDav",title:"Base URI"}),xide.utils.createCI("userName",13,"",{group:"WebDav",title:"User Name"}),xide.utils.createCI("password",13,"",{group:"WebDav",title:"Password"}),xide.utils.createCI("type",13,"",{visible:!1,value:"REMOTE_FILE_PROXY"})]})).show()},
onSourceMenuOpened:function(b){b=b.menu;if(this.config.ALLOWED_ACTIONS[w.OPERATION_INT.ADD_MOUNT]&&!b.mountMenu){var d=new Menu({parentMenu:b});this._patchMenu(d);var e=new MenuItem({label:"Local",onClick:f.hitch(this,"registerLocalMount"),iconClass:"el-icon-folder-open"});d.addChild(e);h("remote-vfs")&&(e=new MenuItem({label:"Dropbox",onClick:f.hitch(this,"registerDropbox"),iconClass:"fa-dropbox"}),d.addChild(e),e=new MenuItem({label:"WEB DAV",onClick:f.hitch(this,"registerWebDav"),iconClass:"fa-cloud"}),
d.addChild(e),e=new MenuItem({label:"FTP",onClick:f.hitch(this,"registerFTP"),iconClass:"fa-cloud"}),d.addChild(e),e=new MenuItem({label:"SFTP",onClick:f.hitch(this,"registerSFTP"),iconClass:"fa-cloud"}),d.addChild(e));b.addChild(new PopupMenuItem({label:"Add",popup:d,iconClass:"el-icon-plus"}));b.mountMenu=d}},onReloaded:function(){},onMountDataReady:function(b){this.mountData=b;this.publish(w.EVENTS.ON_MOUNT_DATA_READY,{data:b});var d=this;setTimeout(function(){d.publish(w.EVENTS.ON_MOUNT_DATA_READY,
{data:b})},4E3)},check:function(){this.serviceObject||this._initService()},init:function(){this.ctx.getFileManager()&&(this.serviceObject=this.ctx.getFileManager().serviceObject)},createResource:function(b,d,e){return this.callMethodEx(null,"createResource",[b,d],e,!0)},removeResource:function(b,d,e){return this.callMethodEx(null,"removeResource",[b,!0],e,!0)},updateResource:function(b,d,e){return this.callMethodEx(null,"updateResource",[b,!0],e,!0)},ls:function(b){return this.runDeferred(null,"ls",
[]).then(function(d){this.mountData=d;this.onMountDataReady(d);b&&b(d)}.bind(this))}})})},"xfile/manager/BlockManager":function(){define("dcl/dcl dojo/_base/declare dojo/_base/lang xide/types xide/utils xide/factory xide/manager/ManagerBase xide/mixins/ReloadMixin xblox/manager/BlockManager xblox/model/variables/Variable".split(" "),function(n,h,f,e,b,d,v,w,t,q){return n([v,t,w.dcl],{declaredClass:"xfile/manager/BlockManager",currentItem:null,onScopeCreated:function(b){},updateScope:function(b,c){},
updateScopes:function(b){for(var c in this.scopes)this.updateScope(this.scopes[c],b)},init:function(){this.subscribe(e.EVENTS.ON_SCOPE_CREATED,this.onScopeCreated)},setScriptFunctions:function(b,c,d){this.inherited(arguments)},onReloaded:function(){this.init()}})})},"xfile/views/FileConsole":function(){define("xdojo/declare dcl/dcl xide/types xide/utils xide/mixins/PersistenceMixin module dojo/_base/lang xide/layout/_TabContainer xide/views/_Console xide/views/_ConsoleWidget xfile/views/FileSize xide/views/ConsoleView dojo/has!xace?xace/views/Editor".split(" "),
function(n,h,f,e,b,d,v,w,t,q,p,c,m){function r(){return h(null,{owner:null,onServerResponse:function(a,b,c){if(a&&b&&a.owner&&a.owner.onServerResponse)return a.owner.onServerResponse(b,c)},runBash:function(a,b,c,d){var e=this,f=e.ctx.fileManager;b=f.serviceObject.base64_encode(b);f.runDeferred("XShell","run",["sh",b,c]).then(function(b){d&&$(d).find(".consoleRunningCommand").remove();e.onServerResponse(a,b,!1)})},runPHP:function(a,b,c){var d=this,e=ctx.fileManager;b=e.serviceObject.base64_encode(b);
e.runDeferred("XShell","run",["php",b,c]).then(function(b){d.onServerResponse(a,b,!1)})},runJavascript:function(a,b,c,d){c=(new Function("{"+b+"; }")).call(c,d);return null!=c?(this.onServerResponse(a,c),c):b},onConsoleCommand:function(a,b){var c=a.console;if("sh"===c.type){var d=this.onServerResponse(c,"\x3cspan class\x3d'consoleRunningCommand fa-spinner fa-spin'\x3e\x3c/span\x3e\x3cpre style\x3d'font-weight: bold'\x3e# "+b+"\x3c/pre\x3e",!0),f=null;if(this.owner&&this.owner.getCurrentFolder){var h=
this.owner.getCurrentFolder();h&&(f=e.buildPath(h.mount,h.path,!1))}return this.runBash(c,b,f,d)}if("php"===c.type)return f=null,c.isLinked()&&(f=this.getCurrentPath()),this.runPHP(c,b,f);if("javascript"===c.type)return this.runJavascript(c,b)},onConsoleEnter:function(a,b){return this.onConsoleCommand(a,b)}})}function a(){var a=h(c.Editor,{didAddMCompleter:!1,multiFileCompleter:null,blockScope:null,driverInstance:null,onACEReady:function(a){},onEditorCreated:function(a,b){this.inherited(arguments);
this.onACEReady(a)}});return h(c,{EditorClass:a,onAddEditorActions:h.superCall(function(a){return function(b){a.call(this,b);b=b.actions;_.find(b,{command:"File/Save"});b.remove(_.find(b,{command:"File/Save"}));b.remove(_.find(b,{command:"File/Reload"}))}}),logTemplate:'\x3cpre style\x3d"font-size:100%;padding: 0px;" class\x3d""\x3e    ${time} - ${result}\x3c/pre\x3e',_parse:function(a,b,c){var d=""+b;0<d.indexOf("{{")||0<d.indexOf("}}")?d=_parser.parse(f.EXPRESSION_PARSER.FILTREX,d,this,{variables:a.getVariablesAsObject(),
delimiters:{begin:"{{",end:"}}"}}):(a=a.parseExpression(b,null,null,null,c))&&(d=a);return d},parse:function(a,b){var c=this.driverInstance;return c&&c.blockScope?this._parse(c.blockScope,a,b):a}})}n=n("xfile.views.FileConsole",null,{isStatusbarOpen:!1,resizeToParent:!0,__bottomTabContainer:null,onCloseStatusPanel:function(a){},onOpenStatusPanel:function(b){if(!b._tabs){var c=this,d=this.__bottomTabContainer||e.addWidget(w,{direction:"below"},null,b,!0);this.__bottomTabContainer=b._tabs=d;var f=a(),
h=new (r());h.ctx=c.ctx;h.owner=this;var m=d.createTab("Bash","fa-terminal");m.add(f,{type:"sh",title:"Bash",icon:"fa-terminal",ctx:c.ctx,owner:c,value:"ls -l --color\x3dalways"},null,!0).delegate=h;m._onShown();m=d.createTab("Javascript","fa-code").add(f,{type:"javascript",title:"Javascript",ctx:c.ctx,value:"return 2+2;",owner:c},null,!1);m.delegate=h;var m=d.createTab("PHP","fa-terminal").add(f,{type:"php",title:"PHP",ctx:c.ctx,value:"\x3c?php \n\n\x3e",owner:c},null,!1),n=d.createTab("Sizes","fa-bar-chart");
this.__fileSize=n.add(p,{owner:this,ctx:c.ctx},null,!1);this._on("openedFolder",function(a){e.destroy(c.__fileSize);n.resize();c.resize();c.__fileSize=null;c.__fileSize=n.add(p,{owner:c,ctx:c.ctx},null,!1);e.resizeTo(c.__fileSize,n,!0,!0);c.__fileSize.startup()});b.add(d,null,!1)}return this.inherited(arguments)},onStatusbarCollapse:function(a){var b=null;this.isStatusbarOpen?(b=this.getBottomPanel(!1,.2),b.collapse(),this.onCloseStatusPanel(a),a&&a.removeClass("fa-caret-down"),a&&a.addClass("fa-caret-up")):
((b=this._getBottom())?b.expand():b=this.getBottomPanel(!1,.2),this.onOpenStatusPanel(b),a&&a.removeClass("fa-caret-up"),a&&a.addClass("fa-caret-down"));this.isStatusbarOpen=!this.isStatusbarOpen;b.resize()},__runAction:function(a){var b=this.inherited(arguments);return runAction.apply(this,[a])||b}});n.createEditor=function(a,b,c,d){var f={filePath:"",fileName:""};b={_permissions:[],item:f,value:b,style:"padding:0px;top:0 !important",iconClass:"fa-code",options:e.mixin(d,{filePath:f.path,fileName:f.name}),
storeDelegate:{},title:"No Title"};e.mixin(b,d);a=e.addWidget(m,b,c,a,!0,null,null,!1);a.resize();return a};n.createShellViewDelegate=r;n.createShellViewClass=a;return n})},"xfile/data/DriverStore":function(){define("dojo/_base/declare dojo/Deferred dstore/Trackable xide/data/ObservableStore xide/data/TreeMemory xfile/data/Store dstore/Cache xide/manager/ServerActionBase xide/utils".split(" "),function(n,h,f,e,b,d,v,w,t){f=d.Implementation;return n("driverFileStore",[b,e,w.declare],t.mixin(f(),{driver:null,
addDot:!1,rootSegment:"/",getRootItem:function(){var b=this._root;return b?b:this._root={_EX:!1,path:"/",name:"/",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},_filter:function(b){return b},_request:function(b){var d=this,c=this;if("."===b||"/"===b){var e=new h,f=c.driver.callCommand("LSProg",{override:{args:["/*"]}});f.then(function(a){a=a.files;_.each(a,function(a){a.parent="."});a=c._filter(a);a=d._normalize({items:[{mount:"root",path:"/",children:a,name:"/",
isDir:!0}]});c._parse(a);a=a.children||a;e.resolve(a)})}else e=new h,f=c.driver.callCommand("LSProg",{override:{args:[b+(c.glob||"/*")]}}),f.then(function(a){a=a.files;_.each(a,function(a){a.parent=b});a=c._filter(a);a=d._normalize({items:[{mount:"root",path:b,children:a,isDir:!0}]});c._parse(a);a=a.children||a;e.resolve(a)});return e}}))})},"xfile/views/FileGridLight":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/GridLight xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),
function(n,h,f,e,b,d,v,w,t,q,p,c,m){q=c.DEFAULT_FILE_GRID_PERMISSIONS;var r=n("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:b.clone(e.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:e.ITEM_TYPE.FILE,permissions:q,
contextMenuArgs:{limitTo:null},setState:function(a){this.inherited(arguments);var b=this,c=b.collection,d=a.store.path;c.getSync(d);var e=b.refresh();try{e.then(function(){c.getItem(d,!0).then(function(a){b.openFolder(a)})})}catch(f){console.error("error restoring folder state")}return e},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=t.createFileStore(a.mount,
a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(b){a._columns[b.label]=!this.isColumnHidden(b.id)},this);return a},onSaveLayout:function(a){a=a.data;var b=this.getState();a.widgets.push({widget:this.declaredClass,state:b});return a},formatColumn:function(a,
c,d){var e=this.selectedRenderer?this.selectedRenderer.prototype:this;if(e.formatColumn&&(e=e.formatColumn.apply(arguments))||d.renderColumn&&(e=d.renderColumn.apply(this,arguments)))return e;switch(a){case "fileType":if("folder"==c)return m.localize("kindFolder");if(d.mime){var e="kind"+(d.mime.split("/")[1]||"unknown").toUpperCase(),f=m.localize(e);return e!==f?f:c}case "name":var f=d&&null!=d.directory&&!0===d.directory,h=!1===d.read&&!1===d.write,n=".."==d.name,e="",e=f?n?"fa fa-level-up itemFolderList":
h?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":h?"fa fa-lock itemFolderList":"itemFolderList fa "+b.getIconClass(d.path),f=!0===d.showPath?d.path:c;return'\x3cspan class\x3d"'+e+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+f+"\x3c/span\x3e";case "sizeBytes":return d.size;case "fileType":return b.capitalize(d.fileType||"unknown");case "mediaInfo":return d.mediaInfo||"unknown";case "owner":return d&&(e=d.owner)&&e.user?
e.user.name:"";case "modified":if(""===c)break;f=null==!d.directory;return!f&&m.translations.dateFormat?m.formatDate(c).replace("ms",""):""}return c},getColumns:function(){function a(a,c,d,e){null!=b._columns[a]&&(e=!b._columns[a]);b.columns.push({renderExpando:"Name"===a,label:a,field:c,sortable:d,formatter:function(a,d){return b.formatColumn(c,a,d)},hidden:e})}var b=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,b){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var c=this,d=new f;if(c){var e=this.collection;"."===a.path?(e.resetQueryLog(),c.set("collection",e.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):e.open(a).then(function(b){e.resetQueryLog();
c.set("collection",e.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(b)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var b=this.collection.getSync(a.rPath);b&&(a=b)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(1==a.isBack&&(b=this.getHistory().getNow()))return this.collection.getSync(b);if(a=a._S.getParent(a))return a}return null},getClass:function(){return r},
getHistory:function(){this._history||(this._history=new d);return this._history},renderArray:function(a,b){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);h.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var b=v.getDefaultActions(this.permissions,this,this),b=b.concat(this.getFileActions(this.permissions));this.addActions(b)}this._history=new d;var c=this;this.subscribe(e.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===c.itemType&&(c.currentCopySelection=a.selection,c.refreshActions())});c._on("noData",function(){c.getRows();if(!(0<c._total)){var a=c._history.getNow();a&&"./."!==a&&c.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:c.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=c.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(c.removeRow(a),c.refresh())});this._on("openFolder",
function(a){c.set("title",a.item.name)});c.selectedRenderer&&(a=this.refresh())&&a.then(function(){c.set("loading",!1);c.setRenderer(c.selectedRenderer,!1)});this._on("onChangeRenderer",function(){c.refresh()});setTimeout(function(){c.resize()},500);return a}}});r.prototype.Module=r;r.Module=r;r.createDefault=function(a,c,d,e,f,h){c=b.mixin({collection:h.getDefaultCollection(),_parent:d,Module:r,ctx:a},c||{});c=b.addWidget(r,c,null,d,f,null,null,!0,null);e&&a.getWindowManager().registerView(c,!1);
return c};r.DEFAULT_PERMISSIONS=q;return r})},"xfile/views/GridLight":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Selection xide/mixins/_State xide/widgets/_Widget".split(" "),function(n,h,f,e,b,d,v,w,t,q,p,c,m){f=[f,e,b];n=n.classFactory("multiRenderer",{},f,v.Implementation);h=d.createGridClass("xfile.views.GridLight",{},{SELECTION:{CLASS:p},
KEYBOARD_SELECTION:!0,COLUMN_HIDER:!0,COLUMN_REORDER:!1,CONTEXT_MENU:h.GRID_FEATURES.CONTEXT_MENU,CLIPBOARD:h.GRID_FEATURES.CLIPBOARD,ACTIONS:h.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},SPLIT:{CLASS:t},KEYBOARD_NAVIGATION:{CLASS:q},STATE:{CLASS:c},WIDGET:{CLASS:m}},{RENDERER:n},{renderers:f,selectedRenderer:b});h.DEFAULT_RENDERERS=f;h.DEFAULT_MULTI_RENDERER=n;return h})}}});
//# sourceMappingURL=xfile.js.map